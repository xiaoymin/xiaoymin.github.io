<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.3">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2024-08-07T09:19:09+08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">å…«ä¸€èœåˆ€</title><subtitle>å…«ä¸€èœåˆ€çš„ä¸ªäººåšå®¢</subtitle><author><name>è‚–ç‰æ°‘</name></author><entry><title type="html">QWen2-72B-Instructæ¨¡å‹å®‰è£…éƒ¨ç½²è¿‡ç¨‹</title><link href="http://localhost:4000/2024/08/07/qwen2-72b-instruct-deploy/" rel="alternate" type="text/html" title="QWen2-72B-Instructæ¨¡å‹å®‰è£…éƒ¨ç½²è¿‡ç¨‹" /><published>2024-08-07T00:00:00+08:00</published><updated>2024-08-07T00:00:00+08:00</updated><id>http://localhost:4000/2024/08/07/qwen2-72b-instruct-deploy</id><content type="html" xml:base="http://localhost:4000/2024/08/07/qwen2-72b-instruct-deploy/">&lt;h2 id=&quot;ä¸€åŸºç¡€ä¿¡æ¯&quot;&gt;ä¸€ã€åŸºç¡€ä¿¡æ¯&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;æ“ä½œç³»ç»Ÿ&lt;/strong&gt;ï¼š&lt;strong&gt;Ubuntu 22.04.3 LTS&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;GPU:&lt;/strong&gt; &lt;strong&gt;A800(80GB) * 8&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å†…å­˜&lt;/strong&gt;ï¼š1TB&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/qwen2-72b/image-20240806104952860.png&quot; alt=&quot;image-20240806104952860&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/qwen2-72b/image-20240806110115152.png&quot; alt=&quot;image-20240806110115152&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;äºŒè½¯ä»¶ä¿¡æ¯&quot;&gt;äºŒã€è½¯ä»¶ä¿¡æ¯&lt;/h2&gt;

&lt;p&gt;Python: 3.10&lt;/p&gt;

&lt;p&gt;Pytorchï¼š2.3.0&lt;/p&gt;

&lt;p&gt;Transformersï¼š4.43.0&lt;/p&gt;

&lt;p&gt;vLLMï¼š0.5.0&lt;/p&gt;

&lt;p&gt;cudaï¼š 12.2&lt;/p&gt;

&lt;p&gt;æ¨¡å‹: &lt;a href=&quot;https://huggingface.co/Qwen/Qwen2-72B-Instruct&quot;&gt;QWen2-72B-Instruct&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;ä¸‰å®‰è£…æ­¥éª¤&quot;&gt;ä¸‰ã€å®‰è£…æ­¥éª¤&lt;/h2&gt;

&lt;h3 id=&quot;1å®‰è£…conda&quot;&gt;1ã€å®‰è£…Conda&lt;/h3&gt;

&lt;p&gt;Conda æ˜¯ä¸€ä¸ªå¼€æºçš„åŒ…ç®¡ç†ç³»ç»Ÿå’Œç¯å¢ƒç®¡ç†ç³»ç»Ÿï¼Œæ—¨åœ¨ç®€åŒ–è½¯ä»¶åŒ…çš„å®‰è£…ã€é…ç½®å’Œä½¿ç”¨&lt;/p&gt;

&lt;p&gt;å¯¹äºPythonç¯å¢ƒçš„éƒ¨ç½²ï¼Œèƒ½å¤Ÿéå¸¸æ–¹ä¾¿çš„åˆ‡æ¢ç¯å¢ƒã€‚&lt;/p&gt;

&lt;p&gt;å¯ä»¥é€šè¿‡condaå®˜ç½‘é“¾æ¥ä¸‹è½½å®‰è£…ï¼š&lt;a href=&quot;https://www.anaconda.com/download#downloads&quot;&gt;https://www.anaconda.com/download#downloads&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ä¸‹è½½&lt;/span&gt;
wget https://repo.anaconda.com/archive/Anaconda3-2023.09-0-Linux-x86_64.sh
&lt;span class=&quot;c&quot;&gt;# å®‰è£…&lt;/span&gt;
bash Anaconda3-2023.09-0-Linux-x86_64.sh
&lt;span class=&quot;c&quot;&gt;# é…ç½®ç¯å¢ƒå˜é‡&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'export PATH=&quot;/path/to/anaconda3/bin:$PATH&quot;'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; ~/.bashrc
&lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt; ~/.bashrc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…å®Œæˆåï¼Œé€šè¿‡å‘½ä»¤éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;conda &lt;span class=&quot;nt&quot;&gt;--version&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…å®Œæˆä¹‹åï¼Œå¯ä»¥é…ç½®é•œåƒæºï¼Œæ–¹ä¾¿å¿«é€Ÿä¸‹è½½ä¾èµ–åŒ…&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# é…ç½®æº&lt;/span&gt;

conda config &lt;span class=&quot;nt&quot;&gt;--add&lt;/span&gt; channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/
conda config &lt;span class=&quot;nt&quot;&gt;--add&lt;/span&gt; channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/
conda config &lt;span class=&quot;nt&quot;&gt;--set&lt;/span&gt; show_channel_urls &lt;span class=&quot;nb&quot;&gt;yes


&lt;/span&gt;conda config &lt;span class=&quot;nt&quot;&gt;--add&lt;/span&gt; channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/
conda config &lt;span class=&quot;nt&quot;&gt;--add&lt;/span&gt; channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/
conda config &lt;span class=&quot;nt&quot;&gt;--add&lt;/span&gt; channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/
conda config &lt;span class=&quot;nt&quot;&gt;--add&lt;/span&gt; channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/menpo/
conda config &lt;span class=&quot;nt&quot;&gt;--add&lt;/span&gt; channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;condaçš„ç›¸å…³å‘½ä»¤&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;c&quot;&gt;# æŒ‡å®šè™šæ‹Ÿç¯å¢ƒåç§°ä¸ºllmï¼Œpythonç‰ˆæœ¬æ˜¯3.9&lt;/span&gt;
 conda create &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; llm &lt;span class=&quot;nv&quot;&gt;python&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;3.9
 &lt;span class=&quot;c&quot;&gt;# æ¿€æ´»condaæ–°ç¯å¢ƒ&lt;/span&gt;
 conda activate llm
 &lt;span class=&quot;c&quot;&gt;# æŸ¥çœ‹å½“å‰ç¯å¢ƒåˆ—è¡¨&lt;/span&gt;
 conda &lt;span class=&quot;nb&quot;&gt;env &lt;/span&gt;list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2ä¸‹è½½qwen2-72b-instructæ¨¡å‹&quot;&gt;2ã€ä¸‹è½½QWen2-72B-Instructæ¨¡å‹&lt;/h3&gt;

&lt;p&gt;Huggingfaceï¼š&lt;a href=&quot;https://huggingface.co/Qwen/Qwen2-72B-Instruct&quot;&gt;https://huggingface.co/Qwen/Qwen2-72B-Instruct&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ModelScopeï¼š&lt;a href=&quot;https://modelscope.cn/models/qwen/Qwen2-72B-Instruct&quot;&gt;https://modelscope.cn/models/qwen/Qwen2-72B-Instruct&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä¸¤ä¸ªåœ°å€éƒ½å¯ä»¥ä¸‹è½½ï¼Œä¸‹è½½å®Œæˆåï¼Œå°†æ¨¡å‹æ–‡ä»¶å­˜æ”¾åœ¨æœåŠ¡å™¨ä¸Šã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;âš ï¸ æ³¨æ„æœåŠ¡å™¨çš„ç£ç›˜ç©ºé—´ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;3å®‰è£…pytorchç­‰ç¯å¢ƒä¾èµ–ä¿¡æ¯&quot;&gt;3ã€å®‰è£…Pytorchç­‰ç¯å¢ƒä¾èµ–ä¿¡æ¯&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;âš ï¸ åœ¨å®‰è£…Pytorchæ—¶ï¼Œéœ€è¦ä¿è¯å’Œcudaé©±åŠ¨ç‰ˆæœ¬ä¿æŒä¸€è‡´ï¼Œä¸ç„¶ä¼šå‡ºç°å„ç§è«åå…¶å¦™çš„é—®é¢˜&lt;/p&gt;

  &lt;p&gt;ç‰ˆæœ¬é€‰æ‹©å‚è€ƒï¼š&lt;a href=&quot;https://pytorch.org/get-started/locally/&quot;&gt;https://pytorch.org/get-started/locally/&lt;/a&gt;&lt;/p&gt;

  &lt;p&gt;é€šè¿‡condaåˆ›å»ºä¸€ä¸ªæ–°çš„ç¯å¢ƒï¼Œç„¶ååˆ‡æ¢åå®‰è£…ä¾èµ–åŒ…&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/qwen2-72b/image-20240806135441512.png&quot; alt=&quot;image-20240806135441512&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;4-å®‰è£…vllm&quot;&gt;4ã€ å®‰è£…vLLM&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vLLM&lt;/code&gt; æ¡†æ¶æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„å¤§è¯­è¨€æ¨¡å‹&lt;strong&gt;æ¨ç†å’Œéƒ¨ç½²æœåŠ¡ç³»ç»Ÿ&lt;/strong&gt;ï¼Œå…·å¤‡ä»¥ä¸‹ç‰¹æ€§ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;é«˜æ•ˆçš„å†…å­˜ç®¡ç†&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PagedAttention&lt;/code&gt; ç®—æ³•ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vLLM&lt;/code&gt; å®ç°äº†å¯¹ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KV&lt;/code&gt; ç¼“å­˜çš„é«˜æ•ˆç®¡ç†ï¼Œå‡å°‘äº†å†…å­˜æµªè´¹ï¼Œä¼˜åŒ–äº†æ¨¡å‹çš„è¿è¡Œæ•ˆç‡ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;é«˜ååé‡&lt;/strong&gt;ï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vLLM&lt;/code&gt; æ”¯æŒå¼‚æ­¥å¤„ç†å’Œè¿ç»­æ‰¹å¤„ç†è¯·æ±‚ï¼Œæ˜¾è‘—æé«˜äº†æ¨¡å‹æ¨ç†çš„ååé‡ï¼ŒåŠ é€Ÿäº†æ–‡æœ¬ç”Ÿæˆå’Œå¤„ç†é€Ÿåº¦ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ˜“ç”¨æ€§&lt;/strong&gt;ï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vLLM&lt;/code&gt; ä¸ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HuggingFace&lt;/code&gt; æ¨¡å‹æ— ç¼é›†æˆï¼Œæ”¯æŒå¤šç§æµè¡Œçš„å¤§å‹è¯­è¨€æ¨¡å‹ï¼Œç®€åŒ–äº†æ¨¡å‹éƒ¨ç½²å’Œæ¨ç†çš„è¿‡ç¨‹ã€‚å…¼å®¹ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;OpenAI&lt;/code&gt; çš„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;API&lt;/code&gt; æœåŠ¡å™¨ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åˆ†å¸ƒå¼æ¨ç†&lt;/strong&gt;ï¼šæ¡†æ¶æ”¯æŒåœ¨å¤š &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GPU&lt;/code&gt; ç¯å¢ƒä¸­è¿›è¡Œåˆ†å¸ƒå¼æ¨ç†ï¼Œé€šè¿‡æ¨¡å‹å¹¶è¡Œç­–ç•¥å’Œé«˜æ•ˆçš„æ•°æ®é€šä¿¡ï¼Œæå‡äº†å¤„ç†å¤§å‹æ¨¡å‹çš„èƒ½åŠ›ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¼€æºå…±äº«&lt;/strong&gt;ï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vLLM&lt;/code&gt; ç”±äºå…¶å¼€æºçš„å±æ€§ï¼Œæ‹¥æœ‰æ´»è·ƒçš„ç¤¾åŒºæ”¯æŒï¼Œè¿™ä¹Ÿä¾¿äºå¼€å‘è€…è´¡çŒ®å’Œæ”¹è¿›ï¼Œå…±åŒæ¨åŠ¨æŠ€æœ¯å‘å±•ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;GitHubï¼š&lt;a href=&quot;https://github.com/vllm-project/vllm&quot;&gt;https://github.com/vllm-project/vllm&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æ–‡æ¡£ï¼š&lt;a href=&quot;https://docs.vllm.ai/en/latest/&quot;&gt;https://docs.vllm.ai/en/latest/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;åœ¨é€šè¿‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;conda&lt;/code&gt;åˆ›å»ºäº†åˆå§‹ç¯å¢ƒåï¼Œå¯ä»¥ç›´æ¥é€šè¿‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pip&lt;/code&gt;è¿›è¡Œå®‰è£…&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pip &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;vllm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ›´å¤šçš„å®‰è£…æ–¹å¼ï¼Œå¯ä»¥å‚è€ƒå®˜ç½‘æ–‡æ¡£ï¼š&lt;a href=&quot;https://docs.vllm.ai/en/stable/getting_started/installation.html&quot;&gt;https://docs.vllm.ai/en/stable/getting_started/installation.html&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;5æ¨¡å‹éªŒè¯&quot;&gt;5ã€æ¨¡å‹éªŒè¯&lt;/h3&gt;

&lt;p&gt;å¯ä»¥é€šè¿‡ä¸€ä¸ªpythonè„šæœ¬æ¥éªŒè¯å½“å‰çš„æ¨¡å‹æ˜¯å¦å¯ç”¨&lt;/p&gt;

&lt;p&gt;è„šæœ¬å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# test.py
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;vllm&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LLM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SamplingParams&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;transformers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AutoTokenizer&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;json&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_completion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prompts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_tokens&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;temperature&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;top_p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_model_len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2048&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;stop_token_ids&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# åˆ›å»ºé‡‡æ ·å‚æ•°ã€‚temperature æ§åˆ¶ç”Ÿæˆæ–‡æœ¬çš„å¤šæ ·æ€§ï¼Œtop_p æ§åˆ¶æ ¸å¿ƒé‡‡æ ·çš„æ¦‚ç‡
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;sampling_params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SamplingParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temperature&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temperature&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;top_p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;top_p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_tokens&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_tokens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stop_token_ids&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stop_token_ids&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# åˆå§‹åŒ– vLLM æ¨ç†å¼•æ“
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;llm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LLM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tokenizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_model_len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_model_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trust_remote_code&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;llm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;generate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prompts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sampling_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;__main__&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;    
    &lt;span class=&quot;c1&quot;&gt;# åˆå§‹åŒ– vLLM æ¨ç†å¼•æ“
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/mnt/soft/models/qwen/Qwen2-72B-Instruct'&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# æŒ‡å®šæ¨¡å‹è·¯å¾„
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# model=&quot;qwen/Qwen2-7B-Instruct&quot; # æŒ‡å®šæ¨¡å‹åç§°ï¼Œè‡ªåŠ¨ä¸‹è½½æ¨¡å‹
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;tokenizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# åŠ è½½åˆ†è¯å™¨åä¼ å…¥vLLM æ¨¡å‹ï¼Œä½†ä¸æ˜¯å¿…è¦çš„ã€‚
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# tokenizer = AutoTokenizer.from_pretrained(model, use_fast=False) 
&lt;/span&gt;    
    &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ä½ å¥½ï¼Œå¸®æˆ‘ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ—¶å¤§è¯­è¨€æ¨¡å‹ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&quot;å¯ä»¥ç»™æˆ‘å°†ä¸€ä¸ªæœ‰è¶£çš„ç«¥è¯æ•…äº‹å—ï¼Ÿ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_completion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tokenizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_tokens&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;temperature&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;top_p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_model_len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2048&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# è¾“å‡ºæ˜¯ä¸€ä¸ªåŒ…å« promptã€ç”Ÿæˆæ–‡æœ¬å’Œå…¶ä»–ä¿¡æ¯çš„ RequestOutput å¯¹è±¡åˆ—è¡¨ã€‚
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# æ‰“å°è¾“å‡ºã€‚
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;prompt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prompt&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;generated_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Prompt: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prompt&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;, Generated text: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;generated_text&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åœ¨ç»ˆç«¯æ‰§è¡Œpythonè„šæœ¬ï¼Œå¯ä»¥çœ‹åˆ°æ§åˆ¶å°æ˜¯å¦æ­£å¸¸è¾“å‡º&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python test.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;6å¯åŠ¨æœåŠ¡--åŒ…è£…openaiæ ¼å¼çš„æ¥å£&quot;&gt;6ã€å¯åŠ¨æœåŠ¡ &amp;amp; åŒ…è£…OpenAIæ ¼å¼çš„æ¥å£&lt;/h3&gt;

&lt;p&gt;éªŒè¯æ¨¡å‹å¯ç”¨åï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡vLLMæä¾›çš„æ¨¡å—ï¼Œå°†æ•´ä¸ªæ¨¡å‹æœåŠ¡åŒ…è£…æˆOpenAIæ ¼å¼çš„HTTPæœåŠ¡ï¼Œæä¾›ç»™ä¸Šå±‚åº”ç”¨ä½¿ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;éœ€è¦æ³¨æ„çš„å‚æ•°é…ç½®ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--model&lt;/code&gt; å‚æ•°æŒ‡å®šæ¨¡å‹åç§°&amp;amp;è·¯å¾„ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--served-model-name&lt;/code&gt; æŒ‡å®šæœåŠ¡æ¨¡å‹çš„åç§°ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--max-model-len&lt;/code&gt; æŒ‡å®šæ¨¡å‹çš„æœ€å¤§é•¿åº¦ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé‚£ä¹ˆä¼šä»æ¨¡å‹é…ç½®æ–‡ä»¶ä¸­è‡ªåŠ¨åŠ è½½ï¼ŒQWen2-72Bæ¨¡å‹æ”¯æŒæœ€å¤§128K&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--tensor-parallel-size&lt;/code&gt;  æŒ‡å®šå¤šä¸ªGPUæœåŠ¡è¿è¡Œ,QWen2-72Bçš„æ¨¡å‹ï¼Œå•å¡GPUæ— æ³•æ”¯æ’‘ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--gpu-memory-utilization&lt;/code&gt;  ç”¨äºæ¨¡å‹æ‰§è¡Œå™¨çš„GPUå†…å­˜åˆ†æ•°ï¼ŒèŒƒå›´ä»0åˆ°1ã€‚ä¾‹å¦‚ï¼Œå€¼ä¸º0.5æ„å‘³ç€GPUå†…å­˜åˆ©ç”¨ç‡ä¸º50%ã€‚å¦‚æœæœªæŒ‡å®šï¼Œå°†ä½¿ç”¨&lt;strong&gt;é»˜è®¤å€¼0.9&lt;/strong&gt;ã€‚&lt;strong&gt;vllmé€šè¿‡æ­¤å‚æ•°é¢„åˆ†é…äº†éƒ¨åˆ†æ˜¾å­˜ï¼Œé¿å…æ¨¡å‹åœ¨è°ƒç”¨çš„æ—¶å€™é¢‘ç¹çš„ç”³è¯·æ˜¾å­˜&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;å…³äºvllmçš„æ›´å¤šå‚æ•°ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š&lt;a href=&quot;https://docs.vllm.ai/en/stable/models/engine_args.html&quot;&gt;https://docs.vllm.ai/en/stable/models/engine_args.html&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;è¿™é‡Œå¯ä»¥ä½¿ç”¨&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tmux&lt;/code&gt;å‘½ä»¤æ¥è¿›è¡ŒæœåŠ¡çš„è¿è¡Œã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tmux&lt;/code&gt;ï¼ˆTerminal Multiplexerï¼‰æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç»ˆç«¯å¤ç”¨å™¨ï¼Œå¯ä»¥è®©ç”¨æˆ·åœ¨ä¸€ä¸ªç»ˆç«¯çª—å£ä¸­åŒæ—¶ä½¿ç”¨å¤šä¸ªä¼šè¯ã€‚ä½¿ç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tmux&lt;/code&gt; å¯ä»¥æé«˜å·¥ä½œæ•ˆç‡ï¼Œä¾¿äºç®¡ç†é•¿æœŸè¿è¡Œçš„ä»»åŠ¡å’Œå¤šä»»åŠ¡æ“ä½œ&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python3 &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; vllm.entrypoints.openai.api_server &lt;span class=&quot;nt&quot;&gt;--model&lt;/span&gt; /mnt/torchv/models/Qwen2-72B-Instruct  &lt;span class=&quot;nt&quot;&gt;--served-model-name&lt;/span&gt; QWen2-72B-Instruct &lt;span class=&quot;nt&quot;&gt;--tensor-parallel-size&lt;/span&gt; 8 &lt;span class=&quot;nt&quot;&gt;--gpu-memory-utilization&lt;/span&gt; 0.7
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/qwen2-72b/image-20240806111100747.png&quot; alt=&quot;image-20240806111100747&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;å‡ºç°ç«¯å£ç­‰ä¿¡æ¯åˆ™ä»£è¡¨å½“å‰çš„æ¨¡å‹æœåŠ¡å¯åŠ¨æˆåŠŸï¼ï¼ï¼&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°ä¼šè¯&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;tmux new &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; llm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¿›å…¥ä¼šè¯&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;tmux attach &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; llm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¯åŠ¨å‘½ä»¤ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; xxx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€€å‡ºå½“å‰ä¼šè¯&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;å¦‚æœæ²¡ååº”å°±å¤šè¯•å‡ æ¬¡&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;è‹±æ–‡è¾“å…¥ä¸‹ ctrl + b  ç„¶åè¾“å…¥d
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€šè¿‡curlå‘½ä»¤éªŒè¯å¤§æ¨¡å‹OpenAIæ¥å£æœåŠ¡æ˜¯å¦å¯ç”¨ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;curl http://localhost:8000/v1/chat/completions &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Content-Type: application/json&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{
  &quot;model&quot;: &quot;QWen2-72B-Instruct&quot;,
  &quot;messages&quot;: [
      {
          &quot;role&quot;: &quot;user&quot;,
          &quot;content&quot;: &quot;ç»™æˆ‘è®²ä¸€ä¸ªç«¥è¯æ•…äº‹&quot;
      }
  ],
  &quot;stream&quot;: true,
  &quot;temperature&quot;: 0.9,
  &quot;top_p&quot;: 0.7,
  &quot;top_k&quot;: 20,
  &quot;max_tokens&quot;: 512
}'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;å››æ€»ç»“&quot;&gt;å››ã€æ€»ç»“&lt;/h2&gt;

&lt;p&gt;ç›®å‰çš„å¼€æºç”Ÿæ€å·²ç»éå¸¸æˆç†Ÿäº†ï¼ŒvLLMè¿™æ ·çš„å·¥å…·èƒ½å¤Ÿè½»æ¾å®ç°å¯¹å¤§æ¨¡å‹çš„å¿«é€Ÿéƒ¨ç½²ï¼Œå·¥ä½œæ•ˆç‡ä¸Šå¤§å¤§æå‡&lt;/p&gt;

&lt;h2 id=&quot;äº”references&quot;&gt;äº”ã€References&lt;/h2&gt;

&lt;h3 id=&quot;å®˜ç½‘èµ„æºç­‰ä¿¡æ¯&quot;&gt;å®˜ç½‘èµ„æºç­‰ä¿¡æ¯&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;èµ„æº&lt;/th&gt;
      &lt;th&gt;åœ°å€&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;QWen&lt;/td&gt;
      &lt;td&gt;GitHubï¼š&lt;a href=&quot;https://github.com/QwenLM/Qwen&quot;&gt;https://github.com/QwenLM/Qwen&lt;/a&gt;&lt;br /&gt;Huggingfaceï¼š&lt;a href=&quot;https://huggingface.co/Qwen&quot;&gt;https://huggingface.co/Qwen&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;ModelScopeï¼š&lt;a href=&quot;https://modelscope.cn/organization/qwen?tab=model&quot;&gt;https://modelscope.cn/organization/qwen?tab=model&lt;/a&gt;&lt;br /&gt;docs:&lt;a href=&quot;https://qwen.readthedocs.io/zh-cn/latest/getting_started/quickstart.html#&quot;&gt;https://qwen.readthedocs.io/zh-cn/latest/getting_started/quickstart.html#&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Pytorch&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://pytorch.org/get-started/locally/&quot;&gt;https://pytorch.org/get-started/locally/&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Conda&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.anaconda.com&quot;&gt;https://www.anaconda.com&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;vLLM&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://docs.vllm.ai/en/latest/getting_started/installation.html&quot;&gt;https://docs.vllm.ai/en/latest/getting_started/installation.html&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Â &lt;/td&gt;
      &lt;td&gt;Â &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;æƒé‡æ–‡ä»¶ä¸‹è½½ä¸å®Œå…¨&quot;&gt;æƒé‡æ–‡ä»¶ä¸‹è½½ä¸å®Œå…¨&lt;/h3&gt;

&lt;p&gt;åœ¨æœ¬æ¬¡éƒ¨ç½²è¿‡ç¨‹ä¸­ï¼Œç¢°åˆ°äº†ä¸‹è½½æ¨¡å‹æƒé‡æ–‡ä»¶ä¸å®Œæ•´çš„æƒ…å†µï¼Œå¯¼è‡´é€šè¿‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vLLM&lt;/code&gt;éƒ¨ç½²ä¸èµ·æ¥ï¼Œå¯ä»¥é€šè¿‡Linuxçš„å‘½ä»¤&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sha256sum&lt;/code&gt;å·¥å…·æ¥å¯¹æ¨¡å‹æƒé‡æ–‡ä»¶è¿›è¡Œæ£€æŸ¥ï¼Œå¯¹æ¯”ç½‘ç«™ä¸Šçš„æ¨¡å‹æƒé‡æ–‡ä»¶çš„sha256æ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœä¸ä¸€è‡´ï¼Œéœ€è¦é‡æ–°ä¸‹è½½å®‰è£…&lt;/p&gt;

&lt;p&gt;å‘½ä»¤å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sha256sum &lt;/span&gt;your_local_file
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/qwen2-72b/image-20240806095033934.png&quot; alt=&quot;image-20240806095033934&quot; /&gt;&lt;/p&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="å¤§æ¨¡å‹" /><category term="RAGå®è·µ" /><category term="TorchV" /><category term="RAGæ¦‚è¿°" /><category term="RAG" /><category term="å¤§æ¨¡å‹" /><category term="LLM" /><summary type="html">ä¸€ã€åŸºç¡€ä¿¡æ¯</summary></entry><entry><title type="html">RAGå·¥ç¨‹å®è·µæ‹¦è·¯è™ä¹‹ä¸€ï¼šPDFæ ¼å¼è§£ææ‚è°ˆ</title><link href="http://localhost:4000/2024/07/08/torchv-pdf-01/" rel="alternate" type="text/html" title="RAGå·¥ç¨‹å®è·µæ‹¦è·¯è™ä¹‹ä¸€ï¼šPDFæ ¼å¼è§£ææ‚è°ˆ" /><published>2024-07-08T00:00:00+08:00</published><updated>2024-07-08T00:00:00+08:00</updated><id>http://localhost:4000/2024/07/08/torchv-pdf-01</id><content type="html" xml:base="http://localhost:4000/2024/07/08/torchv-pdf-01/">&lt;h2 id=&quot;èƒŒæ™¯&quot;&gt;èƒŒæ™¯&lt;/h2&gt;

&lt;p&gt;PDFï¼ˆPortable Document Formatï¼‰æ˜¯ä¸€ç§å¹¿æ³›ç”¨äºæ–‡æ¡£äº¤æ¢çš„æ–‡ä»¶æ ¼å¼ï¼Œç”±Adobe Systemså¼€å‘ã€‚å®ƒå…·æœ‰è·¨å¹³å°æ€§ã€å›ºå®šå¸ƒå±€å’Œæ˜“äºæ‰“å°ç­‰ç‰¹ç‚¹ï¼Œå› æ­¤åœ¨å•†ä¸šã€å­¦æœ¯å’Œä¸ªäººé¢†åŸŸå¹¿æ³›åº”ç”¨ã€‚ç„¶è€Œï¼ŒPDFæ–‡ä»¶çš„è§£æä¸€ç›´æ˜¯ä¸€ä¸ªå…·æœ‰æŒ‘æˆ˜æ€§çš„é—®é¢˜ï¼Œå› ä¸ºå…¶å†…éƒ¨ç»“æ„çš„å¤æ‚æ€§å’Œå¤šæ ·æ€§ï¼Œä½¿å¾—æå–å…¶ä¸­çš„æ–‡æœ¬ã€å›¾ç‰‡å’Œè¡¨æ ¼ç­‰å†…å®¹å¹¶ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ã€‚&lt;/p&gt;

&lt;h2 id=&quot;æŠ€æœ¯æ–¹æ¡ˆ&quot;&gt;æŠ€æœ¯æ–¹æ¡ˆ&lt;/h2&gt;

&lt;p&gt;åœ¨ç›®å‰çš„PDFæ–‡ä»¶è§£æé¢†åŸŸä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ç±»æŠ€æœ¯æ–¹æ¡ˆï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;LLM/è§†è§‰å¤§æ¨¡å‹è§£æ&lt;/strong&gt;ï¼šLLMï¼ˆLarge Language Modelï¼‰å¤§å‹è¯­è¨€æ¨¡å‹åœ¨è¿‘å¹´æ¥çš„å‘å±•ä¸­ï¼Œå±•ç°å‡ºäº†å¼ºå¤§çš„è¯­è¨€ç†è§£å’Œç”Ÿæˆèƒ½åŠ›ã€‚é€šè¿‡è®­ç»ƒå¤§è§„æ¨¡çš„ç¥ç»ç½‘ç»œï¼Œå¯ä»¥å®ç°å¯¹PDFæ–‡ä»¶ä¸­æ–‡å­—å†…å®¹çš„ç†è§£å’Œæå–ï¼Œè¿™ç§æ–¹æ³•å°¤å…¶é€‚ç”¨äºé‚£äº›å¸ƒå±€å¤æ‚ã€å†…å®¹ä¸°å¯Œçš„PDFæ–‡ä»¶ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;OCRæ¨¡å‹&lt;/strong&gt;ï¼šå…‰å­¦å­—ç¬¦è¯†åˆ«ï¼ˆOCRï¼‰æ¨¡å‹ä¸“é—¨è®¾è®¡ç”¨äºå°†PDFæ–‡ä»¶ä¸­çš„å›¾åƒè½¬æ¢ä¸ºå¯ç¼–è¾‘çš„æ–‡æœ¬ã€‚è¿™ç§æŠ€æœ¯åœ¨å¤„ç†æ‰«æç‰ˆæˆ–å›¾åƒåŒ–çš„PDFæ–‡æ¡£æ—¶å°¤å…¶æœ‰ç”¨ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä¼ ç»Ÿè§„åˆ™æå–&lt;/strong&gt;ï¼šä¼ ç»Ÿçš„PDFè§£ææ–¹å¼å¯èƒ½åŒ…æ‹¬åŸºäºè§„åˆ™çš„æ–‡æœ¬æå–ã€å›¾åƒå¤„ç†å’Œè¡¨æ ¼è¯†åˆ«ç­‰æ–¹æ³•ã€‚è™½ç„¶è¿™äº›æ–¹æ³•å¯èƒ½ä¸å¦‚æ·±åº¦å­¦ä¹ æ¨¡å‹é‚£æ ·çµæ´»ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ä»ç„¶æ˜¯æœ‰æ•ˆçš„é€‰æ‹©ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å„ä¸ªè§£å†³æ–¹æ¡ˆç›®å‰å¯èƒ½éœ€è¦é…åˆä½¿ç”¨ï¼Œå› ä¸ºPDFæ ¼å¼æœ¬èº«çš„å¤æ‚ç¨‹åº¦ï¼Œä¸€é¡¹æŠ€æœ¯æ–¹æ¡ˆå¯èƒ½æ˜¯&lt;strong&gt;æ— æ³•100%æ»¡è¶³ä¸šåŠ¡éœ€æ±‚&lt;/strong&gt;çš„ï¼Œè¿™é‡Œé¢éœ€è¦è€ƒè™‘çš„æ˜¯ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;æ–‡æ¡£æå–è¿˜åŸåº¦&lt;/strong&gt;ï¼šé€šè¿‡æŠ€æœ¯æ‰‹æ®µï¼Œèƒ½å¤Ÿå®Œæ•´çš„æå–PDFä¸­çš„å„é¡¹å…ƒç´ ï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€è¡¨æ ¼ã€å›¾ç‰‡ã€é“¾æ¥ã€å›¾å½¢ã€ç›®å½•ç­‰ç­‰ä¿¡æ¯&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;é«˜æ•ˆ/ğŸ’°æˆæœ¬&lt;/strong&gt;ï¼šåœ¨RAGçŸ¥è¯†åº“é—®ç­”çš„äº§å“ä¸­ï¼Œè€ƒè™‘åˆ°æ–‡æœ¬è¿˜éœ€è¦Embeddingçš„è¿‡ç¨‹ï¼Œå› æ­¤åœ¨æå–è¿‡ç¨‹ä¸­å¦‚ä½•æ›´é«˜æ•ˆï¼Œæˆæœ¬æ›´ä½ä¹Ÿæ˜¯éœ€è¦ç€é‡è€ƒè™‘åˆ°äº‹é¡¹ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç¨³å®š/å¹‚ç­‰&lt;/strong&gt;ï¼šæˆ‘ä»¬çŸ¥é“å¤§æ¨¡å‹å¯èƒ½æ˜¯å‡ºç°å¹»è§‰çš„ï¼Œå¦‚æœç”¨å¤§æ¨¡å‹æ¥æå–PDFä¸­çš„å†…å®¹ï¼Œæ˜¯å¦èƒ½è¶³å¤Ÿä¿è¯ç¨³å®šæ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å½“æˆ‘ä»¬å¤„ç†è§£æPDFæ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¯ä»¥è®²æ¯ä¸€é¡¹çš„éš¾ç‚¹éƒ½è¿›è¡Œæ‹†åˆ†ï¼Œä»éœ€æ±‚å‡ºå‘ï¼Œé€ä¸€è¿›è¡Œæ”»ç ´ï¼Œæ‰¾åˆ°è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;

&lt;p&gt;å…¶å®æˆ‘è§‰å¾—æŠ€æœ¯äººå‘˜å¦‚æœèƒ½&lt;strong&gt;é€šè¿‡æŠ€æœ¯æ‰‹æ®µç¡®å®šPDFä¸­çš„Block(å—)ä»¥åŠé˜…è¯»é¡ºåºï¼ŒæŒ‰Block(å—)è¿›è¡Œè¾“å‡ºè½¬æ¢(Markdown/Htmlç­‰)ï¼Œè¿™é‡Œé¢åŒ…æ‹¬çš„Blockå—å…ƒç´ ï¼šæ–‡æœ¬ã€å›¾ç‰‡ã€è¡¨æ ¼ç­‰ç­‰ã€‚é‚£ä¹ˆè¿™ä¸ªæå–çš„æ•ˆæœå°±ä¼šè¾¾åˆ°æˆ‘ä»¬çš„æœ€ä¼˜&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;è€Œè¿™ä¸ªç›®æ ‡æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦é‡ç‚¹è®¨è®ºçš„ã€‚&lt;/p&gt;

&lt;h2 id=&quot;æŠ€æœ¯éš¾ç‚¹&quot;&gt;æŠ€æœ¯éš¾ç‚¹&lt;/h2&gt;

&lt;p&gt;åœ¨è€ƒè™‘è§£æPDFæ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å½“å‰çš„æŠ€æœ¯æ ˆå‘å±•æƒ…å†µï¼Œå¹¶ç»“åˆå®é™…çš„ä¸šåŠ¡è¯‰æ±‚ï¼Œç»¼åˆè€ƒé‡è¿™å…¶ä¸­çš„æŠ€æœ¯éš¾ç‚¹ï¼Œå› ä¸ºæ¯ä¸€é¡¹æŠ€æœ¯éš¾ç‚¹æ‰€æ¶‰åŠçš„æŠ€æœ¯æ–¹æ¡ˆéƒ½ä¼šéœ€è¦ä¸€ä¸ªç®—æ³•/æˆ–è€…æŠ€æœ¯æ‰‹æ®µå»çªç ´ã€‚&lt;/p&gt;

&lt;p&gt;è€Œå¼€å‘è€…ä»è§£æçš„æ•ˆæœå»è€ƒè™‘ï¼Œå¯ä»¥ä»ç®€å•çš„åšèµ·ï¼Œé€æ­¥çªç ´éš¾ç‚¹ï¼Œè¿™å¯¹äºå¼€å‘äººå‘˜è‡ªèº«çš„è‡ªä¿¡å¿ƒæå‡ä¹Ÿæ˜¯ä¸€ç§æ­£å‘çš„å¯¼å‘ã€‚åœ¨æ•´ä¸ªPDFè§£æè¿‡ç¨‹ä¸­ï¼Œæˆ‘è§‰å¾—ä»¥ä¸‹å‡ é¡¹æ˜¯æ¯”è¾ƒéš¾å¤„ç†çš„ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å¸ƒå±€è§£æå›°éš¾&lt;/strong&gt;ï¼šPDFæ–‡ä»¶çš„å¸ƒå±€å¯èƒ½ä¼šå› ä¸ºä¸åŒçš„ä½œè€…ã€å·¥å…·æˆ–ç”¨é€”è€Œæœ‰æ‰€ä¸åŒï¼Œå› æ­¤è§£æå…¶å¸ƒå±€æ˜¯ä¸€ä¸ªå…·æœ‰æŒ‘æˆ˜æ€§çš„ä»»åŠ¡ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ ¼å¼é”™ç»¼å¤æ‚&lt;/strong&gt;ï¼šPDFæ–‡ä»¶ä¸­å¯èƒ½åŒ…å«å„ç§æ ¼å¼çš„å†…å®¹ï¼ŒåŒ…æ‹¬&lt;strong&gt;æ–‡å­—&lt;/strong&gt;ã€&lt;strong&gt;å›¾åƒ&lt;/strong&gt;ã€&lt;strong&gt;è¡¨æ ¼&lt;/strong&gt;ç­‰ï¼Œå› æ­¤è§£æå…¶å†…å®¹éœ€è¦è€ƒè™‘åˆ°è¿™ç§å¤šæ ·æ€§å’Œå¤æ‚æ€§ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¤åˆè¡¨æ ¼&lt;/strong&gt;ï¼šçºµå‘/æ¨ªå‘åˆå¹¶çš„å¤æ‚è¡¨æ ¼ï¼Œåœ¨PDFä¸­è¿›è¡ŒæŠ½è±¡è¿˜åŸæ˜¯æœ€éš¾å¤„ç†çš„é—®é¢˜ä¹‹ä¸€&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ–‡æœ¬ã€å›¾ç‰‡ã€è¡¨æ ¼é¡ºåºæå–&lt;/strong&gt;ï¼šæå–PDFæ–‡ä»¶ä¸­çš„æ–‡æœ¬ã€å›¾ç‰‡å’Œè¡¨æ ¼ï¼Œå¹¶ç¡®ä¿å®ƒä»¬çš„é¡ºåºæ­£ç¡®æ€§ï¼Œæ˜¯ä¸€ä¸ªéœ€è¦è§£å†³çš„é‡è¦é—®é¢˜ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ–‡æ¡£ç»“æ„è¿˜åŸ&lt;/strong&gt;ï¼šè¿˜åŸPDFæ–‡ä»¶çš„æ–‡æ¡£ç»“æ„ï¼ŒåŒ…æ‹¬æ ‡é¢˜ã€ç›®å½•ç­‰ä¿¡æ¯ï¼Œæ˜¯å®ç°è‡ªåŠ¨åŒ–æ–‡æ¡£å¤„ç†å’Œç†è§£çš„å…³é”®æ­¥éª¤ä¹‹ä¸€ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å…ƒç´ é‡å &lt;/strong&gt;ï¼šä»PDF100%æ•ˆæœè¿˜åŸçš„è§’åº¦è€ƒè™‘ï¼Œå›¾ç‰‡/æ–‡æœ¬ä¹‹é—´çš„é‡å ï¼Œå›¾ç‰‡åˆå¹¶ï¼Œåˆå¹¶åä¸å¤±çœŸç­‰ï¼Œä¹Ÿæ˜¯éœ€è¦è€ƒè™‘çš„äº‹é¡¹ä¹‹ä¸€&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å…ƒæ•°æ®æå–&lt;/strong&gt;ï¼šåœ¨PDFä¸­éšè—çš„å…ƒæ•°æ®ä¿¡æ¯æ˜¯RAGäº§å“çš„å…³é”®æ•°æ®ï¼Œæ¯”å¦‚é“¾æ¥ã€ç›®å½•ã€å­—ä½“ç­‰ç­‰&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ‰«æä»¶&lt;/strong&gt;ï¼šPDFä¸­å¦‚æœæ˜¯æ‰«æä»¶ï¼Œä¾é OCRæ¨¡å‹å¯èƒ½æ˜¯æ— æ³•æœ‰æ•ˆçš„æå–ï¼Œè¿™é‡Œé¢åŒ…å«äº†æ¸…æ™°åº¦ã€æ¨¡å‹çš„ç¨³å®šæ€§ç­‰ç­‰é—®é¢˜&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Latexå…¬å¼æå–&lt;/strong&gt;ï¼šåœ¨ä¸€äº›ç‰¹æ®Šé¢†åŸŸï¼ŒPDFæ–‡æœ¬ä¸­åŒ…å«äº†Latexç­‰æ•°å­¦å…¬å¼ã€‚é€šè¿‡å®Œæ•´çš„æå–å’Œè½¬æ¢æ˜¯å¯¹RAGé—®ç­”çš„æœ‰æ•ˆè¡¥å……&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;æŠ€æœ¯å¯è¡Œæ€§&quot;&gt;æŠ€æœ¯å¯è¡Œæ€§&lt;/h2&gt;

&lt;p&gt;æˆ‘ä»¬ä»è§£æPDFçš„æŠ€æœ¯å¯è¡Œæ€§è§’åº¦ï¼Œè€ƒè™‘å“ªäº›æ–¹é¢å€¼å¾—æˆ‘ä»¬é‡ç‚¹å…³æ³¨å’Œçªç ´ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;æ–‡å­—æå–èƒ½åŠ›ï¼Œé€è¡Œæå–&lt;/strong&gt;ï¼šç¡®ä¿èƒ½å¤Ÿå‡†ç¡®åœ°æå–PDFæ–‡ä»¶ä¸­çš„æ–‡å­—å†…å®¹ï¼Œå¹¶æŒ‰ç…§æ­£ç¡®çš„é¡ºåºè¿›è¡Œæ’åˆ—å’Œè¾“å‡ºï¼Œé¿å…æ–‡å­—ä¹±ç (å­—ä½“)ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç®€å•/å¤æ‚è¡¨æ ¼å®Œæ•´æå–&lt;/strong&gt;ï¼šå¯¹PDFæ–‡ä»¶ä¸­çš„è¡¨æ ¼è¿›è¡Œå®Œæ•´æå–ï¼ŒåŒ…æ‹¬è¡¨æ ¼å†…çš„å†…å®¹å’Œæ ¼å¼ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å›¾ç‰‡æå–/åˆå¹¶&lt;/strong&gt;ï¼šæå–PDFæ–‡ä»¶ä¸­çš„å›¾ç‰‡ï¼Œå¹¶ä¿ç•™å…¶åŸå§‹è´¨é‡å’Œæ ¼å¼ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ–‡æ¡£å¸ƒå±€(Blockå—çš„æ ‡è¯†)è¯†åˆ«&lt;/strong&gt;ï¼šè¯†åˆ«PDFæ–‡ä»¶çš„å¸ƒå±€ï¼ŒåŒ…æ‹¬é¡µé¢çš„æ’åˆ—æ–¹å¼ã€æ–‡æœ¬å’Œå›¾ç‰‡çš„ä½ç½®ç­‰ä¿¡æ¯ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ–‡æ¡£ç»“æ„è¯†åˆ«(æ ‡é¢˜ã€ç›®å½•)ï¼Œå†…å®¹é¡ºåºè¾“å‡º&lt;/strong&gt;ï¼šè¯†åˆ«PDFæ–‡ä»¶çš„ç»“æ„ï¼ŒåŒ…æ‹¬æ ‡é¢˜ã€ç›®å½•ç­‰ä¿¡æ¯ï¼Œå¹¶ç¡®ä¿è¾“å‡ºå†…å®¹çš„é¡ºåºæ­£ç¡®ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;è½¬æ¢ä¸ºMarkdownæ ¼å¼&lt;/strong&gt;ï¼šå°†è§£æåçš„PDFæ–‡ä»¶å†…å®¹è½¬æ¢ä¸ºMarkdownæ ¼å¼ï¼Œä»¥ä¾¿äºåç»­çš„å¤„ç†å’Œåˆ†äº«ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;å¼€æºæŠ€æœ¯æ–¹æ¡ˆ&quot;&gt;å¼€æºæŠ€æœ¯æ–¹æ¡ˆ&lt;/h2&gt;

&lt;p&gt;ç»“åˆä¸Šé¢çš„æŠ€æœ¯éš¾ç‚¹/æ–¹æ¡ˆåŠå¯è¡Œæ€§ä¸Šå»åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹ç›®å‰å¼€æºçš„æŠ€æœ¯ç»„ä»¶ä¸­ï¼Œæœ‰å“ªäº›æ˜¯æˆ‘ä»¬å¯ä»¥è€ƒè™‘è¿›è¡Œç»“åˆçš„ã€‚&lt;/p&gt;

&lt;p&gt;å› ä¸ºç›®å‰TorchVç³»ç»Ÿä¸»è¦ä»¥Java+PythonåŒè¯­ä½œä¸ºåº•å±‚çš„åº”ç”¨å¼€å‘è¯­è¨€ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥çœ‹çœ‹åœ¨è¿™ä¸¤ä¸ªç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæœ‰å“ªäº›å¼€æºçš„æ–¹æ¡ˆå¯ä»¥ä½¿ç”¨ã€‚&lt;/p&gt;

&lt;h3 id=&quot;javaç”Ÿæ€&quot;&gt;Javaç”Ÿæ€&lt;/h3&gt;

&lt;p&gt;åœ¨Javaç”Ÿæ€ä¸­ï¼Œå¯¹äºPDFç»„ä»¶å¤„ç†çš„å¼€æºæ–¹æ¡ˆä¸å¤šè§ï¼ŒApache PDFBOXæ˜¯å½“å‰æœ€å¼ºçš„ï¼Œä¹Ÿæ˜¯æœ€å¥½çš„&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;åç§°&lt;/th&gt;
      &lt;th&gt;åœ°å€&lt;/th&gt;
      &lt;th&gt;è¯´æ˜&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Apache PDFBox&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://github.com/apache/pdfbox&quot;&gt;https://github.com/apache/pdfbox&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;æä¾›å¼€ç®±å³ç”¨çš„æ–‡æœ¬ã€å›¾ç‰‡å†…å®¹æå–æ–¹å¼ï¼Œå¹¶ä¸”å¯ä»¥åŸºäºStreamæ¥å£é‡å†™å„é¡¹å…ƒç´ çš„è§£æå®ç°ï¼Œ&lt;strong&gt;å¹¶èƒ½è¾“å‡ºå…ƒç´ çš„åæ ‡ä¿¡æ¯&lt;/strong&gt;ã€‚å¼€å‘è€…å¯ä»¥æ ¹æ®å…ƒç´ çš„åæ ‡ä¿¡æ¯ç»“åˆç®—æ³•è¿›è¡Œå†…å®¹çš„é«˜åº¦è¿˜åŸã€‚å”¯ä¸€çš„ç¼ºç‚¹æ˜¯æ²¡æœ‰è¡¨æ ¼ç»„ä»¶æå–çš„APIä¾›å¼€å‘äººå‘˜ä½¿ç”¨ã€‚&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;tabula-java&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://github.com/tabulapdf/tabula-java&quot;&gt;https://github.com/tabulapdf/tabula-java&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;åŸºäºApache PDFBOxç»„ä»¶çš„è¡¨æ ¼æå–å®ç°&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;pythonç”Ÿæ€&quot;&gt;Pythonç”Ÿæ€&lt;/h3&gt;

&lt;p&gt;Pythonç”Ÿæ€çš„PDFæå–ç»„ä»¶è¿˜æ˜¯è›®å¤šçš„ï¼Œä¸è¿‡ä¹Ÿæ˜¯æœ‰ä¸åŒçš„ä¾§é‡ï¼Œæ¯”å¦‚pdfplumberã€camelotç­‰éƒ½ä¸“æ³¨åœ¨è¡¨æ ¼çš„æå–ä¸Šï¼Œæä¾›äº†å¼€ç®±å³ç”¨çš„æ–¹æ¡ˆã€‚&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;åç§°&lt;/th&gt;
      &lt;th&gt;åœ°å€&lt;/th&gt;
      &lt;th&gt;è¯´æ˜&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;pypdf&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://github.com/py-pdf/pypdf&quot;&gt;https://github.com/py-pdf/pypdf&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;ä¸€ä¸ªçº¯Python PDFåº“ï¼Œèƒ½å¤Ÿåˆ†å‰²ã€åˆå¹¶ã€è£å‰ªå’Œè½¬æ¢PDFæ–‡ä»¶çš„é¡µé¢&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;PyMuPDF(AGPL)&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://github.com/pymupdf/PyMuPDF&quot;&gt;https://github.com/pymupdf/PyMuPDF&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;é«˜æ€§èƒ½ Python åº“ï¼Œç”¨äº PDFï¼ˆå’Œå…¶ä»–ï¼‰æ–‡æ¡£çš„æ•°æ®æå–ã€åˆ†æã€è½¬æ¢å’Œæ“ä½œã€‚&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;strong&gt;&lt;a href=&quot;https://github.com/jsvine/pdfplumber&quot;&gt;pdfplumber&lt;/a&gt;&lt;/strong&gt;(MIT)&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://github.com/jsvine/pdfplumber&quot;&gt;https://github.com/jsvine/pdfplumber&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;æŸ¥çœ‹ PDF ä»¥è·å–æœ‰å…³æ¯ä¸ªå­—ç¬¦ã€çŸ©å½¢ã€çº¿æ¡ç­‰çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶è½»æ¾æå–æ–‡æœ¬å’Œè¡¨æ ¼ã€‚&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;strong&gt;&lt;a href=&quot;https://github.com/camelot-dev/camelot&quot;&gt;camelot&lt;/a&gt;&lt;/strong&gt;ï¼ˆMITï¼‰&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://github.com/camelot-dev/camelot&quot;&gt;https://github.com/camelot-dev/camelot&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;ä¸“æ³¨äºPDFä¸­è¡¨æ ¼çš„æå–ï¼ŒåŒ…æ‹¬å¤æ‚çš„è¡¨æ ¼&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;ocrç”Ÿæ€å¤§æ¨¡å‹&quot;&gt;OCRç”Ÿæ€/å¤§æ¨¡å‹&lt;/h3&gt;

&lt;p&gt;åœ¨ä¸Šé¢Pythonå’ŒJavaç”Ÿæ€åº“çš„å¼€æºç»„ä»¶ï¼ŒåŸºæœ¬éƒ½æ˜¯é’ˆå¯¹æ–‡å­—çš„PDFå¤„ç†ä¸ºä¸»ï¼Œå½“æˆ‘ä»¬çš„PDFæ˜¯æ‰«æä»¶æ—¶ï¼Œé‚£ä¸Šé¢çš„ç»„ä»¶ç»Ÿç»Ÿå¤±æ•ˆï¼Œéƒ½æå–ä¸å‡ºæ¥æ–‡æœ¬ä¿¡æ¯ã€‚&lt;/p&gt;

&lt;p&gt;æ­¤æ—¶å°±éœ€è¦ç”¨åˆ°OCRçš„æ¨¡å‹è¿›è¡Œæå–ã€‚&lt;/p&gt;

&lt;p&gt;è€ƒè™‘åˆ°å¦‚æœæ˜¯OCRæå–ï¼Œé‚£ä¹ˆæœ€ç»ˆçš„ç›®çš„æ˜¯å°†PDFæ–‡ä»¶Pageé¡µç å†…å®¹æå–å‡ºå®Œæˆçš„å›¾ç‰‡Imageï¼Œæ‰€ä»¥æœ¬è´¨ä¸Šæ˜¯å¯¹å›¾ç‰‡å†…å®¹çš„ç†è§£&lt;/p&gt;

&lt;p&gt;å¯ä»¥è€ƒè™‘çš„å¼€æºç»„ä»¶å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;åç§°&lt;/th&gt;
      &lt;th&gt;åœ°å€&lt;/th&gt;
      &lt;th&gt;è¯´æ˜&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;marker(GPL)&lt;/td&gt;
      &lt;td&gt;https://github.com/VikParuchuri/marker&lt;/td&gt;
      &lt;td&gt;åŸºäºæ¨¡å‹å°†PDFæ–‡ä»¶å†…å®¹æå–ä¸ºMarkdownæ ¼å¼&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;surya(GPL)&lt;/td&gt;
      &lt;td&gt;https://github.com/VikParuchuri/surya&lt;/td&gt;
      &lt;td&gt;OCRã€å¸ƒå±€åˆ†æã€é˜…è¯»é¡ºåºã€çº¿æ¡æ£€æµ‹ï¼ˆæ”¯æŒ90 å¤šç§è¯­è¨€ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;tesseract(Apache 2)&lt;/td&gt;
      &lt;td&gt;https://github.com/tesseract-ocr/tesseract&lt;/td&gt;
      &lt;td&gt;è€ç‰ŒOCRç»„ä»¶ï¼Œæ”¯æŒ100å¤šç§è¯­è¨€&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;RapidOCR(Apache)&lt;/td&gt;
      &lt;td&gt;https://github.com/RapidAI/RapidOCR&lt;/td&gt;
      &lt;td&gt;åŸºäº ONNXRuntimeã€OpenVION å’Œ PaddlePaddle çš„å‡ºè‰² OCR å¤šç§ç¼–ç¨‹è¯­è¨€å·¥å…·åŒ…ã€‚&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;PaddleOCR(Apache)&lt;/td&gt;
      &lt;td&gt;https://github.com/PaddlePaddle/PaddleOCR&lt;/td&gt;
      &lt;td&gt;åŸºäºé£æ¡¨çš„å‡ºè‰²å¤šè¯­è¨€OCRå·¥å…·åŒ…ï¼ˆå®ç”¨çš„è¶…è½»é‡çº§OCRç³»ç»Ÿï¼Œæ”¯æŒ80+è¯­è¨€è¯†åˆ«ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;EasyOCR(Apache )&lt;/td&gt;
      &lt;td&gt;https://github.com/JaidedAI/EasyOCR&lt;/td&gt;
      &lt;td&gt;Python\C++å¼€å‘ï¼Œæ”¯æŒ80å¤šç§è¯­è¨€OCRè¯†åˆ«&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;æŠ€æœ¯å‡†å¤‡ç»†èŠ‚&quot;&gt;æŠ€æœ¯å‡†å¤‡/ç»†èŠ‚&lt;/h2&gt;

&lt;p&gt;åœ¨è§£æPDFæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿä¼šæœ‰ä¸€äº›å…¶ä»–æ–¹é¢çš„çŸ¥è¯†å‚¨å¤‡ï¼Œä»¥ä¾¿æˆ‘ä»¬å¿«é€Ÿåº”å¯¹ä¸åŒçš„ä¸šåŠ¡éœ€æ±‚åŠåº”ç”¨äº§å“å½¢æ€ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ã€å›¾å½¢ç±»API&lt;/strong&gt;ï¼šä¸ç®¡æ˜¯Javaè¿˜æ˜¯Pythoné‡Œé¢ï¼Œå¯¹äºå¤„ç†PDFä¸­é—´ä»¶çš„éƒ¨åˆ†ï¼Œéƒ½éœ€è¦å¯¹å›¾å½¢ç±»çš„API/ç®—æ³•ç†Ÿæ‚‰å’ŒæŒæ¡ï¼Œè¿™é‡Œé¢åŒ…å«å›¾å½¢çš„è½¬æ¢ã€ç¼©æ”¾ã€çŸ©é˜µåæ ‡ã€æˆªå–ç­‰ç­‰ï¼Œéƒ½ä¼šåœ¨PDFæå–çš„è¿‡ç¨‹ä¸­ä½¿ç”¨åˆ°ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ã€PDFæ ‡å‡†&lt;/strong&gt;ï¼šåœ¨å¤„ç†PDFä¸­ï¼Œç»“åˆå¼€æºçš„æŠ€æœ¯ä¸­é—´ä»¶ï¼Œå¯¹äºPDFçš„ISOæ ‡å‡†ï¼Œæˆ‘ä»¬ä¹Ÿæ˜¯éœ€è¦äº†è§£çš„ï¼Œè¿™æ ·æ›´åŠ æœ‰åˆ©äºå¼€å‘äººå‘˜ç†è§£ä¸­é—´ä»¶çš„ä»£ç å†™æ³•åŠå«ä¹‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3ã€è¾¹/çº¿/çŸ©é˜µç®—æ³•ç­‰&lt;/strong&gt;ï¼šå¯¹äºæ–‡æœ¬/è¾¹æ¡†çš„èšç±»ç®—æ³•ç­‰ï¼Œåœ¨æ ¹æ®å…ƒç´ åæ ‡é«˜æ•ˆè¿˜åŸæ—¶ï¼Œåˆ©ç”¨é«˜æ•ˆçš„ç®—æ³•å¯ä»¥æé«˜è§£æé€Ÿåº¦ä»¥åŠå†…å®¹è¿˜åŸåº¦&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4ã€OCR/LLMæ¨¡å‹ç­‰&lt;/strong&gt;ï¼šäº†è§£å­¦ä¹ åœ¨ç”¨OCR/LLMæ¨¡å‹åˆ†æå¸ƒå±€ã€è¾¹ç•Œæ£€æµ‹ç­‰ç­‰æŠ€æœ¯ä¸Šçš„ä¸€äº›ç®—æ³•åŠæ•°æ®å·¥ç¨‹ä¸Šçš„å®è·µ&lt;/p&gt;

&lt;p&gt;5ã€&lt;strong&gt;PDFé¡µé¢æ—‹è½¬&lt;/strong&gt;ï¼šæœ‰æ—¶å€™åŸPDFå¯èƒ½ä¼šæœ‰æ—‹è½¬(0ã€90ã€180ã€270åº¦)ï¼Œéœ€å…ˆæ ¡æ­£åï¼Œå†æ¬¡æå–å†…å®¹&lt;/p&gt;

&lt;p&gt;6ã€&lt;strong&gt;å­—ä½“/ä¹±ç &lt;/strong&gt;ï¼šç³»ç»Ÿ/æœåŠ¡å™¨ä¸­ç¼ºå¤±PDFä¸­çš„å­—ä½“ï¼Œå¯¼è‡´æ–‡æœ¬æå–ä¹±ç &lt;/p&gt;

&lt;h2 id=&quot;æœ€å&quot;&gt;æœ€å&lt;/h2&gt;

&lt;p&gt;æœ¬æ–‡ä»å¤§çš„æ–¹é¢ç®€å•æ¦‚æ‹¬äº†åœ¨PDFè§£æå¤„ç†è¿‡ç¨‹ä¸­çš„æŠ€æœ¯æ–¹æ¡ˆ/éš¾ç‚¹/å¼€æºæŠ€æœ¯æ–¹æ¡ˆç­‰å†…å®¹ï¼Œåé¢æˆ‘ä¼šä»ä¸€äº›ç»†èŠ‚æ–¹é¢æ¥é€ä¸€åˆ†äº«æˆ‘ä»¬åœ¨æ„å»ºTorchVäº§å“æ—¶ï¼Œè§£æPDFæ–‡ä»¶è¿‡ç¨‹ä¸­çš„ä¸€äº›é—®é¢˜åŠæŠ€æœ¯å®è·µ,åŒ…æ‹¬å¯¹è¡¨æ ¼çš„æå–ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å…³æ³¨æˆ‘ä»¬ğŸ˜ã€‚&lt;/p&gt;

&lt;p&gt;å¦å¤–ï¼Œæˆ‘ä»¬å›¢é˜Ÿæä¾›äº†ä¸€ä¸ªPDFè§£æçš„Demoåœ°å€ï¼Œé’ˆå¯¹æ–‡æœ¬ç±»çš„PDF(æš‚æ—¶ä¸æ”¯æŒæ‰«æä»¶)ï¼Œå¯ä»¥è¿›è¡Œè¯•ç”¨ä½“éªŒã€‚&lt;/p&gt;

&lt;p&gt;åœ°å€ï¼š&lt;a href=&quot;http://tabletest.torchv.com:8010/&quot;&gt;http://tabletest.torchv.com:8010/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/pdf-01/image-20240706170720200.png&quot; alt=&quot;image-20240706170720200&quot; /&gt;&lt;/p&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="å¤§æ¨¡å‹" /><category term="RAGå®è·µ" /><category term="TorchV" /><category term="RAGæ¦‚è¿°" /><category term="RAG" /><category term="å¤§æ¨¡å‹" /><category term="LLM" /><summary type="html">èƒŒæ™¯</summary></entry><entry><title type="html">æˆ‘å¯¹ã€ŠRAG/å¤§æ¨¡å‹/éç»“æ„åŒ–æ•°æ®çŸ¥è¯†åº“ç±»äº§å“ã€‹æŠ€æœ¯æ¶æ„çš„æ€è€ƒã€æ‚è°ˆ</title><link href="http://localhost:4000/2024/07/03/torchv-think/" rel="alternate" type="text/html" title="æˆ‘å¯¹ã€ŠRAG/å¤§æ¨¡å‹/éç»“æ„åŒ–æ•°æ®çŸ¥è¯†åº“ç±»äº§å“ã€‹æŠ€æœ¯æ¶æ„çš„æ€è€ƒã€æ‚è°ˆ" /><published>2024-07-03T00:00:00+08:00</published><updated>2024-07-03T00:00:00+08:00</updated><id>http://localhost:4000/2024/07/03/torchv-think</id><content type="html" xml:base="http://localhost:4000/2024/07/03/torchv-think/">&lt;h2 id=&quot;1å‰è¨€&quot;&gt;1ã€å‰è¨€&lt;/h2&gt;

&lt;p&gt;åœ¨6.28/29çš„ç¨€åœŸæ˜é‡‘å¼€å‘è€…å¤§ä¼šRAGä¸“åœºä¸Šï¼Œæˆ‘ä»¬å…¬å¸CEOå‘˜å¤–ä»£è¡¨TorchVåˆ†äº«äº†æˆ‘ä»¬åœ¨ã€ŠRAGåœ¨ä¼ä¸šåº”ç”¨ä¸­è½åœ°çš„éš¾ç‚¹ä¸åˆ›æ–°ã€‹&lt;/p&gt;

&lt;p&gt;å…¶ä¸­æœ€ååˆ†äº«äº†ä¸¤ä¸ªè§‚ç‚¹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;AIåœ¨åº”ç”¨åœºæ™¯è½åœ°æ—¶æœ‰ä¸‰ä¸ªç‰¹ç‚¹ï¼šåŠŸèƒ½å°ã€è´¨é‡é«˜ã€ä»·å€¼å¤§&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-4/image-20240701143924758.png&quot; alt=&quot;image-20240701143924758&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¦‚æœè¯´åšäº§å“æ˜¯æŠŠä¸€æ¨ªåšå¥½çš„è¯ï¼Œé‚£ä¹ˆå»åšä¼ä¸šè½åœ°æœåŠ¡å°±æ˜¯ä¸€ç«–ï¼Œä»éœ€æ±‚å’Œæ–¹æ¡ˆï¼Œå†åˆ° POCï¼Œå’Œæœ€åäº¤ä»˜ã€‚&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-4/image-20240701143941791.png&quot; alt=&quot;image-20240701143941791&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¯¹äºAIåº”ç”¨çš„ä¸‰ä¸ªç‰¹ç‚¹ï¼Œæˆ‘ä»¬åœ¨è½åœ°çš„æ—¶å€™ï¼Œå…¶å®ç¢°åˆ°çš„é—®é¢˜è›®å¤šçš„ï¼Œä½†æ˜¯ç”¨è¿‡å¤§æ¨¡å‹æˆ–è€…AIäº§å“çš„äººåº”è¯¥éƒ½çŸ¥é“ï¼Œç›®å‰åŸºäºå¤§æ¨¡å‹åº”ç”¨å¼€å‘çš„Cç«¯äº§å“å…¶å®åœ¨æ•´ä½“ç»™äººçš„æ„Ÿè§‰éƒ½æ˜¯ç›¸å¯¹è¾ƒå°çš„å·¥å…·å±…å¤šï¼Œåœ¨å¸®åŠ©äººç±»ææ•ˆè¿™ä»¶äº‹ä¸Šï¼Œå€ŸåŠ©äºAIå·¥å…·ï¼Œèƒ½å¾ˆå¥½çš„å®Œæˆæ—¥å¸¸ç¹æ‚çš„å·¥ä½œå’Œå­¦ä¹ ä»»åŠ¡ã€‚æ¯”å¦‚&lt;strong&gt;AIç¿»è¯‘&lt;/strong&gt;ã€&lt;strong&gt;ç½‘é¡µæ€»ç»“&lt;/strong&gt;æ’ä»¶ç­‰ç­‰ã€‚è¿™ç±»äº§å“æ›´å¤šçš„æ˜¯åCç«¯ä¸ºä¸»ï¼Œå€ŸåŠ©äºäº’è”ç½‘çš„ç”Ÿæ€ä»¥åŠå¼€æºæŠ€æœ¯çš„å‘å±•ï¼Œåªè¦åŠŸèƒ½/äº¤äº’æ»¡è¶³ç”¨æˆ·çš„è¦æ±‚ï¼Œå¾ˆå¿«å°±èƒ½æ‰“åŠ¨Cç«¯ç”¨æˆ·è¿›è¡Œå°é²œè¯•ç”¨ç”šè‡³ä»˜è´¹ã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯åšBç«¯ç±»çš„äº§å“ï¼Œæ•´ä¸ªäº¤ä»˜çš„è¿‡ç¨‹å°±æ˜æ˜¾å’ŒCç«¯ä¸ä¸€æ ·ï¼Œåœ¨Bç«¯æˆ‘ä»¬é™¤äº†äº§å“æœ¬èº«éœ€è¦åŠŸèƒ½è¶³å¤Ÿå¼ºå¤§ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åšAIçš„è½åœ°äº¤ä»˜ï¼Œè¿™é‡Œé¢åŒ…å«&lt;strong&gt;ç§æœ‰åŒ–å®šåˆ¶&lt;/strong&gt;/&lt;strong&gt;å®¢æˆ·åŸ¹è®­&lt;/strong&gt;/&lt;strong&gt;ç§æœ‰åŒ–éƒ¨ç½²&lt;/strong&gt;/&lt;strong&gt;è½¯ç¡¬ä»¶é€‚é…&lt;/strong&gt;ç­‰ç­‰ç¹æ‚çš„å·¥ä½œï¼Œæ•´ä¸ªäº¤ä»˜å‘¨æœŸæ¼«é•¿çš„å¤šã€‚è¿™æ˜æ˜¾æ˜¯å’Œä¸Šé¢ç¬¬äºŒä¸ªè§‚ç‚¹ç›¸å‘¼åº”çš„ï¼Œ&lt;strong&gt;äº§å“+æœåŠ¡&lt;/strong&gt;æ‰èƒ½ç»¼åˆæœåŠ¡å¥½Bç«¯çš„å®¢æˆ·ã€‚&lt;/p&gt;

&lt;p&gt;æœ¬ç¯‡æ˜¯ç»“åˆæˆ‘ä»¬å…¬å¸åœ¨Bç«¯RAG/å¤§æ¨¡å‹åº”ç”¨äº§å“çš„è½åœ°äº¤ä»˜çš„åœºæ™¯è€ƒè™‘ï¼Œä»¥å®é™…åœºæ™¯å‡ºå‘ï¼Œè°ˆè°ˆæˆ‘å¯¹çŸ¥è¯†åº“ç±»äº§å“çš„æŠ€æœ¯æ¶æ„çš„æ€è€ƒæ€»ç»“ã€‚&lt;/p&gt;

&lt;h2 id=&quot;2ä¸šåŠ¡åŠŸèƒ½æŠ€æœ¯ç»„ä»¶æ‹†è§£æŠ½è±¡&quot;&gt;2ã€ä¸šåŠ¡åŠŸèƒ½/æŠ€æœ¯ç»„ä»¶æ‹†è§£æŠ½è±¡&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-4/image-20240703085452132.png&quot; alt=&quot;image-20240703085452132&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨æ–‡ç« çš„æ ‡é¢˜ä¸­ï¼Œæˆ‘å·²ç»æ ‡æ³¨äº†èŒƒå›´: &lt;strong&gt;RAG&lt;/strong&gt;ã€&lt;strong&gt;å¤§æ¨¡å‹&lt;/strong&gt;ã€&lt;strong&gt;éç»“æ„åŒ–æ•°æ®&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬ä»è¿™ä¸‰ä¸ªæ–¹é¢å‡ºå‘ï¼Œåœ¨è½¯ä»¶å±‚é¢ï¼Œæˆ‘ä»¬å¦‚ä½•æ¥è€ƒè™‘è¿™äº›æ–°å‹çš„æŠ€æœ¯åè¯ï¼Œå°†ä»–ä»¬ä»æŠ€æœ¯/äº§å“åŠŸèƒ½çš„è§’åº¦è¿›è¡Œæ‹†è§£ï¼Œå®ç°å¯¹åº”çš„åŠŸèƒ½äº¤ä»˜ç»™æˆ‘ä»¬çš„å®¢æˆ·ã€‚&lt;/p&gt;

&lt;p&gt;ä»ä¸šåŠ¡çš„åŠŸèƒ½è¯‰æ±‚æ¥çœ‹ï¼Œä¸»è¦æœ‰å‡ ä¸ªæ–¹é¢ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;çŸ¥è¯†åº“&lt;/strong&gt;ï¼šå®¢æˆ·éœ€è¦å°†ä¸šåŠ¡æ•°æ®ç»Ÿä¸€æ”¶é›†å¤„ç†ï¼Œå½¢æˆçŸ¥è¯†åº“ï¼Œä»¥ä¾¿æä¾›ç»™LLMè¿›è¡Œä½¿ç”¨&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åº”ç”¨ä¸­å¿ƒ&lt;/strong&gt;ï¼šBç«¯å®¢æˆ·éœ€è¦å¼€ç®±å³ç”¨çš„äº§å“ï¼Œè§£å†³å®é™…å·¥ä½œä¸šåŠ¡ä¸­ç¢°åˆ°çš„é—®é¢˜&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç”¨æˆ·æƒé™&lt;/strong&gt;ï¼šç³»ç»Ÿæä¾›ä¼ä¸šçº§çµæ´»å¯æ§çš„æƒé™ç®¡ç†ï¼Œæ–¹ä¾¿ä¼ä¸šå®¢æˆ·è¿›è¡Œç»Ÿä¸€ç®¡ç†æˆæƒã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¤šç§Ÿæˆ·&lt;/strong&gt;ï¼šå¤šç§Ÿæˆ·ä½“ç³»æ¶æ„æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå¯ä»¥ä¿è¯æ•°æ®ä»¥Schemaçº§åˆ«è¿›è¡Œéš”ç¦»ï¼Œä¿éšœæ•°æ®å®‰å…¨ä»¥åŠä¸Šå±‚åº”ç”¨çš„çµæ´»è¾“å‡ºæ”¯æ’‘ã€‚&lt;/li&gt;
  &lt;li&gt;â€¦&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è€Œä»æŠ€æœ¯ä¾§è€ƒè™‘ï¼ŒæŠ€æœ¯äººå‘˜éœ€è¦å…³æ³¨çš„æ˜¯ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;éç»“æ„åŒ–æ•°æ®çš„å¤„ç†&lt;/strong&gt;ï¼šå¹³å°éœ€è¦æ”¯æŒå¤šç§å¤šæ ·çš„éç»“æ„åŒ–æ•°æ®çš„æå–å¤„ç†å·¥ä½œï¼Œå°†æ•´ä¸ªæ–‡æ¡£å†…å®¹è¿›è¡Œchunkingã€embeddingè¿›å…¥æ•°æ®åº“ï¼Œä»¥ä¾¿è¿›è¡Œæœç´¢
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;æ–‡ä»¶ç±»å‹å¹¿åº¦&lt;/strong&gt;ï¼šæä¾›ä¼—å¤šçš„éç»“æ„åŒ–æ•°æ®æ–‡æ¡£(PDF/PPT/WORDç­‰)çš„æå–æ”¯æŒï¼Œæ˜¯æ‰“åŠ¨Bç«¯å®¢æˆ·çš„æœ‰åˆ©å¸å¼•ç‚¹ï¼Œ&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;æ–‡ä»¶è§£æç²¾åº¦&lt;/strong&gt;ï¼šä»¥PDF/PPT/Wordä¸ºé¦–çš„æ–‡æ¡£è§£æå·¥ä½œå›°éš¾é‡é‡ï¼Œå¦‚ä½•åœ¨è§£æçš„å·¥ä½œä¸Šæ›´è¿›ä¸€æ­¥ï¼Œä»æ ¹æºä¸Šå‡å°‘æ¨¡å‹åœ¨åˆ©ç”¨å·²çŸ¥æ•°æ®çš„å¹»è§‰é—®é¢˜&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;ä»»åŠ¡è°ƒåº¦&lt;/strong&gt;ï¼šæ•°æ®çš„å¤„ç†ä¾é ç¨³å®šçš„ä»»åŠ¡è°ƒåº¦å¹³å°ï¼Œä¿è¯æ•°æ®å¤„ç†çš„æœ€ç»ˆæœ‰åºæ‰§è¡Œã€‚&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ¨¡å‹æœåŠ¡&lt;/strong&gt;ï¼šä»LLMå¤§è¯­è¨€æ¨¡å‹ã€Rerankeræ¨¡å‹ã€embeddingã€OCRæ¨¡å‹ã€è§†è§‰æ¨¡å‹ç­‰ç­‰ï¼Œ&lt;strong&gt;ä¿è¯æ¨¡å‹çš„å¹‚ç­‰è¾“å‡º&lt;/strong&gt;ï¼Œä¸ºä¸Šå±‚åº”ç”¨æä¾›ç¨³å®šå¯é çš„æœåŠ¡æ”¯æ’‘ã€‚
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;LLMæ¨¡å‹&lt;/strong&gt;ï¼šæä¾›ä¸€ç³»åˆ—&lt;strong&gt;AgentæœåŠ¡&lt;/strong&gt;ï¼Œä¿è¯ä¸Šå±‚ä¸šåŠ¡èƒ½å¤Ÿçµæ´»è°ƒç”¨å¤§æ¨¡å‹è·å–æ»¡æ„çš„ç»“æœ&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;ReRankeræ¨¡å‹&lt;/strong&gt;ï¼šé‡æ’åºæ¨¡å‹æ˜¯é—®ç­”äºŒé˜¶æ®µå¬å›æé«˜å‡†ç¡®ç‡çš„å…³é”®æ‰‹æ®µï¼Œä¸å¯å¿½è™‘&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Embeddingæ¨¡å‹&lt;/strong&gt;ï¼šå‘é‡åŒ–åµŒå…¥ï¼Œæä¾›å¯¹çŸ¥è¯†æ–‡æœ¬çš„è¡¨å¾æå–å‘é‡å·¥ä½œï¼Œä¸å¯å¿½è™‘&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;OCR/è§†è§‰æ¨¡å‹&lt;/strong&gt;ï¼šè¾…åŠ©éç»“æ„åŒ–æ•°æ®æå–åœ¨è§„åˆ™æå–ä¸æ»¡è¶³çš„æƒ…å†µä¸‹ï¼Œå¯åŠ¨OCRåŠè§†è§‰æ¨¡å‹ï¼Œå¢å¼ºéç»“æ„åŒ–æ•°æ®çš„æä¾›æ•ˆæœ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å‘é‡æ•°æ®åº“(VectorDB)&lt;/strong&gt;: éœ€è¦ç»“åˆå®é™…ä¸šåŠ¡è¯‰æ±‚ï¼Œä»æ€§èƒ½/ç©ºé—´/ç”Ÿæ€ç­‰å¤šæ–¹é¢è€ƒé‡VectorDBç­‰é€‰å‹&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æŠ€æœ¯çš„è§’åº¦æ‹†åˆ†ï¼Œå…¶å®æŠ€æœ¯äººå‘˜å…³æ³¨çš„ç‚¹éå¸¸çš„å¤šï¼Œæ¯ä¸€é¡¹å·¥ä½œå…¶å®éƒ½å¯ä»¥æ˜¯ç‹¬ç«‹çš„ä¸­é—´ä»¶äº§å“ï¼Œè¦æŠŠè¿™äº›å…¨éƒ¨æ•´åˆåˆ°ä¸€å—ï¼Œå¹¶éæ˜“äº‹ã€‚&lt;/p&gt;

&lt;h2 id=&quot;3å¾®æœåŠ¡åˆ†å¸ƒå¼äº‘åŸç”Ÿ&quot;&gt;3ã€å¾®æœåŠ¡/åˆ†å¸ƒå¼/äº‘åŸç”Ÿï¼Ÿ&lt;/h2&gt;

&lt;p&gt;å†™è¿‡Javaçš„ä¼°è®¡å¯¹ä¸Šé¢è¿™ä¸‰ä¸ªåè¯éƒ½å·²ç»æ»šç“œä¹±ç†Ÿäº†ï¼Œæˆ‘è®°å¾—å¾ˆæ—©ä¹‹å‰ï¼Œè¯´é¢è¯•ä½ å¦‚æœä¸ä¼šå¾®æœåŠ¡ï¼Œé‚£éƒ½æ‰¾ä¸åˆ°å·¥ä½œ(PS:ç°åœ¨å¥½åƒä¸ç®¡ä½ ä¼šä»€ä¹ˆï¼Œä¹ŸåŒæ ·éƒ½æ‰¾ä¸åˆ°)ğŸ˜‚ã€‚&lt;/p&gt;

&lt;p&gt;å¯¹äºAIåº”ç”¨ï¼Œå¯èƒ½æ›´å¤šçš„è½¯ä»¶ç”Ÿæ€æ˜¯ç”±Pythonå¸¦åŠ¨èµ·æ¥çš„ï¼ŒåŒ…æ‹¬ä¸€äº›å·¥å…·åº“LangChainã€LlamaIndexç­‰éƒ½æ˜¯Pythonï¼Œè™½ç„¶Javaä¸­ä¹Ÿä¸ä¹æœ‰ä¸€äº›ï¼Œæ¯”å¦‚LangChain4jã€Spring-AIç­‰ç»„ä»¶ï¼Œéƒ½æ˜¯åèµ·ä¹‹ç§€ï¼Œåœ¨æ•´ä¸ªç”Ÿæ€ç¨³å®šæ€§ç­‰æ–¹é¢ç¡®å®æ˜¯è½åäº†ä¸€èŠ‚ã€‚&lt;/p&gt;

&lt;p&gt;ä½†å¯èƒ½å¾ˆå¤šäººéƒ½åœ¨ç”¨è¿‡LangChainç­‰æ¡†æ¶åæœ‰ä¸€ä¸ªå…±è¯†ï¼Œé‚£å°±æ˜¯å½“ä½œå·¥å…·ç”¨æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯ä¸Šç”Ÿäº§ï¼Ÿé—®é¢˜å¤ªå¤šäº†ã€‚æˆ‘è§‰å¾—ä¸»è¦çš„å‡ ä¸ªç‚¹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;LangChainçš„è¿‡åº¦å°è£…ï¼Œå¯¹äºåº”ç”¨å±‚è€Œè¨€ï¼Œä¸ç®¡æ˜¯Agentï¼Œè¿˜æ˜¯RAGï¼Œå…¶å®è›®ç®€å•çš„ä¸€ä»¶äº‹æƒ…ï¼Œå’Œå¤§æ¨¡å‹APIæ¥å£å¯¹æ¥å°±å¥½äº†ï¼Œä½†æ˜¯ä½ å»çœ‹LangChainçš„æºç ï¼Œæ•´ä¸ªè°ƒç”¨é“¾è·¯å°è£…çš„æå…¶å¤æ‚ï¼Œæ”¹éƒ½æ²¡æ³•æ”¹ã€‚&lt;/li&gt;
  &lt;li&gt;ä¸Šå±‚çš„ä¸šåŠ¡éœ€æ±‚å˜åŒ–å¤ªå¤§äº†ï¼Œæœ‰æ—¶å€™æ˜¯éœ€è¦ç»“åˆè‡ªå·±å…¬å¸çš„å®é™…ä¸šåŠ¡æƒ…å†µæ¥è¿›è¡Œå¤„ç†çš„ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œè¿˜ä¸å¦‚è‡ªå·±å†™æ¥çš„å¿«ï¼Œå…¶å®è°ƒç”¨çš„é“¾è·¯å¹¶ä¸å¤æ‚&lt;/li&gt;
  &lt;li&gt;å°±ç¨³å®šæ€§/äº‹åŠ¡/æ•°æ®ä¸€è‡´æ€§è€Œè¨€ï¼ŒPythonä½œä¸ºä¼ä¸šæœåŠ¡æ¥å£ä¸»è¯­è¨€æ˜¯å¦åˆé€‚å‘¢ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è€Œæˆ‘ä»¬ä»Šå¤©è®¨è®ºçš„æ˜¯æ•´ä¸ªäº§å“çš„æŠ€æœ¯æ¶æ„çš„é€‰æ‹©ï¼Œå…¶å®åœ¨ä¸Šé¢ä¸šåŠ¡åŠŸèƒ½/æŠ€æœ¯ç»„ä»¶æŠ½è±¡é‚£ä¸€èŠ‚ï¼Œæˆ‘ä»¬å·²ç»æ‹†åˆ†äº†åŠŸèƒ½å’ŒæŠ€æœ¯ç‚¹ï¼Œä»æŠ€æœ¯ç‚¹å»çœ‹ï¼Œè¿™å·²ç»æ˜¯ä¸€ä¸ªé›†ä¼—å¤šæœåŠ¡äºä¸€ä½“çš„ç»¼åˆæŠ€æœ¯è§£å†³æ–¹æ¡ˆäº†ã€‚åœ¨åº”ç”¨å±‚é¢çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬æ˜¯å¦è¿˜éœ€è¦åƒä»¥å‰é‚£æ ·ï¼Œæ•´ä¸€å¥—å¾®æœåŠ¡æ¶æ„å‡ºæ¥æ¥å¼€å‘ä¸šåŠ¡åŠŸèƒ½ï¼Ÿ&lt;/p&gt;

&lt;p&gt;æˆ‘çš„ä¸ªäººçœ‹æ³•æ˜¯ï¼š&lt;strong&gt;æ ¹æ®å›¢é˜Ÿé…ç½®ï¼Œå¾®æœåŠ¡å¯ç”¨å¯ä¸ç”¨ã€‚ä½†æ˜¯åº”ç”¨ç¨‹åºå¿…é¡»å¤©ç„¶åˆ†å¸ƒå¼ï¼Œæ”¯æŒæ¨ªå‘æ‰©å±•é›†ç¾¤ï¼Œå¼¹æ€§ä¼¸ç¼©ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ç›®å‰è¿™ä¸ªç¯å¢ƒï¼Œé¡¹ç›®æå¾®æœåŠ¡ï¼Œæœ€åçš„å›°å¢ƒå¯èƒ½å°±æ˜¯æ‰€æœ‰æœåŠ¡éƒ½æ˜¯ä½ ä¸€ä¸ªäººè´Ÿè´£ï¼Œå†™å®ŒaæœåŠ¡å†™bæœåŠ¡ï¼Œå†æ¥ä¸ªrpcè°ƒç”¨ï¼Œè¿˜è¦è€ƒè™‘æ•°æ®ç†”æ–­ã€å¯ç”¨æ€§ç­‰ç­‰ï¼Œå°å›¢é˜Ÿæˆ‘è§‰å¾—å®Œå…¨æ²¡å¿…è¦æŠ˜è…¾ï¼&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ä¸»è¦è€ƒè™‘çš„ç‚¹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ã€æµ·é‡éç»“æ„åŒ–æ•°æ®å¤„ç†çš„ææ•ˆ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;åœ¨å¤„ç†RAGäº§å“ç±»ä¸­ï¼Œéç»“æ„åŒ–æ•°æ®çš„å¤„ç†é™¤äº†å¿«é€Ÿè§£æä¹‹å¤–ï¼Œè¿˜éœ€è¦å°†æ–‡æœ¬è¿›è¡Œå‘é‡åŒ–ï¼Œè€Œæˆ‘ä»¬åœ¨æŠ€æœ¯æ¶æ„ä¸­éœ€è¦èƒ½å¤Ÿå¿«é€Ÿçš„å¤„ç†è¿™äº›æ–‡ä»¶ï¼Œé€šè¿‡Pipelineçš„æ–¹å¼ï¼Œå°†éç»“æ„åŒ–æ•°æ®æœ€ç»ˆå­˜å‚¨åˆ°å‘é‡æ•°æ®åº“ä¸­ï¼Œè¿™é‡Œé¢ä¼ ç»Ÿçš„åšæ³•ä¸å¾—ä¸ç”¨æ¶ˆæ¯ä¸­é—´ä»¶MQï¼Œè€Œåº”ç”¨å±‚é¢çš„ç¨‹åºåˆ™å¯ä»¥é€šè¿‡è€ƒè™‘å¼¹æ€§ä¼¸ç¼©çš„æ–¹å¼ï¼Œæ‰©å……æ¶ˆè´¹èŠ‚ç‚¹ï¼Œä»¥æé«˜æ•´ä½“çš„å¤„ç†æ•ˆç‡&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ã€æµ·é‡å‘é‡æ•°æ®çš„å­˜å‚¨/è®¡ç®—å¬å›æ•ˆç‡&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;å½“æˆ‘ä»¬å¯¹éç»“æ„åŒ–æ•°æ®è¿›è¡Œæå–åï¼Œéœ€è¦ç»è¿‡Embeddingæ¨¡å‹è¿›è¡Œå‘é‡åŒ–ï¼Œè¿™é‡Œé¢è¿˜æ¶‰åŠåˆ°æ–‡æœ¬çš„Chunkingåˆ†å—ï¼Œæ‰€ä»¥åº•å±‚å‘é‡æ•°æ®çš„å­˜å‚¨å’Œè®¡ç®—å¿…ç„¶æ˜¯ä¸€ä¸ªéœ€è¦æ›´å…¨é¢çš„è€ƒè™‘å‘é‡æ•°æ®åº“ä¸­é—´ä»¶ï¼Œè¿™å…¶ä¸­åŒ…æ‹¬ï¼šå‘é‡å¬å›çš„æ€§èƒ½ã€æ•°æ®çš„å­˜å‚¨/å¤‡ä»½ã€å¤šç§Ÿæˆ·Schemaçº§åˆ«æ•°æ®æƒé™ç­‰ç­‰&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3ã€æ•°æ®æœ€ç»ˆä¸€è‡´æ€§&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ•°æ®çš„Embeddingå¤„ç†ã€å¤§æ¨¡å‹è°ƒåº¦æ‰£è´¹ã€ç¼“å­˜ç­‰ç­‰ï¼Œåœ¨ç›®å‰å·²ç»ä¼—å¤šæœåŠ¡ç»„ä»¶æ‹†åˆ†çš„æƒ…å†µä¸‹ï¼Œæ•´ä¸ªæ•°æ®çš„å¤„ç†ä»»åŠ¡æˆ‘è§‰å¾—éœ€è¦ä¿è¯æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ï¼Œåœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œå¤šèŠ‚ç‚¹å¤„ç†æ—¶éœ€è¦ç‰¹åˆ«æ³¨æ„ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4ã€åº”ç”¨åŠŸèƒ½åŸå­æ€§ï¼ˆäº‘åŸç”Ÿï¼‰&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ•´ä¸ªåº”ç”¨å±‚çš„åŠŸèƒ½ï¼Œæˆ‘è§‰å¾—éœ€è¦&lt;strong&gt;ä¿æŒç‹¬ç«‹ï¼Œå¹¶ä¸”ä¿éšœç¨³å®šæ€§&lt;/strong&gt;ï¼Œè¿™ç‚¹å…¶å®æˆ‘è§‰å¾—åœ¨ç§æœ‰åŒ–éƒ¨ç½²/äº¤ä»˜çš„ç¯èŠ‚æ¯”è¾ƒå¥æ•ˆã€‚å¦‚æœä½ æ˜¯ä¸€åè¿ç»´æˆ–è€…ä¸»åŠ›å¼€å‘è€…ï¼Œåœ¨ä¸€ä¸ªå®Œå…¨å†…ç½‘éš”ç¦»çš„ç¯å¢ƒä¸‹éƒ¨ç½²æ—¶ï¼Œä½ ä¼šä½“ä¼šåˆ°è¿™ç§ä¾¿æ·ã€‚&lt;/p&gt;

&lt;p&gt;æ€»ä¹‹ï¼Œæˆ‘è§‰å¾—åœ¨åº”ç”¨å±‚é¢æœåŠ¡ï¼ŒæœåŠ¡ç«¯åº”è¯¥åšçš„æ˜¯ï¼š&lt;strong&gt;å‡å°‘é…ç½®ã€è½»é‡åŒ–ã€ç¨³å®š&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;4ç¼–ç¨‹è¯­è¨€ä¸­é—´ä»¶é€‰æ‹©&quot;&gt;4ã€ç¼–ç¨‹è¯­è¨€/ä¸­é—´ä»¶é€‰æ‹©ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;æˆ‘ä»¬å›¢é˜Ÿç›®å‰çš„å¼€å‘è¯­è¨€æ˜¯Java+Pythonçš„ç»„åˆï¼Œä¸»è¦æœ‰èŒè´£åˆ†å·¥ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Javaï¼šä¸Šå±‚ä¸šåŠ¡åº”ç”¨çš„APIæ¥å£ï¼Œä»»åŠ¡è°ƒåº¦ã€æ•°æ®å¤„ç†ç­‰ç­‰&lt;/li&gt;
  &lt;li&gt;Pythonï¼šå’Œæ¨¡å‹ã€æ•°æ®å¤„ç†ã€NLPç­‰ç›¸å…³ä»»åŠ¡ä»¥æ¥å£çš„å½¢å¼å¼€æ”¾å‡ºæ¥ï¼ŒAPIæ¥å£æ˜¯æ— çŠ¶æ€çš„ï¼Œæ‰€æœ‰çš„æ•°æ®çŠ¶æ€æµè½¬éƒ½åœ¨Javaç«¯å®ç°&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿™é‡Œé¢å¾ˆå¤šå¼€å‘å¯èƒ½ä¼šæœ‰ä¸€äº›æ‹…å¿§ï¼Œå¯¹äºJavaè¯­è¨€çš„é€‰æ‹©ï¼Œæ˜¯å¦åœ¨ç›®å‰çš„RAG/å¤§æ¨¡å‹é¢†åŸŸåˆé€‚ï¼Ÿå…¶å®æœ€å›°æƒ‘çš„å°±æ˜¯éç»“æ„åŒ–æ•°æ®çš„å¤„ç†ï¼Œå¯èƒ½å¾ˆå¤šå¼€å‘è€…çœ‹åˆ°ç›®å‰å¼€æºçš„ä¼—å¤šç»„ä»¶æˆ–è€…å¹³å°ï¼Œéƒ½æ˜¯Pythonçš„ä¸»æŠ€æœ¯æ ˆï¼Œè®¤ä¸ºJavaå¤„ç†ä¸äº†ï¼Œå…¶å®è¿™æ˜¯å®Œå…¨æœ‰è¯¯åŒºçš„ï¼Œå¯¹äºæœ€éš¾å¤„ç†çš„PDFæ–‡ä»¶æå–ï¼Œ&lt;strong&gt;Apache PDFBox&lt;/strong&gt;ç»å¯¹æ˜¯å€¼å¾—ä½ æ·±æŒ–çš„ä¸€ä¸ªç»„ä»¶ï¼Œå½“ç„¶Pythonæœ¬æ¥å°±æ“…é•¿æ•°æ®å¤„ç†/åˆ†æï¼Œå¯ä»¥æ ¹æ®å›¢é˜Ÿçš„é…ç½®è¿›è¡Œæ‰§è¡Œé€‰æ‹©ï¼Œè¿™é‡Œé¢æˆ‘è§‰å¾—ä¸»è¦è€ƒè™‘çš„å‡ ä¸ªç‚¹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ã€å›¢é˜Ÿäººå‘˜é…ç½®&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ ¹æ®å›¢é˜Ÿå½“å‰çš„ä¸»æµç¼–ç¨‹è¯­è¨€å»åšæŠ€æœ¯æ¶æ„ä¸Šçš„é€‰å‹å’Œå†³ç­–ï¼Œå¹¶æ²¡æœ‰ç»å¯¹æ„ä¹‰ä¸Šçš„ä»¥å“ªä¸ªç¼–ç¨‹è¯­è¨€ä¸ºä¸»ï¼ŒJavaã€Pythonã€Goã€NodeJSã€TypeScriptç­‰ç­‰éƒ½å¯ä»¥ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ã€è½¯ä»¶ç”Ÿæ€&amp;amp;æŠ€æœ¯æˆç†Ÿåº¦&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ä¸Šå±‚åº”ç”¨äº§å“çš„å¼€å‘ï¼Œè‚¯å®šé¦–å…ˆè¦è€ƒè™‘æœ‰å“ªäº›æˆç†Ÿçš„ä¸­é—´ä»¶å’Œç»„ä»¶ï¼Œæ¥å¼€å‘å®Œæˆè¿™ä¸€ä¼—å¤šçš„éœ€æ±‚ï¼Œæ€»ä¸èƒ½ä»0åˆ°1é€ è½®å­ï¼Œé€ è½®å­å›ºç„¶èƒ½æå‡å¼€å‘äººå‘˜çš„æ°´å¹³æŠ€èƒ½ï¼Œä½†æ˜¯åœ¨AIæ—¥ç›Šå‘å±•çš„ä»Šå¤©ï¼Œä¸ºå…¬å¸äº§å“å°½æ—©çš„æ‰¾åˆ°PMFæ‰æ˜¯é¦–è¦ä»»åŠ¡ã€‚éœ€è¦ç»¼åˆè€ƒè™‘ã€‚&lt;/p&gt;

&lt;p&gt;å…¶ä»–çš„ç¼–ç¨‹è¯­è¨€æˆ‘ä¸äº†è§£ï¼Œå°±éç»“æ„åŒ–æ•°æ®çš„è§£æè¿™ä¸€å—ï¼Œå…¶å®Pythonå’ŒJavaéƒ½ç›¸å¯¹æ›´åŠ ä¸°å¯Œå’Œç¨³ å®šã€‚&lt;/p&gt;

&lt;p&gt;Javaè¯­è¨€ä¸­æ¯”è¾ƒå¥½ç”¨çš„åŒ…æ‹¬ï¼šApache PDFBoxã€POIã€Tika&lt;/p&gt;

&lt;p&gt;Pythonä¸­åŒ…æ‹¬ï¼šPyMuPDFã€pdfplumberã€pypdfã€camelotã€python-docxç­‰ç­‰&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3ã€ç¨³å®šæ€§/é›†ç¾¤/é«˜å¯ç”¨&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;å—¯ï¼Œè¿™é‡Œæ²¡æœ‰é«˜å¹¶å‘ï¼Œå› ä¸ºå¤§å®¶éƒ½æ²¡å¡ğŸ˜‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å¤§æ¨¡å‹çš„äº§å“ç›¸æ¯”è¾ƒä¼ ç»Ÿçš„ä¸šåŠ¡åœ¨è¿™ç‚¹ä¸Šå¹¶æ²¡æœ‰ å¤ªå¤šçš„åŒºåˆ«ï¼Œç¨³å®šæ€§/é›†ç¾¤ç­‰ç‰¹ç‚¹ä¹Ÿæ˜¯éœ€è¦çš„ï¼ŒæŠ€æœ¯äººå‘˜åœ¨é€‰æ‹©ä¸­é—´ä»¶æ—¶ï¼Œä¹Ÿåº”å½“è€ƒè™‘è¿™ä¸€ç‚¹ã€‚&lt;/p&gt;

&lt;p&gt;ä¾‹å¦‚MQæ¶ˆæ¯ä¸­é—´ä»¶ã€ç¼“å­˜Redisç­‰ç­‰&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4ã€éƒ¨ç½²å®æ–½/äº¤ä»˜&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ²¡é”™ï¼Œæœ€åä¸€æ­¥éƒ¨ç½²å®æ–½è¿™ä¸ªç¯èŠ‚ä¹Ÿéœ€è¦è€ƒè™‘ï¼ŒDockerç¡®å®èƒ½å¸¦æ¥æå¤§çš„ä¾¿åˆ©ï¼Œä½†æ˜¯æˆæœ¬ä¹Ÿæ˜¯éœ€è¦è€ƒé‡çš„ï¼Œç›®å‰çš„Pythonç”Ÿæ€æ‰“åŒ…æ•´ä¸ªDockerï¼Œå‹ç¼©åŒ…åŠ¨è¾„2ã€3Gèµ·æ­¥ï¼Œå…¶å®ä¹Ÿæ˜¯è›®å¤´ç–¼çš„ï¼Œå¦‚æœä½ æ˜¯ä½¿ç”¨K8sè°ƒåº¦æ¥éƒ¨ç½²ï¼Œk8sæ‹‰å–ä¸€ä¸ª10Gçš„é•œåƒä¹Ÿä¸æ˜¯é‚£ä¹ˆå¿«çš„ğŸ˜‚&lt;/p&gt;

&lt;h2 id=&quot;5æ€»ç»“&quot;&gt;5ã€æ€»ç»“&lt;/h2&gt;

&lt;p&gt;AIåº”ç”¨æ˜¯ä¸€ä¸ªéœ€è¦å¿«é€Ÿè¯•é”™ã€åŠŸèƒ½å¼ºå¤§çš„æŸä¸€ä¸ªç‚¹å»çªç ´ï¼ŒæŠ€æœ¯æ¶æ„ä¸Šï¼Œä¹Ÿåº”å½“è€ƒè™‘æ•´ä½“çš„å¼€å‘æ•ˆç‡ã€ç”Ÿæ€ç­‰ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;è¿™è®©æˆ‘æƒ³èµ·æ¥åå‡ å¹´å‰çš„jQueryï¼Œä¸€ç»é¢ä¸–ï¼Œå¾—åˆ°ä¼—å¤šå¼€å‘è€…çš„å–œçˆ±ï¼Œç»å…¸åè¨€ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Write Less, Do More!!!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åœ¨å¤§æ¨¡å‹æ—¥ç›Šå¥å£®å‘å±•çš„åŒæ—¶ï¼Œæˆ‘ä»¬çš„æŠ€æœ¯æ¶æ„ï¼Œæ˜¯å¦ä¹Ÿåº”è¯¥åšä¸€æ¬¡ç˜¦èº«å‘¢ï¼Ÿ&lt;/p&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="å¤§æ¨¡å‹" /><category term="RAGå®è·µ" /><category term="TorchV" /><category term="RAGæ¦‚è¿°" /><category term="RAG" /><category term="å¤§æ¨¡å‹" /><category term="LLM" /><summary type="html">1ã€å‰è¨€</summary></entry><entry><title type="html">åˆ›ä¸šï¼šå¤§æ¨¡å‹RAGç³»ç»Ÿä¸‰ä¸ªæœˆçš„å¼€å‘å¿ƒå¾—å’Œæ€è€ƒ</title><link href="http://localhost:4000/2024/04/01/torchv-summary-01/" rel="alternate" type="text/html" title="åˆ›ä¸šï¼šå¤§æ¨¡å‹RAGç³»ç»Ÿä¸‰ä¸ªæœˆçš„å¼€å‘å¿ƒå¾—å’Œæ€è€ƒ" /><published>2024-04-01T00:00:00+08:00</published><updated>2024-04-01T00:00:00+08:00</updated><id>http://localhost:4000/2024/04/01/torchv-summary-01</id><content type="html" xml:base="http://localhost:4000/2024/04/01/torchv-summary-01/">&lt;h1 id=&quot;1-å‰è¨€&quot;&gt;1. å‰è¨€&lt;/h1&gt;

&lt;p&gt;è‡ªä»å’Œ&lt;a href=&quot;https://www.luxiangdong.com/&quot;&gt;å‘˜å¤–&lt;/a&gt;ä¸Šå®¶å…¬å¸ç¦»èŒåï¼Œæˆ‘ä»¬å°±è‡ªå·±æå…¬å¸æŠ•å…¥åˆ°äº†RAGå¤§æ¨¡å‹çš„AIäº§å“åº”ç”¨çš„å¼€å‘ä¸­ï¼Œè¿™ä¸­é—´æœ‰ä¸€ä¸ªæ˜¥èŠ‚ï¼Œå‰åçš„æ€»æ—¶é—´å¤§æ¦‚æ˜¯ä¸‰ä¸ªæœˆå·¦å³ï¼Œåœ¨è¿™ä¸‰ä¸ªæœˆæœŸé—´ï¼ŒåŸºæœ¬æ˜¯æ˜¼å¤œå…¼ç¨‹å•Šï¼Œåˆ°ä»Šå¤©3æœˆåº•ç»“æŸï¼Œäº§å“ç›®å‰çœ‹æ˜¯æœ‰äº†ä¸€ä¸ªåŸºç¡€çš„é›å½¢ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨è¿™æœŸé—´ï¼Œå‘˜å¤–è´Ÿè´£æ•´ä¸ªäº§å“çš„è¥é”€ã€å•†ä¸šå®¢æˆ·çš„æ´½è°ˆç­‰æ–¹é¢çš„å†…å®¹ï¼Œæˆ‘å’Œé˜¿åŒ…è´Ÿè´£æ•´ä½“çš„æŠ€æœ¯æ¶æ„æ­å»ºï¼Œä»£ç ä»0-1çš„ç¼–å†™ï¼Œæˆ‘ä»¬æ˜¯åœ¨24å¹´1æœˆ26ï¼Œäº§å“åˆæ­¥ä¸Šçº¿äº†ä¸€ä¸ªç‰ˆæœ¬ï¼Œå¼€å§‹æ¥å—ä¼ä¸šå®¢æˆ·çš„è¯•ç”¨ï¼Œè¿™è®©æˆ‘ä»¬æ¥å—åˆ°äº†å¤§é‡çš„éœ€æ±‚ï¼Œä»¥åŠæˆ‘ä»¬äº§å“åœ¨ç›®å‰çš„å¸‚åœºç¯å¢ƒä¸­è¿˜å­˜åœ¨å“ªäº›ç«äº‰åŠ›ä¸è¶³éœ€è¦æ”¹è¿›çš„åœ°æ–¹ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‰ä¸ªæœˆæ—¶é—´è¿‡å»äº†ï¼Œåœ¨æˆ‘ä»¬çš„TorchV AI äº§å“åˆæ­¥æˆå‹ä¹‹é™…ï¼Œå’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹å¼€å‘RAGã€LLMç³»ç»Ÿä»¥æ¥çš„ä¸€äº›å¿ƒå¾—å’Œç»éªŒã€‚&lt;/p&gt;

&lt;h1 id=&quot;2-ragç®€ä»‹&quot;&gt;2. RAGç®€ä»‹&lt;/h1&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/summary-01/IMG_7625.jpeg&quot; alt=&quot;å›¾1-RAGåŸºç¡€æ¶æ„&quot; /&gt;&lt;/p&gt;

&lt;p&gt;RAG(æ£€ç´¢å¢å¼ºç”Ÿæˆ)åè¯ä¸€å¼€å§‹æ¥æºäº&lt;strong&gt;2020å¹´&lt;/strong&gt;çš„ä¸€ç‰‡è®ºæ–‡ã€Š&lt;a href=&quot;https://arxiv.org/abs/2005.11401&quot;&gt;Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks&lt;/a&gt;ã€‹ï¼Œæ—¨åœ¨ä¸ºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æä¾›é¢å¤–çš„ã€æ¥è‡ªå¤–éƒ¨çŸ¥è¯†æºçš„ä¿¡æ¯ã€‚è¿™æ ·ï¼ŒLLM åœ¨ç”Ÿæˆæ›´ç²¾ç¡®ã€æ›´è´´åˆä¸Šä¸‹æ–‡çš„ç­”æ¡ˆçš„åŒæ—¶ï¼Œä¹Ÿèƒ½æœ‰æ•ˆå‡å°‘äº§ç”Ÿè¯¯å¯¼æ€§ä¿¡æ¯çš„å¯èƒ½ã€‚&lt;/p&gt;

&lt;p&gt;å¯ä»¥è¯´åœ¨ç›®å‰å¤§æ¨¡å‹äº•å–·çš„ä»Šå¤©ï¼ŒRAGä½œä¸ºä¸€é¡¹ä¸ºå¯†é›†å‹çŸ¥è¯†NLPä»»åŠ¡çš„å¤„ç†æŒ‡æ˜äº†æ–¹å‘ï¼Œé…åˆAIå¤§æ¨¡å‹ï¼Œè®©ä¸–ç•Œå‘ç”Ÿäº†ç¿»å¤©è¦†åœ°çš„å˜åŒ–ï¼Œæ•°ä»¥ä¸‡è®¡çš„å¼€å‘è€…éƒ½æ¶Œå…¥è¿™ä¸ªèµ›é“ï¼ŒåŒæ—¶ç«äº‰ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬çŸ¥é“LLMç›®å‰å­˜åœ¨çš„ä¸€äº›é—®é¢˜å’ŒæŒ‘æˆ˜ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;æˆ‘è‡ªå·±ç†è§£LLMå¤§æ¨¡å‹æœ¬è´¨å°±æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‰€æœ‰çš„çŸ¥è¯†éƒ½é€šè¿‡å‹ç¼©æŠ€æœ¯å…¨éƒ¨å‹ç¼©åœ¨ä¸€ä¸ª/å¤šä¸ªGBçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œæœ€ç»ˆåœ¨è·å–æ•°æ®çš„æ—¶å€™ï¼Œé€šè¿‡LLMçš„æ¨¡å‹æ¶æ„ï¼Œæ¨ç†èƒ½åŠ›ï¼Œå°†æ‰€æœ‰çš„çŸ¥è¯†ä¿¡æ¯åˆç”Ÿæˆå‡ºæ¥ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;åœ¨æ²¡æœ‰ç­”æ¡ˆçš„æƒ…å†µä¸‹æä¾›è™šå‡ä¿¡æ¯(èƒ¡è¯´å…«é“ã€å¹»è§‰)ã€‚&lt;/li&gt;
  &lt;li&gt;æ¨¡å‹çŸ¥è¯†çš„æ›´æ–°æˆæœ¬ã€å‘¨æœŸã€åŠå¤§æ¨¡å‹çš„é€šç”¨èƒ½åŠ›é—®é¢˜ï¼ˆå¤§å…¬å¸æ‰ç©çš„è½¬ï¼‰&lt;/li&gt;
  &lt;li&gt;æ•°æ®å®‰å…¨å’Œéšç§ç­‰é—®é¢˜&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è€ŒRAGæŠ€æœ¯çš„å‡ºç°ï¼Œæ­£å¥½èƒ½æœ‰æ•ˆçš„ç¼“è§£ç›®å‰å¤§æ¨¡å‹å­˜åœ¨çš„ä¸€äº›é—®é¢˜ï¼Œä¸»è¦è¡¨ç°æ–¹é¢å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ç»æµé«˜æ•ˆçš„å¤„ç†çŸ¥è¯†&amp;amp;å¼€ç®±å³ç”¨ï¼šåªéœ€è¦å€ŸåŠ©ä¿¡æ¯æ£€ç´¢&amp;amp;å‘é‡æŠ€æœ¯ï¼Œå°†ç”¨æˆ·çš„é—®é¢˜å’ŒçŸ¥è¯†åº“è¿›è¡Œç›¸å…³æ€§æœç´¢ç»“åˆï¼Œå°±èƒ½é«˜æ•ˆçš„æä¾›å¤§æ¨¡å‹ä¸çŸ¥é“çš„çŸ¥è¯†ï¼ŒåŒæ—¶å…·æœ‰&lt;strong&gt;æƒå¨æ€§&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;æœ‰æ•ˆé¿å…å¹»è§‰é—®é¢˜ï¼šè™½ç„¶æ— æ³•100%è§£å†³å¤§æ¨¡å‹çš„å¹»è§‰é—®é¢˜ï¼Œä½†é€šè¿‡RAGæŠ€æœ¯èƒ½å¤Ÿæœ‰æ•ˆçš„é™ä½å¹»è§‰ï¼Œåœ¨è½¯ä»¶ç³»ç»Ÿä¸­ç»“åˆå¤§æ¨¡å‹æä¾›å¹‚ç­‰çš„APIæ¥å£å°±å¯ä»¥å‘æŒ¥å¤§æ¨¡å‹çš„é‡å¤§ä½œç”¨&lt;/li&gt;
  &lt;li&gt;æ•°æ®å®‰å…¨ï¼šä¼ä¸šçš„æ•°æ®å¯ä»¥å¾—åˆ°æœ‰æ•ˆçš„ä¿æŠ¤,é€šè¿‡ç§æœ‰åŒ–éƒ¨ç½²åŸºäºRAGç³»ç»Ÿå¼€å‘çš„AIäº§å“ï¼Œèƒ½å¤Ÿåœ¨ä½“éªŒAIå¸¦æ¥çš„ä¾¿åˆ©æ€§çš„åŒæ—¶ï¼Œåˆèƒ½é¿å…ä¼ä¸šéšç§æ•°æ®çš„æ³„æ¼ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;3-ragæŠ€æœ¯æ¶æ„æ€è€ƒ&quot;&gt;3. RAGæŠ€æœ¯&amp;amp;æ¶æ„æ€è€ƒ&lt;/h1&gt;

&lt;p&gt;æ—¢ç„¶æˆ‘ä»¬çŸ¥é“ï¼ŒRAGä½œä¸ºå¯†é›†å‹çŸ¥è¯†åº“çš„å¤„ç†å’Œå¤§æ¨¡å‹é…åˆèµ·æ¥æœ‰ç€å¤©ç„¶ä¼˜åŠ¿ï¼Œé‚£ä¹ˆå¦‚ä½•åšå¥½RAGçš„å¼€å‘ï¼Ÿ&lt;/p&gt;

&lt;p&gt;RAGåº”ç”¨çš„&lt;strong&gt;åŸºç¡€æŠ€æœ¯æ ¸å¿ƒ&lt;/strong&gt;æ˜¯ï¼š&lt;strong&gt;è®©å¤§æ¨¡å‹ä¾é ç°æœ‰çš„æ•°æ®(PDF/WORD/Excel/HTMLç­‰ç­‰)ç²¾å‡†çš„å›ç­”ç”¨æˆ·çš„é—®é¢˜&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;è¿™æ˜¯æœ€åŸºç¡€çš„åŠŸèƒ½ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æœ€ä½è¦æ±‚ï¼Œä»»ä½•åšRAGé¢†åŸŸçš„AIåº”ç”¨äº§å“ï¼ŒæŠ€æœ¯å±‚é¢éƒ½éœ€è¦å»çªç ´è§£å†³çš„æŠ€æœ¯éš¾é¢˜ã€‚&lt;/p&gt;

&lt;p&gt;æ³¨æ„&lt;strong&gt;ä¸¤ä¸ªæ ¸å¿ƒ&lt;/strong&gt;ç‚¹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ğŸ“ &lt;strong&gt;ä¾èµ–ç°æœ‰çš„çŸ¥è¯†åº“&lt;/strong&gt;ï¼šä¾èµ–å®¢æˆ·æœ¬èº«çš„æ•°æ®æ˜¯ä¸ºäº†ç»™å¤§æ¨¡å‹æä¾›å¼ºæœ‰åŠ›çš„æ•°æ®æ”¯æ’‘,&lt;strong&gt;é¿å…å¤§æ¨¡å‹èƒ¡è¯´å…«é“&lt;/strong&gt;,ä¼ä¸šç§æœ‰çš„æ•°æ®å¤§æ¨¡å‹å¹¶æ²¡æœ‰å°†æ•°æ®çº³å…¥æ¨¡å‹è¿›è¡Œè®­ç»ƒ,æ‰€ä»¥å¤§æ¨¡å‹å¯¹äºä¼ä¸šç§æœ‰çš„æ•°æ®åŠç›¸å…³é—®é¢˜,å¤§æ¨¡å‹ä¸å¯èƒ½çŸ¥é“ï¼Œå³ä½¿å¤§æ¨¡å‹èƒ½å›ç­”ä½ è¿™ä¸ªé¢†åŸŸçš„é—®é¢˜ï¼Œé‚£ä¹Ÿæ˜¯å› ä¸ºä½ è¿™ä¸ªé—®é¢˜åœ¨å¤§æ¨¡å‹è®­ç»ƒçš„æ•°æ®é›†ä¸­æ—©å°±å­˜åœ¨äº†ï¼Œè€Œä¸”æ˜¯å…¬å¼€çš„æ•°æ®é›†å’Œé—®é¢˜ï¼Œè€Œ&lt;strong&gt;ä¼ä¸šç§æœ‰çš„æ•°æ®(è´¢åŠ¡æŠ¥å‘Šã€éšç§æ•°æ®ç­‰)å¤§æ¨¡å‹æ˜¯ä¸å¯èƒ½æ‹¥æœ‰çš„&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;ğŸ¹ &lt;strong&gt;ç²¾å‡†å‘½ä¸­å›ç­”&lt;/strong&gt;ï¼šä¸€æ—¦å®¢æˆ·å°†è‡ªå·±çš„ç§æœ‰æ•°æ®ä¸Šä¼ äº†ä¹‹å,æˆ‘ä»¬è¦åšçš„å°±æ˜¯ä¾é æ­¤æ•°æ®&lt;strong&gt;ç²¾å‡†å›ç­”ç”¨æˆ·çš„é—®é¢˜&lt;/strong&gt;ï¼Œè€Œè¦åšåˆ°ç²¾å‡†å›ç­”å‘½ä¸­,æŠ€æœ¯äººå‘˜éœ€è¦åšå¤šæ–¹é¢çš„åŠªåŠ›ğŸ’ªã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æŠ€æœ¯äººå¯¹äºRAGåº”ç”¨è€ƒè™‘çš„æœ€æ ¸å¿ƒçš„å°±æ˜¯è¿™ä¸¤ç‚¹ï¼Œè€ŒæŠ€æœ¯æµ‹ä¸ºäº†è¦å®ç°è¿™ä¸€ä¸ª&lt;strong&gt;ç›®æ ‡&lt;/strong&gt;ï¼Œå…¶è¦†ç›–çš„çŸ¥è¯†é¢ä»¥åŠæŠ€æœ¯éš¾åº¦éƒ½æ˜¯éå¸¸å¤§çš„ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘å¾ˆæ—©ä¹‹å‰å‚è€ƒå¤§æ¨¡å‹çš„æŠ€æœ¯æ¶æ„å‘å±•ï¼Œä¸ºRAGç”»äº†ä¸€å¼ ç±»ä¼¼çš„å›¾ï¼Œå¦‚ä¸‹ï¼š&lt;img src=&quot;/assets/images/rag/torchv/summary-01/image-20240330154925101.png&quot; alt=&quot;å›¾2-RAGå‘å±•æ¶æ„æ ‘&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è¿™é‡Œé¢æˆ‘ä¸ºåšRAGç³»ç»Ÿçš„æ€»ç»“ä¸ºä¸‰é¢—æ ‘ï¼ŒLLMå¤§æ¨¡å‹æ˜¯åœŸå£¤ï¼Œä¸»è¦ä¸ºï¼š&lt;strong&gt;æ•°æ®å·¥ç¨‹&lt;/strong&gt;ã€&lt;strong&gt;æ£€ç´¢ç”Ÿæˆ&lt;/strong&gt;ã€&lt;strong&gt;ä¸šåŠ¡ç³»ç»Ÿ&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;è¿™é‡Œé¢å¹¶æ²¡æœ‰æŠŠå¯¹æ¨¡å‹çš„å¾®è°ƒæ”¾å…¥è¿›æ¥ï¼Œå½“æˆ‘ä»¬æŠŠåŸºç¡€å·¥ç¨‹åšåˆ°80åˆ†åï¼Œä¹Ÿè®¸å¯¹Embeddingæ¨¡å‹ã€Chatæ¨¡å‹ç­‰å¾®è°ƒå·¥ä½œä¼šåŠ å…¥è¿›æ¥ï¼Œé’ˆå¯¹ç‰¹å®šçš„ä¸šåŠ¡åœºæ™¯åšä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;æ•°æ®å·¥ç¨‹:&lt;/strong&gt; çŸ¥è¯†åº“çš„å½¢å¼ä¸°å¯Œå¤šå½©,è¿™å…¶ä¸­é…åˆRAGæˆ‘ä»¬è¦åšçš„äº‹æƒ…éå¸¸å¤šï¼ŒåŒ…æ‹¬æ–‡ä»¶ç±»å‹ã€æ ¼å¼ã€åˆ†å‰²ç­–ç•¥ã€çŸ¥è¯†ç±»å‹ã€ç´¢å¼•æ–¹å¼ç­‰ç­‰&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ£€ç´¢ç”Ÿæˆ:&lt;/strong&gt;å½“æˆ‘ä»¬å¤„ç†å®Œæˆæ•°æ®åï¼Œé…åˆå¤§æ¨¡å‹éœ€è¦è¿›è¡Œæ£€ç´¢ç”Ÿæˆï¼Œè€Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒåŒ…æ‹¬ï¼šPromptå·¥ç¨‹ã€ç®—æ³•ç­–ç•¥ã€æ£€ç´¢æ–¹å¼ã€ä¸­é—´ä»¶ã€å¤§æ¨¡å‹ã€æŸ¥è¯¢å¤„ç†ç­‰å†…å®¹&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä¸šåŠ¡ç³»ç»Ÿ&lt;/strong&gt;: è¿™æ˜¯é…åˆå•†ä¸šè¡Œä¸ºæ‰€è¡ç”Ÿçš„ä¸šåŠ¡ç³»ç»Ÿ&amp;amp;ä¸Šå±‚äº§å“åº”ç”¨ï¼ŒåŒ…æ‹¬ç§Ÿæˆ·ã€è®¡è´¹ã€å¼€æ”¾å¹³å°ã€æ´å¯Ÿã€è¿è¥ç­‰ä¸šåŠ¡ç³»ç»Ÿï¼Œè¿™äº›ä¸šåŠ¡ç³»ç»Ÿåœ¨TorchV AIçš„äº§å“ä½“ç³»éƒ½ä¸€ä¸€ä½“ç°&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é€šè¿‡ä¸Šé¢çš„å›¾ï¼Œæˆ‘ä»¬å¤§æ¦‚å°±èƒ½çŸ¥é“ï¼Œ&lt;strong&gt;RAG+LLMå¤§æ¨¡å‹ç³»ç»Ÿçš„äº§å“å¼€å‘ï¼Œæ˜¯ä¸€ä¸ªç»¼åˆæ€§éå¸¸å¼ºçš„å·¥ä½œå†…å®¹ï¼Œè¿™å°±å’Œå¤§æ¨¡å‹çš„è®­ç»ƒä¸€æ ·ï¼Œæ•´ä¸ªå·¥ç¨‹åºå¤§ç¹æ‚ï¼Œæ˜¯ä¸€ä¸ªç³»ç»Ÿæ€§å·¥ç¨‹&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœæˆ‘ä»¬æŠŠä¸‰é¢—æ ‘ä¸­çš„æ¯ä¸€é¡¹éƒ½ä½œä¸ºä¸€ä¸ªæŠ€æœ¯å› å­ï¼Œä¸åŒçš„æ­¥éª¤å¤„ç†ä¼˜åŒ–ï¼Œéƒ½ä¼šå½±å“ç€æœ€ç»ˆå¤–éƒ¨çš„å•†ä¸šçš„å½±å“åŠ›ï¼Œè¿™å°±ä¼šäº§ç”Ÿé‡å˜åˆ°è´¨å˜çš„è½¬å˜ã€‚&lt;/p&gt;

&lt;p&gt;å‡è®¾ï¼š&lt;strong&gt;æˆ‘ä»¬æŠŠæ•°æ®å·¥ç¨‹å’Œæ£€ç´¢å·¥ç¨‹æ‰€æœ‰çš„æ­¥éª¤åœ¨æŠ€æœ¯å±‚é¢æå‡äº†10%ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨å’ŒåŒç±»ç«å“å»ç«äº‰æ—¶ï¼Œæˆ‘ä»¬çš„ä¼˜åŠ¿æ˜¯å¤šå¤§å‘¢ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;31-æ•°æ®å·¥ç¨‹&quot;&gt;3.1 æ•°æ®å·¥ç¨‹&lt;/h2&gt;

&lt;p&gt;åœ¨å¤§æ¨¡å‹åœˆå­é‡Œï¼Œç»å…¸åè¨€ï¼š&lt;strong&gt;Garbage in and garbage out&lt;/strong&gt;ï¼Œæ„æ€æ˜¾è€Œæ˜“è§ï¼Œä½ ç»™å¤§æ¨¡å‹é€çš„æ•°æ®è´¨é‡è¶Šé«˜ï¼Œé‚£ä¹ˆå¤§æ¨¡å‹çš„å“åº”å›ç­”æ•ˆæœå°±è¶Šå¥½ï¼Œåä¹‹ï¼Œå¦‚æœä½ ä¸¢åƒåœ¾ç»™å¤§æ¨¡å‹ï¼Œé‚£ä¹ˆå¤§æ¨¡å‹ä¹Ÿä¼šç»™ä½ è¿”å›åƒåœ¾ï½&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥ä»è¿™ç‚¹æ¥çœ‹ï¼Œä¸Šå±‚çš„åº”ç”¨å¼€å‘è€…ï¼Œè¦åšå¥½çŸ¥è¯†åº“ç±»å‹çš„äº§å“ï¼Œ&lt;strong&gt;æ•°æ®å·¥ç¨‹&lt;/strong&gt;ç»å¯¹æ˜¯ç¬¬ä¸€é“æ‹¦è·¯è™ï¼Œä»æ•°æ®é›†çš„ä¸åŒé¢†åŸŸè¿›è¡Œåˆ†ç±»,ç›®å‰å­˜åœ¨éå¸¸å¤šçš„æ•°æ®æ ¼å¼&lt;/p&gt;

&lt;p&gt;è¿™é‡Œé¢åŒ…å«çš„å¤šç§ä¸åŒçš„æŒ‘æˆ˜&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å¸¸è§æ–‡ä»¶è§£æ&lt;/strong&gt;ï¼šåŸºäºæ–‡ä»¶ç±»å‹çš„æ•°æ®é›†æ˜¯æœ€å¸¸è§çš„,ä¹Ÿæ˜¯ä½¿ç”¨æœ€å¹¿çš„,ä¾‹å¦‚(PDF/WORD/Excel/CSV/Html/Markdown)ç­‰æ ¼å¼&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å…³ç³»å‹/NoSQLæ•°æ®åº“&lt;/strong&gt;: ç”¨æˆ·çš„æ•°æ®å…¨éƒ¨å­˜å‚¨åœ¨æ•°æ®åº“ä¸­é—´ä»¶ä¸­ï¼Œä¾‹å¦‚MySQL/Postgresç­‰ï¼ŒNoSQLæ•°æ®åº“ä¸­ï¼Œè¿™ç§æ•°æ®æºçš„æå–åˆ°æ˜¯ä¸éš¾ï¼Œå¼€å‘è€…åªéœ€è¦æ ¹æ®ä¸åŒçš„æ•°æ®åº“æ ‡å‡†åè®®è¿›è¡Œå¯¹æ¥æŠ½å–å³å¯ï¼Œè¦åšçš„æ˜¯é€‚é…ä¸åŒçš„æ•°æ®åº“ç±»å‹&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç½‘ç»œæ•°æ®é›†&lt;/strong&gt;ï¼šå¯¹äºç½‘ç»œæ•°æ®é›†çš„å¤„ç†ï¼Œé‚£ä¹ˆå°±éœ€è¦å¼€å‘è€…ç²¾é€šçˆ¬è™«ä¹‹é“,è€Œç½‘ç»œä¸Šçš„æ•°æ®é›†ç§ç±»ä¹Ÿæ˜¯éå¸¸å¹¿çš„ï¼Œæ™®é€šçš„W3Cç½‘é¡µ(æ ¼å¼ç§ç±»å¤æ‚ç¹å¤š)ï¼Œè§†é¢‘ã€éŸ³é¢‘ç­‰ç­‰ä¿¡æ¯&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä¸åŒç±»å‹çš„æ•°æ®æå–ï¼š&lt;/strong&gt;åŒ…æ‹¬æ–‡æœ¬ã€å›¾ç‰‡ã€è¡¨æ ¼ã€è§†é¢‘ç­‰ï¼Œå•å•ä¸€ä¸ªè¡¨æ ¼æ•°æ®çš„åœ¨ä¸åŒçš„æ–‡ä»¶æ ¼å¼çš„å¤„ç†ï¼Œå°±éœ€è¦èŠ±è´¹å¤§é‡çš„ç²¾åŠ›å»ä¼˜åŒ–&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æå–æ–¹å¼çš„ç±»åˆ«&lt;/strong&gt;ï¼šä¼ ç»Ÿçš„è½¯ä»¶å·¥ç¨‹ã€OCRã€å¤§æ¨¡å‹ç­‰ç­‰&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åˆ†å‰²ç­–ç•¥&lt;/strong&gt;ï¼šåˆ†å‰²ç­–ç•¥åœ¨RAGçš„æŠ€æœ¯ä½“ç³»ä¸­æœ‰ç€ä¸¾è¶³è½»é‡çš„åœ°ä½,åˆ†å‰²çš„ä¸å¥½ï¼Œä¼šåœ¨ä¿¡æ¯æ£€ç´¢(IR)çš„è¿‡ç¨‹ä¸­ä¸¢å¤±è¯­ä¹‰ï¼ŒåŒ…æ‹¬ï¼šè¯­ä¹‰åˆ†å‰²ã€å¤§æ¨¡å‹åˆ†å‰²ã€æŒ‰å›ºå®šTokenåˆ†å‰²ã€æ–‡æ¡£ç»“æ„åˆ†å‰²ç­‰ç­‰&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Embeddingç´¢å¼•æ„å»ºï¼š&lt;/strong&gt;é™¤äº†ç»™æ¯ä¸€ä¸ªchunkå—æ„å»ºå‘é‡ç´¢å¼•ï¼Œå…ƒæ•°æ®ã€æ ‡é¢˜ã€æ¦‚è¦æ€»ç»“ç­‰ç­‰ä¹Ÿä¼šå¯¹ç³»ç»Ÿå‡†ä¸å‡†æœ‰ä¸åŒçš„è¦æ±‚ï¼ŒåŒæ—¶è¿˜è¦å’Œä¸Šå±‚çš„ä¸šåŠ¡è¿›è¡Œç»“åˆã€‚&lt;/li&gt;
  &lt;li&gt;Moreâ€¦&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨æ•°æ®å·¥ç¨‹è¿™æ£µæ ‘ä¸Šï¼Œæ‰€æœ‰çš„æŠ€æœ¯å‘å±•éƒ½ä¸æ˜¯åœæ»ä¸å‰çš„ï¼Œè¿™é‡Œä»…ä»…åªæ˜¯åˆ—äº†ä¸€äº›åŸºç¡€çš„æ ‘æï¼Œæˆ‘ç›¸ä¿¡åœ¨å¤§æ¨¡å‹AIäº•å–·çˆ†å‘çš„ä»Šå¤©ï¼Œä¼šæ›´å¿«æ¨è¿›æ•°æ®å·¥ç¨‹(ETL)çš„å‘å±•ã€‚&lt;/p&gt;

&lt;h2 id=&quot;32-æ£€ç´¢ç”Ÿæˆ&quot;&gt;3.2 æ£€ç´¢ç”Ÿæˆ&lt;/h2&gt;

&lt;p&gt;å½“æˆ‘ä»¬æŠŠæ‰€æœ‰çš„çŸ¥è¯†æ•°æ®å¤„ç†å®Œæ¯•ï¼Œå€ŸåŠ©å¤§æ¨¡å‹æ¥æ„å»ºä¸€ä¸ªChatç³»ç»Ÿæ—¶ï¼Œä¿¡æ¯æ£€ç´¢æŠ€æœ¯åˆ™æ˜¯å¿…ç„¶è¦ç”¨åˆ°çš„&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ä»è¿™é‡Œæˆ‘ä»¬å¥½åƒå‘ç°ï¼ŒåšRAGï¼Œæ— éå°±æ˜¯åšæœç´¢?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;åœ¨ç›®å‰çš„RAGæ£€ç´¢çš„æŠ€æœ¯ä½“ç³»ä¸­ï¼Œæœ€æ™®éçš„æ— éä¸¤ç§ï¼šå…³é”®è¯å’Œå‘é‡è¯­ä¹‰æ£€ç´¢&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å…³é”®è¯æ£€ç´¢ï¼šåŸºäºç±»ä¼¼BM25è¿™ç±»è¯é¢‘å€’æ’æŠ€æœ¯ï¼Œé€šè¿‡ç»Ÿè®¡å…³é”®è¯çš„æ–¹å¼æ¥æ‰§è¡Œæœç´¢ï¼Œç¼ºç‚¹æ˜¯æ— è¯­ä¹‰ä¿¡æ¯&lt;/li&gt;
  &lt;li&gt;å‘é‡è¯­ä¹‰æ£€ç´¢ï¼šé€šè¿‡å°†æ‰€æœ‰çŸ¥è¯†ç‰‡æ®µé€šè¿‡BERTç­‰é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹è¿›è¡Œè¡¨å¾æå–ï¼Œè¡¨ç¤ºä¸ºå¤šç»´çš„å‘é‡æ•°æ®ï¼Œé€šè¿‡KNN/ANNç®—æ³•æœç´¢è·å–ç»“æœã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å½“ç„¶ï¼Œåœ¨ç›®å‰çš„å¾ˆå¤šå‘é‡æ•°æ®åº“ä¸­é—´ä»¶ä¸­ï¼Œè¿™ä¸¤ç±»æ£€ç´¢å¼•æ“éƒ½å¾—åˆ°äº†æ”¯æŒï¼Œæˆ–è€…æ˜¯æ··åˆæ£€ç´¢ä¹Ÿæ˜¯ä¸€ç§é‡è¦çš„æŠ€æœ¯æ‰‹æ®µã€‚&lt;/p&gt;

&lt;p&gt;åœ¨æ•´ä¸ªæ£€ç´¢ç”Ÿæˆçš„è¿‡ç¨‹ä¸­ï¼Œè¿™æ£µæ ‘åŒæ ·å…³æ³¨çš„æŠ€æœ¯ç»†èŠ‚ä¹Ÿéå¸¸çš„å¤šï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Promptå·¥ç¨‹&lt;/strong&gt;ï¼šå’Œå¤§æ¨¡å‹å¯¹è¯ï¼ŒæŠ€æœ¯äººå‘˜å¿…é¡»æŒæ¡çš„Promptå·¥ç¨‹ï¼Œé€šè¿‡FewShotã€CoTã€ZeroShotç­‰æŠ€æœ¯ï¼Œé’ˆå¯¹ä¸åŒçš„ä¸šåŠ¡åœºæ™¯èƒ½å‘æŒ¥é‡å¤§çš„ä½œç”¨ï¼Œå¼€å‘äººå‘˜éœ€è¦æ ¹æ®å…·ä½“çš„ä¸šåŠ¡åœºæ™¯æ¥è°ƒè¯•ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å’Œå¤§æ¨¡å‹å¯¹æ¥ï¼Œ&lt;strong&gt;è§£å†³å¹‚ç­‰æ€§&lt;/strong&gt;çš„é‡è¦æ‰‹æ®µ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;LLMå¤§æ¨¡å‹&lt;/strong&gt;ï¼šglm3/4ã€ç™¾å·ã€åƒé—®ã€æœˆä¹‹æš—é¢ã€gpt3.5ã€gpt4ç­‰ç­‰å¤§æ¨¡å‹ï¼Œåœ¨ä¸åŒçš„åœºæ™¯ã€èƒ½åŠ›å„æœ‰ä¾§é‡ï¼Œè¿›è¡Œæ·±åº¦çš„ä¸šåŠ¡è°ƒè¯•/é€‚é…åŒæ ·é‡è¦ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ£€ç´¢å¬å›è¿‡ç¨‹å¤„ç†&lt;/strong&gt;ï¼šå¤šè½®å¯¹è¯ã€æŸ¥è¯¢é‡å†™ã€å¤šè·³ã€å¤šè·¯å¬å›ã€å­æŸ¥è¯¢ç­‰ç­‰ï¼Œä¼´éšä¸šåŠ¡åœºæ™¯çš„æ·±å…¥ï¼Œæ¯ä¸€ä¸ªChainçš„ç¯èŠ‚ä¿è¯ç¨³å®šå¯é ï¼Œä¸æ˜¯è½»æ¾çš„äº‹&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä¸­é—´ä»¶&lt;/strong&gt;ï¼šç³»ç»Ÿç¨³å®šé«˜å¯ç”¨ã€å¯æ‰©å±•ç¦»ä¸å¼€ä¸­é—´ä»¶çš„æ”¯æŒï¼Œå¦‚ç¼“å­˜ã€æ¶ˆæ¯é˜Ÿåˆ—ã€å‘é‡æ•°æ®åº“ã€å›¾æ•°æ®åº“ç­‰ç­‰éƒ½æ˜¯å¿…ä¸å¯å°‘çš„&lt;/li&gt;
  &lt;li&gt;More:â€¦.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨æ£€ç´¢ç”Ÿæˆçš„è¿™æ£µæ ‘ä¸Šï¼Œå’Œæ•°æ®å·¥ç¨‹å¯†åˆ‡é…åˆä¸å¯åˆ†å‰²ï¼Œéƒ½æ˜¯åœ¨é™ä½å¤§æ¨¡å‹å¹»è§‰çš„é“è·¯ä¸Šæ·±æŒ–æŠ€æœ¯ç»†èŠ‚ã€‚&lt;/p&gt;

&lt;h1 id=&quot;4-æŠ€æœ¯äº§å“é¢†å¯¼é©±åŠ¨å•†ä¸šçš„å‘å±•&quot;&gt;4. æŠ€æœ¯&amp;amp;äº§å“é¢†å¯¼é©±åŠ¨å•†ä¸šçš„å‘å±•&lt;/h1&gt;

&lt;p&gt;åšRAGè¿™ç±»AIåº”ç”¨å¼€å‘ä»¥æ¥ï¼Œæ„Ÿå—æœ€æ·±çš„æ˜¯å’Œä¹‹å‰åšäº§å“/é¡¹ç›®å¹¶ä¸ç›¸åŒï¼Œä¸€æ–¹é¢æ˜¯æŠ€æœ¯æ ˆå‘å±•è¾ƒæ–°ï¼Œæ–°æŠ€æœ¯å¸¦æ¥çš„æŠ€æœ¯å˜é©å­˜åœ¨éå¸¸å¤§çš„æŒ‘æˆ˜ï¼Œæœ‰äº†å¤§æ¨¡å‹ä¹‹åï¼Œéœ€æ±‚&amp;amp;æƒ³æ³•ä¹Ÿæ˜¯äº”èŠ±å…«é—¨ï¼Œå¦å¤–ï¼Œç›®å‰çš„AIåº”ç”¨ï¼Œæˆ‘è§‰å¾—æ›´å¤šçš„æ˜¯&lt;strong&gt;æŠ€æœ¯&amp;amp;äº§å“æ¥é¢†å¯¼é©±åŠ¨å•†ä¸šçš„å‘å±•&lt;/strong&gt;ï¼Œè¿™å’Œæ™®é€šè½¯ä»¶ä¼ä¸šçš„å¼€å‘æµç¨‹æˆ–è®¸æœ‰æ‰€ä¸åŒã€‚&lt;/p&gt;

&lt;p&gt;è¿™é‡Œæˆ‘è§‰å¾—å‡ ç‚¹éå¸¸é‡è¦ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ–°AIæŠ€æœ¯çš„è¿…é€Ÿå‘å±•å¿…ç„¶é©æ–°ä¹‹å‰çš„è½¯ä»¶æµç¨‹å’Œå¼€å‘è¿‡ç¨‹ï¼Œåœ¨æ€æƒ³å±‚é¢æ˜¯å¿…é¡»è½¬å˜ã€‚&lt;/li&gt;
  &lt;li&gt;å¤§æ¨¡å‹å¹»è§‰å¾ˆä¸¥é‡ï¼Œé€šè¿‡RAGæŠ€æœ¯è§£å†³å¹»è§‰&lt;strong&gt;åš60åˆ†å¾ˆå®¹æ˜“&lt;/strong&gt;ï¼Œä½†æ˜¯æŠŠåº•å±‚çš„èƒ½åŠ›æå‡åˆ°80åˆ†ç”šè‡³90åˆ†ï¼Œæ˜¯éå¸¸éš¾çš„äº‹æƒ…ï¼Œè¿™éœ€è¦ä¸€ä¸ªé•¿æœŸç´¯ç§¯è¿­ä»£çš„è¿‡ç¨‹ã€‚&lt;/li&gt;
  &lt;li&gt;ä¼ä¸šå®¢æˆ·ä¸ä¼šä¸ºäº†ä¸€ä¸ªåªæœ‰60-70åˆ†çš„æŠ€æœ¯äº§å“ä¹°å•ä»˜è´¹ï¼Œå¯¹å¾…è½¯ä»¶ç¼–ç ã€æŠ€æœ¯æ¶æ„ã€äº§å“äº¤äº’ç­‰æ–¹é¢ï¼Œäº§ç ”äººå‘˜éœ€è¦å¯¹è‡ªå·±è¦æ±‚æ›´é«˜ï¼Œè¿½æ±‚å®Œç¾&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æˆ‘ä»¬å›¢é˜Ÿå†…éƒ¨ç»è¿‡è¿™æ®µæ—¶é—´çš„è¿­ä»£ï¼Œä¹Ÿç¢°äº†å¾ˆå¤šå®¢æˆ·çš„éœ€æ±‚ï¼Œå›¢é˜Ÿçš„æ–¹å‘ä¹Ÿæ˜¯åœ¨å‘å±•ä¸­ä¸æ–­çš„è¿›è¡Œè°ƒæ•´ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬åœ¨æˆç«‹TorchV AIæ—¶ï¼Œæ•´ä½“æ¶æ„å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/summary-01/torchv.png&quot; alt=&quot;å›¾3-TorchVæ¶æ„&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬ä»¥RAGæŠ€æœ¯ä¸ºæ ¸å¿ƒï¼Œåœ¨ä¸Šå±‚åšæˆ‘ä»¬çš„ä¸­é—´ä»¶å±‚ï¼Œè¿™é‡Œé¢æœ€æ ¸å¿ƒçš„ä¸‰ä¸ªï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ä¸»è¦æ ¸å¿ƒé—®é¢˜èšç„¦åœ¨é™ä½å¤§æ¨¡å‹å¹»è§‰ã€ä¸åŒæ•°æ®æºè¿æ¥ä¸Šé¢&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;TorchV IC(å¹‚ç­‰åˆ†ç±»å™¨)&lt;/strong&gt;:è®©æ—¢å®šçš„äº‹å®æ•°æ®å‘æŒ¥æ›´å¤§æ¯”é‡ï¼Œå¼•å…¥å°½å¯èƒ½å¤šçš„å¹‚ç­‰ï¼Œå¯¹æŠ—å’Œé™ä½LLMçš„å¹»è§‰;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;TorchV Actuator(æ‰§è¡Œå™¨)&lt;/strong&gt;:ä¼˜åŒ–TorchVç‰¹æœ‰é£æ ¼çš„è¾“å‡ºæ ¼å¼ï¼ŒåŒ…æ‹¬äº¤äº’ç•Œé¢çš„ç»„è£…ï¼Œå¯¹åº”ç”¨æ›´å‹å¥½;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;TorchV Connector(è¿æ¥å™¨)&lt;/strong&gt;:è¿æ¥æœ¬åœ°æ•°æ®ï¼Œæœ‰åºè§£å†³æœ¬åœ°åŒ–åœºæ™¯ä¸‹æ•°æ®å¤šæ ·æ€§å’Œå¤æ‚æ€§é—®é¢˜.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é€šè¿‡RAGæŠ€æœ¯+ä¸­é—´ä»¶çš„æ–¹å¼ï¼Œå¼€å‘å‡ºäº†æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªäº§å“åŸºçº¿TorchV Botã€‚é€šè¿‡æŒç»­çš„äº§å“è¿­ä»£å’Œä¸åŒå®¢æˆ·éœ€æ±‚ç¢°æ’ï¼Œæˆ‘ä»¬çš„TorchV BotåŸºçº¿äº§å“çš„æ¶æ„ä¹Ÿåˆæ­¥æˆå‹ã€‚å¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://www.luxiangdong.com/images/torchv_website/products_ai_apps.png&quot; alt=&quot;å›¾4-TorchV.AIåº”ç”¨æ¶æ„&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸»è¦ç»„ä»¶æ‹†åˆ†å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;RAGå’ŒAgent&lt;/strong&gt;ï¼šRAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰å’ŒAgentæ˜¯ç›®å‰å¤§è¯­è¨€æ¨¡å‹è½åœ°åˆ°ä¼ä¸šåº”ç”¨çš„äº‹å®æ ‡å‡†ï¼Œä¹Ÿæ˜¯TorchV AIçš„æ ¸å¿ƒä¸­é—´ä»¶ä¹‹ä¸€ï¼›&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Tenant&lt;/strong&gt;ï¼šç§Ÿæˆ·ç³»ç»Ÿï¼Œè¿™æ˜¯æˆ‘ä»¬æ”¯èµ·å¤šç§Ÿæˆ·PaaS/SaaSå¹³å°çš„åŸºç¡€ï¼›&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;OSS&lt;/strong&gt;ï¼šåœ¨çº¿æ–‡ä»¶å­˜å‚¨ï¼ŒåŒ…æ‹¬å®¢æˆ·ä¸Šä¼ çš„æ–‡ä»¶ï¼Œä»¥åŠä»URLä¸­å¯¼å…¥çš„æ•°æ®ç­‰ï¼›&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ChatBot&lt;/strong&gt;ï¼šTorchV AIä¼šæä¾›ä¸€ä¸ªé»˜è®¤çš„Webç‰ˆé—®ç­”ç³»ç»Ÿï¼Œå®¢æˆ·å¯ä»¥åœ¨ä¸Šé¢å¯¹çŸ¥è¯†è¿›è¡Œæµ‹è¯•ï¼Œå¯¹äºå†…éƒ¨ä½¿ç”¨åœºæ™¯ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼›&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ•°æ®&amp;amp;æ´å¯Ÿåˆ†æ&lt;/strong&gt;ï¼šå¯¹æ•°æ®è¿›è¡Œåˆ†æï¼ŒåŒ…æ‹¬å®¢æˆ·é¢„å…ˆè®¾å®šçš„ä¸€äº›æ´å¯Ÿæ¡ä»¶ï¼Œä¸€æ—¦è§¦å‘æ¡ä»¶ï¼Œå°±ä¼šè¿›è¡ŒæŒ‡å®šåŠ¨ä½œï¼Œå¦‚äº§å“å’ŒæœåŠ¡çš„æ¨èï¼Œå’¨è¯¢åˆ†æµç­‰ã€‚å®¢æˆ·åœ¨è¿™é‡Œä¹Ÿå¯ä»¥å¯¹æ•°æ®è¿›è¡ŒåŒæ­¥ï¼Œå¯¼å…¥åˆ°è‡ªå·±çš„ç³»ç»Ÿï¼Œä½œä¸ºæ•°æ®åˆ†æçš„æ•°æ®åŸºç¡€ï¼›&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;çŸ¥è¯†åº“ç®¡ç†&lt;/strong&gt;ï¼šåˆ›å»ºçŸ¥è¯†åº“ï¼Œä¸ºæ¯ä¸ªçŸ¥è¯†åº“ä¸Šä¼ å’Œå¯¼å…¥æ–‡ä»¶ï¼Œä¸€æ—¦ä¸Šä¼ ï¼Œæ–‡ä»¶ç«‹å³è¢«ç³»ç»Ÿå¤„ç†ï¼Œå˜æˆchunkï¼ˆå°å—æ–‡æœ¬ï¼‰å’Œembeddingä¹‹åçš„å‘é‡æ•°æ®ç­‰ï¼›&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;è¿è¥åå°&lt;/strong&gt;ï¼šåŒ…æ‹¬è®¡è´¹ç³»ç»Ÿã€å„ç±»å‚æ•°é…ç½®ã€å¯¹è¯è®°å½•æŸ¥çœ‹å’Œæ ‡æ³¨ã€ç”¨æˆ·æƒé™è®¾ç½®å’Œåé¦ˆå¤„ç†ç­‰åŠŸèƒ½ï¼›&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åº”ç”¨ä¸­å¿ƒ&lt;/strong&gt;ï¼šä¸€ä¸ªå®¢æˆ·å³å¯åˆ›å»ºå¤šä¸ªåº”ç”¨ï¼Œç„¶åé€šè¿‡APIå¯¹æ¥è‡ªå·±çš„åŸæœ‰ç³»ç»Ÿï¼Œæˆ–è€…æ ¹æ®APIåˆ›å»ºæ–°åº”ç”¨ã€‚é™¤äº†APIä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜æä¾›ä¸€é”®åµŒå…¥çš„å¯¹æ¥æ–¹å¼ï¼Œåªéœ€å¼•å…¥å‡ è¡Œjsä»£ç ï¼Œå³å¯åœ¨å®¢æˆ·çš„Webåº”ç”¨ä¸Šå¼€å¯æ‚¬æµ®iconï¼Œæä¾›TorchV AIçš„å¯¹è¯èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä»¥ä¸Šåˆ™æ˜¯ç›®å‰TorchVçš„äº§å“é›å½¢ï¼Œæ›´å¤šç»†èŠ‚å¯ä»¥è®¿é—®&lt;a href=&quot;https://www.torchv.com&quot;&gt;å®˜ç½‘:https://www.torchv.com&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;5-æ¶æ„ç¼–ç¨‹è¯­è¨€çš„é€‰æ‹©&quot;&gt;5. æ¶æ„&amp;amp;ç¼–ç¨‹è¯­è¨€çš„é€‰æ‹©&lt;/h1&gt;

&lt;p&gt;éšç€å¤§æ¨¡å‹LLMçš„çˆ†ç«ï¼ŒåŒ…æ‹¬&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LangChain&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LlamaIndex&lt;/code&gt;ç­‰ä»¥LLMä¸ºåŸºç¡€çš„æ•°æ®Pythonæ¡†æ¶çš„å‡ºç°ï¼Œå¾ˆå¤šå¼€å‘è€…åœ¨é€‰æ‹©å¼€å‘RAGç³»ç»Ÿåº”ç”¨æ—¶ï¼Œä¼šå¯èƒ½æ— æ³•ç€æ‰‹ã€‚&lt;/p&gt;

&lt;p&gt;èµ·åˆåœ¨å¼€å‘RAGåº”ç”¨çš„æ—¶å€™ï¼Œä¹Ÿçº ç»“è¿‡ç¼–ç¨‹è¯­è¨€çš„é€‰æ‹©ï¼Œåœ¨è¿™æœŸé—´èµ°äº†å¾ˆå¤šçš„å¼¯è·¯ï¼Œä¹Ÿå¾—åˆ°äº†ä¸€äº›æ•™è®­ã€‚&lt;/p&gt;

&lt;p&gt;å…ˆè¯´ç»“è®ºï¼ŒTorchV.AIçš„äº§å“é€‰Java+Pythonä½œä¸ºæœåŠ¡ç«¯çš„å¼€å‘è¯­è¨€ã€‚&lt;/p&gt;

&lt;p&gt;è¿™é‡Œé¢æœ‰ä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å‘˜å¤–å’Œæˆ‘éƒ½æ˜¯å¤šå¹´çš„Javaè¯­è¨€å¼€å‘å‡ºç”Ÿï¼Œä»ç¼–ç ã€ç”Ÿæ€ç­‰æ–¹é¢çš„äº†è§£ç¨‹åº¦ï¼Œé‚£è‡ªç„¶æ˜¯ä¸å¯èƒ½æŠ›å¼ƒJava&lt;/li&gt;
  &lt;li&gt;Pythonè¯­è¨€æ˜¯æ— å¯é¿å…çš„ï¼Œä½†æ˜¯åœ¨æ•´ä¸ªå·¥ç¨‹é‡Œé¢ï¼ŒèŒè´£æ˜¯æœ‰åˆ†å·¥çš„ï¼Œ&lt;strong&gt;æ— çŠ¶æ€&lt;/strong&gt;çš„ä¸€äº›é€»è¾‘æ“ä½œéƒ½é€šè¿‡Pythonæ¥å®ç°&lt;/li&gt;
  &lt;li&gt;ä¼ä¸šçº§å¼€å‘è¯­è¨€ä»¥åŠæŠ€æœ¯ç»„ä»¶ç”Ÿæ€&lt;/li&gt;
  &lt;li&gt;ä¸­é—´ä»¶ä¸°å¯Œç¨‹åº¦ã€å¼€å‘ç¤¾åŒºçš„å¥åº·å‘å±•&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä¸‹å›¾æ˜¯æˆ‘ç”»çš„ä¸€ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Java&lt;/code&gt; VS &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Python&lt;/code&gt;è¿™ä¸¤ä¸ªç¼–ç¨‹è¯­è¨€åœ¨ä¸åŒé¢†åŸŸçš„ä¸€äº›ç‰¹æ€§å¯¹æ¯”ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/summary-01/language.png&quot; alt=&quot;å›¾5-ç¼–ç¨‹è¯­è¨€é€‰æ‹©&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ç›®å‰å¸‚é¢ä¸Šå¼€å‘RAGå¤§æ¨¡å‹åº”ç”¨æœ€ç«çš„å½“å±&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LangChain&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LlamaIndex&lt;/code&gt;è¿™ä¸¤ä¸ªæ¡†æ¶ï¼Œéƒ½æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Python&lt;/code&gt;è¯­è¨€è¿›è¡Œå¼€å‘ï¼Œæä¾›äº†å¼€ç®±å³ç”¨çš„åŠŸèƒ½ï¼Œå¯èƒ½åœ¨&lt;strong&gt;ä¸è¶…è¿‡10è¡Œä»£ç &lt;/strong&gt;çš„æƒ…å†µä¸‹ï¼Œå°±èƒ½è½»æ¾å®Œæˆä¸€ä¸ªRAGå¤§æ¨¡å‹åº”ç”¨çš„demoã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬èµ·åˆä¹Ÿæ˜¯åœ¨çº ç»“åœ¨è¿™æœŸé—´å¦‚ä½•æ›´å¥½çš„åšå–èˆï¼Œåæ¥å›¢é˜Ÿå†…éƒ¨ç»è¿‡è®¨è®ºï¼Œè¿˜æ˜¯å°†éƒ¨åˆ†çš„ä¸šåŠ¡é€»è¾‘æ”¾åœ¨Javaè¯­è¨€ä¸­ï¼Œé‡å†™RAGè¿‡ç¨‹ä¸­çš„ä¸€äº›æ ¸å¿ƒé€»è¾‘å’Œç»„ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;è¿™é‡Œé¢çš„æ€è€ƒï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;RAGæ¶æ„æ¶‰åŠåˆ°çš„ä¸œè¥¿å¤šä¸”æ‚ï¼Œå¼€ç®±å³ç”¨çš„LLMæ•°æ®å¤„ç†æ¡†æ¶å¯èƒ½æ— æ³•æ»¡è¶³ä¼ä¸šçš„ä¸šåŠ¡è¯‰æ±‚(éœ€æ±‚å˜åŒ–å¤šç«¯)&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;RAGç›®å‰å¹¶æ²¡æœ‰å‘å±•æˆä¸ºHTTPè§„èŒƒä¸€æ ·çš„åè®®çº¦å®šï¼Œæ‰€ä»¥ä¸åŒçš„RAGè¿‡ç¨‹ã€LLMæ¨¡å‹ç­‰éƒ½ä¼šå¯¼è‡´RAGçš„æ•ˆæœå·®å¼‚&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å›½å†…LLMç™¾èŠ±é½æ”¾ï¼Œæ— æ³•å¼€ç®±å³ç”¨ï¼Œå›½å†…çš„ä¸åŒéœ€æ±‚ä¹Ÿéœ€è¦æ»¡è¶³(æœ¬åœ°åŒ–é€‚é…)&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç»“åˆåœ¨å¼€å‘RAGåº”ç”¨ä¸­æ¶‰åŠåˆ°çš„æ•°æ®å·¥ç¨‹ç­‰éƒ¨åˆ†é€»è¾‘ï¼Œæˆ‘ä»¬ç»“åˆä¸¤å¤§è¯­è¨€çš„ç‰¹æ€§ï¼Œä¹Ÿèƒ½å¾ˆè½»æ¾çš„å‹¾ç”»å‡ºä¸€å¼ ä¾¿è¯­è¨€çº§åˆ«çš„æ¶æ„å›¾ï¼Œæ¶µç›–äº†åœ¨ä¼ä¸šå¼€å‘ã€ä¸šåŠ¡åœºæ™¯è½åœ°æ—¶ï¼Œå¦‚ä½•å¿«é€Ÿçš„é€‚é…ä¸Šå±‚åº”ç”¨çš„éœ€æ±‚ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/summary-01/rag_languages.png&quot; alt=&quot;å›¾6-åŸºäºè¯­è¨€èƒ½åŠ›çº§åˆ«çš„RAGæ¶æ„ç¤ºæ„å›¾&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨è¿™ç§å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ™°çš„çœ‹åˆ°ï¼Œä¸åŒçš„ä»»åŠ¡&amp;amp;éœ€æ±‚ï¼ŒèŒè´£åˆ†å·¥æ˜¯æ¯”è¾ƒæ˜ç¡®çš„ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Javaï¼šä½¿ç”¨Javaç”Ÿæ€æ—¶ï¼Œé’ˆå¯¹ä¸šåŠ¡ç³»ç»Ÿçš„æ•°æ®ä¸€è‡´æ€§ï¼Œåˆ†å¸ƒå¼ã€é‰´æƒã€é™æµç­‰ä¼ä¸šåº”ç”¨æ¥å£çš„ç‰¹æ€§å¼€å‘ï¼Œç›®å‰éƒ½æœ‰éå¸¸æˆç†Ÿçš„è§£å†³æ–¹æ¡ˆ&lt;/li&gt;
  &lt;li&gt;Pythonï¼šæ¶‰åŠåˆ°æ— çŠ¶æ€çš„æœåŠ¡æ—¶ï¼Œæ”¯æ’‘ä¸Šå±‚åº”ç”¨çš„å¤„ç†ï¼ŒåŒ…æ‹¬æ•°æ®å·¥ç¨‹ã€Chatæ¨¡å‹ã€æ•°æ®å¤„ç†ã€å¾®è°ƒç­‰ç³»ç»Ÿå·¥ç¨‹ï¼Œé‚£ä¹ˆç”¨Pythonæ˜¯æ¯«æ— ç–‘é—®&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨è¿™é‡Œï¼Œå½“æˆ‘ä»¬ä½¿ç”¨åº”ç”¨å¼€å‘æ—¶ï¼ŒæŒ‘é€‰ç¼–ç¨‹è¯­è¨€æ¥å¼€å‘åº”ç”¨æœåŠ¡ï¼Œä¼˜å…ˆè€ƒè™‘çš„æ˜¯ç”Ÿæ€å’Œç¨³å®šæ€§ã€‚&lt;/p&gt;

&lt;p&gt;å½“ç„¶ï¼Œè¿™é‡Œé¢å¹¶æ²¡æœ‰å”¯ä¸€çš„æ ‡å‡†ï¼Œæ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µå‡ºå‘æ¥é€‰æ‹©æ˜¯æœ€ä¼˜çš„ï¼Œä»¥ä¸Šä»…ä»…åªæ˜¯åˆ†äº«ä¸€ä¸‹æˆ‘çš„çœ‹æ³•ã€‚&lt;/p&gt;

&lt;h1 id=&quot;6-æ€»ç»“&quot;&gt;6. æ€»ç»“&lt;/h1&gt;

&lt;p&gt;å¥½äº†ï¼Œå…¨æ–‡å®Œï¼Œåšä¸€ä¸ªæ€»ç»“ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;RAGã€LLMç­‰AIäº§å“çš„å¼€å‘æ˜¯æ—¥æ–°æœˆå¼‚çš„ï¼ŒæŠ€æœ¯æ ˆä½“ç³»ä¼šé£é€Ÿå‘å±•,å¯¹äºå…¬å¸è€Œè¨€ï¼Œå°æ­¥å¿«è·‘ï¼Œå¿«é€Ÿè¯•é”™å¯èƒ½æ˜¯éå¸¸é‡è¦çš„&lt;/li&gt;
  &lt;li&gt;åº”ç”¨åœºæ™¯ç›®å‰ä»…ä»…åªæ˜¯èšç„¦åœ¨çŸ¥è¯†å¯†é›†å‹ä»»åŠ¡ï¼Œæœªæ¥éšç€æŠ€æœ¯çš„å‘å±•ï¼Œä¼šæ‰©å±•åˆ°æ›´å¤šçš„è¡Œä¸šä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;TorchV.AIç›®å‰æ˜¯åˆšèµ·æ­¥é˜¶æ®µï¼Œä¹Ÿæ¬¢è¿æ›´å¤šçš„ä¼ä¸šå®¢æˆ·è¯•ç”¨ï¼Œåˆä½œï¼ï¼ï¼&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;å¦‚æœæ‚¨æœ‰å•†åŠ¡åˆä½œéœ€æ±‚ï¼š&lt;/p&gt;

  &lt;p&gt;è¯·æ‰«ç æ·»åŠ ä»¥ä¸‹å¾®ä¿¡ï¼ˆå‘˜å¤–ğŸ”¥TorchVï¼‰ï¼Œå¹¶è¯·æ‚¨å‘ŠçŸ¥æ‚¨çš„ç§°å‘¼ å’Œ ä¼ä¸šåç§° ã€‚
&lt;img src=&quot;https://www.torchv.com/img/consociation/yuanwai.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;æˆ‘ä»¬çš„å®˜ç½‘åœ°å€ï¼š&lt;a href=&quot;https://www.torchv.com&quot;&gt;https://www.torchv.com&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;7-references&quot;&gt;7. References&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.torchv.com&quot;&gt;https://www.torchv.com&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.luxiangdong.com&quot;&gt;https://www.luxiangdong.com&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://arxiv.org/abs/2005.11401&quot;&gt;https://arxiv.org/abs/2005.11401&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="å¤§æ¨¡å‹" /><category term="RAGå®è·µ" /><category term="TorchV" /><category term="RAGæ¦‚è¿°" /><category term="RAG" /><category term="å¤§æ¨¡å‹" /><category term="LLM" /><summary type="html">1. å‰è¨€</summary></entry><entry><title type="html">TorchVçš„RAGå®è·µåˆ†äº«(ä¸‰):è§£ællama_indexçš„æ•°æ®å­˜å‚¨ç»“æ„å’Œå¬å›ç­–ç•¥è¿‡ç¨‹</title><link href="http://localhost:4000/2024/01/14/torchv-rag-3/" rel="alternate" type="text/html" title="TorchVçš„RAGå®è·µåˆ†äº«(ä¸‰):è§£ællama_indexçš„æ•°æ®å­˜å‚¨ç»“æ„å’Œå¬å›ç­–ç•¥è¿‡ç¨‹" /><published>2024-01-14T00:00:00+08:00</published><updated>2024-01-14T00:00:00+08:00</updated><id>http://localhost:4000/2024/01/14/torchv-rag-3</id><content type="html" xml:base="http://localhost:4000/2024/01/14/torchv-rag-3/">&lt;h1 id=&quot;1å‰è¨€&quot;&gt;1.å‰è¨€&lt;/h1&gt;

&lt;p&gt;LlamaIndexæ˜¯ä¸€ä¸ªåŸºäºLLMçš„æ•°æ®å¤„ç†æ¡†æ¶ï¼Œåœ¨RAGé¢†åŸŸéå¸¸æµè¡Œï¼Œç®€å•çš„å‡ è¡Œä»£ç å°±èƒ½å®ç°æœ¬åœ°çš„æ–‡ä»¶çš„å¯¹è¯åŠŸèƒ½ï¼Œå¯¹å¼€å‘è€…æä¾›äº†æè‡´çš„å°è£…ï¼Œå¼€ç®±å³ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;æœ¬æ–‡ä»¥å®˜æ–¹æä¾›çš„æœ€ç®€å•çš„ä»£ç†ç¤ºä¾‹ä¸ºä¾‹ï¼Œåˆ†æLlamaIndexåœ¨æ•°æ®è§£æã€å‘é‡Embeddingã€æ•°æ®å­˜å‚¨åŠå¬å›çš„æ•´ä¸ªæºç è¿‡ç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;é€šè¿‡å­¦ä¹ æ¡†æ¶çš„æºç ä¹Ÿèƒ½è®©å¼€å‘è€…ä»¬åœ¨å®é™…çš„ä¼ä¸šå¤§æ¨¡å‹åº”ç”¨å¼€å‘ä¸­ï¼Œå¯¹RAGæœ‰ä¸€ä¸ªæ›´æ¸…æ™°çš„äº†è§£å’Œè®¤çŸ¥ã€‚&lt;/p&gt;

&lt;p&gt;æœ¬æ¬¡é€‰ç”¨çš„æŠ€æœ¯ç»„ä»¶ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;llm&lt;/strong&gt;ï¼šOpenAI&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Embedding&lt;/strong&gt;ï¼šOpenAI&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;VectorDB&lt;/strong&gt;ï¼šElasticSearch&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å®˜æ–¹ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;c1&quot;&gt;# 1.æ„å»ºå‘é‡æ•°æ®åº“å­˜å‚¨å¯¹è±¡å®ä¾‹
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vector_store&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ElasticsearchStore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;index_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;my_index&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;es_url&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://localhost:9200&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;storage_context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StorageContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_defaults&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vector_store&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vector_store&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# åŠ è½½æœ¬åœ°çš„æ•°æ®é›†
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documents&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SimpleDirectoryReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'data'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# æ„å»ºç´¢å¼•
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorStoreIndex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_documents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;storage_context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;storage_context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# æœåŠ¡å¯¹è±¡ï¼Œæ„å»ºqueryå¼•æ“
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;service_context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ServiceContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_defaults&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;llm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OpenAI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;query_engine&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;as_query_engine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;service_context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;service_context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# é—®é—®é¢˜
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query_engine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ä½é™¢èµ·ä»˜çº¿å¤šå°‘é’±?&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# å“åº”ç­”æ¡ˆ
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;2å¤„ç†è¿‡ç¨‹&quot;&gt;2.å¤„ç†è¿‡ç¨‹&lt;/h1&gt;

&lt;h2 id=&quot;21-æ•°æ®å¤„ç†è¿‡ç¨‹&quot;&gt;2.1 æ•°æ®å¤„ç†è¿‡ç¨‹&lt;/h2&gt;

&lt;p&gt;åœ¨æ•°æ®å¤„ç†çš„è¿‡ç¨‹ä¸­ï¼Œä¸»è¦åŒ…å«å‡ ä¸ªæ ¸å¿ƒçš„æ­¥éª¤ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;åˆå§‹åŒ–å‘é‡å­˜å‚¨å¼•æ“ï¼Œç›®å‰å‘é‡æ•°æ®åº“ç±»å‹éå¸¸å¤šï¼Œç¬”è€…æœ¬æœºè·‘äº†ä¸€ä¸ªesçš„dockeré•œåƒï¼Œè¿™é‡Œå°±é€‰æ‹©esäº†&lt;/li&gt;
  &lt;li&gt;è¯»å–æ•°æ®ï¼Œæ•°æ®æ ¼å¼åŒ…æ‹¬ï¼šPDFã€WORDã€TXTç­‰ç­‰æ–‡æœ¬æ•°æ®&lt;/li&gt;
  &lt;li&gt;åœ¨æ•°æ®è¯»å–å®Œæˆåï¼Œä¼šå¯¹æ–‡æ¡£å†…å®¹è¿›è¡Œåˆ†å‰²ï¼Œç„¶åEmbedding(è°ƒç”¨embeddingæ¨¡å‹)å­˜å‚¨å…¥åº“&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;211-å¤„ç†åŠ è½½ä¸åŒçš„æ–‡ä»¶ç±»å‹æ„å»ºdocument&quot;&gt;2.1.1 å¤„ç†åŠ è½½ä¸åŒçš„æ–‡ä»¶ç±»å‹(æ„å»ºDocument)&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SimpleDirectoryReader&lt;/code&gt;æ˜¯llamaindexæä¾›çš„ä¸€ä¸ªåŸºäºæ–‡ä»¶å¤¹çš„è¯»å–å™¨ç±»ï¼Œä¼šæ ¹æ®æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶æ‰©å±•åç¼€ç±»å‹è‡ªåŠ¨åŠ è½½æ•°æ®&lt;/p&gt;

&lt;p&gt;ä¸»è¦æ”¯æŒçš„æ–‡ä»¶æ•°æ®ç±»å‹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;DEFAULT_FILE_READER_CLS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BaseReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.hwp&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HWPReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.pdf&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PDFReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.docx&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DocxReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.pptx&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PptxReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.ppt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PptxReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.pptm&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PptxReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.jpg&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.png&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.jpeg&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.mp3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VideoAudioReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.mp4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VideoAudioReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.csv&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PandasCSVReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.epub&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EpubReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.md&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MarkdownReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.mbox&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MboxReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.ipynb&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IPYNBReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SimpleDirectoryReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BaseReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;Simple directory reader.

    Load files from file directory.
    Automatically select the best file reader given file extensions.

    Args:
        input_dir (str): Path to the directory.
        input_files (List): List of file paths to read
            (Optional; overrides input_dir, exclude)
        exclude (List): glob of python file paths to exclude (Optional)
        exclude_hidden (bool): Whether to exclude hidden files (dotfiles).
        encoding (str): Encoding of the files.
            Default is utf-8.
        errors (str): how encoding and decoding errors are to be handled,
              see https://docs.python.org/3/library/functions.html#open
        recursive (bool): Whether to recursively search in subdirectories.
            False by default.
        filename_as_id (bool): Whether to use the filename as the document id.
            False by default.
        required_exts (Optional[List[str]]): List of required extensions.
            Default is None.
        file_extractor (Optional[Dict[str, BaseReader]]): A mapping of file
            extension to a BaseReader class that specifies how to convert that file
            to text. If not specified, use default from DEFAULT_FILE_READER_CLS.
        num_files_limit (Optional[int]): Maximum number of files to read.
            Default is None.
        file_metadata (Optional[Callable[str, Dict]]): A function that takes
            in a filename and returns a Dict of metadata for the Document.
            Default is None.
    &quot;&quot;&quot;&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;supported_suffix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DEFAULT_FILE_READER_CLS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;....&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ€»å…±æ”¯æŒäº†16ä¸ªæ–‡ä»¶æ•°æ®ç±»å‹ï¼Œæ•´ç†åˆ°è¡¨æ ¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;æ–‡ä»¶ç±»å‹&lt;/th&gt;
      &lt;th&gt;ä¾èµ–ç»„ä»¶&lt;/th&gt;
      &lt;th&gt;è¯´æ˜&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;hwp&lt;/td&gt;
      &lt;td&gt;olefile&lt;/td&gt;
      &lt;td&gt;Â &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;pdf&lt;/td&gt;
      &lt;td&gt;pypdf&lt;/td&gt;
      &lt;td&gt;Â &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;docx&lt;/td&gt;
      &lt;td&gt;docx2txt&lt;/td&gt;
      &lt;td&gt;Â &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;pptxã€pptmã€ppt&lt;/td&gt;
      &lt;td&gt;python-pptxã€transformersã€torch&lt;/td&gt;
      &lt;td&gt;ç”¨åˆ°ä¸€äº›æ¨¡å‹ï¼Œå¯¹æ•°æ®è¿›è¡Œç†è§£ã€æå–&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;jpgã€pngã€jpegã€&lt;/td&gt;
      &lt;td&gt;sentencepieceã€transformersã€torch&lt;/td&gt;
      &lt;td&gt;ç”¨åˆ°ä¸€äº›æ¨¡å‹ï¼Œå¯¹æ•°æ®è¿›è¡Œç†è§£ã€æå–&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;mp3ã€mp4&lt;/td&gt;
      &lt;td&gt;whisper&lt;/td&gt;
      &lt;td&gt;ç”¨åˆ°ä¸€äº›æ¨¡å‹ï¼Œå¯¹æ•°æ®è¿›è¡Œç†è§£ã€æå–&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;csv&lt;/td&gt;
      &lt;td&gt;pandas&lt;/td&gt;
      &lt;td&gt;Â &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;epub&lt;/td&gt;
      &lt;td&gt;EbookLibã€html2text&lt;/td&gt;
      &lt;td&gt;Â &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;md&lt;/td&gt;
      &lt;td&gt;æ— &lt;/td&gt;
      &lt;td&gt;æœ¬åœ°æµç›´æ¥openï¼Œè¯»å–æ–‡æœ¬&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;mbox&lt;/td&gt;
      &lt;td&gt;bs4ã€mailbox&lt;/td&gt;
      &lt;td&gt;Â &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ipynb&lt;/td&gt;
      &lt;td&gt;nbconvert&lt;/td&gt;
      &lt;td&gt;Â &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;æ•´ä¸ªReaderç±»çš„UMLç±»å›¾è®¾è®¡å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/llamaindex-reader-uml.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æ‰€æœ‰æ–‡ä»¶æ•°æ®ç±»å‹çš„Readerï¼Œé€šè¿‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;load_data&lt;/code&gt;æ–¹æ³•ï¼Œæœ€ç»ˆå¾—åˆ°è¯¥æ–‡æ¡£çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Document&lt;/code&gt;å¯¹è±¡é›†åˆï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Document&lt;/code&gt;ç±»æ˜¯LlamaIndexæ¡†æ¶çš„å¤„ç†æ–‡æ¡£çš„æ ¸å¿ƒç±»å¯¹è±¡,ä»è¯¥ç±»çš„ç»“æ„è®¾è®¡æ¥çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸€ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;æ ¸å¿ƒå­—æ®µ&lt;/strong&gt;ï¼š&lt;strong&gt;id(æ–‡æ¡£å”¯ä¸€id)&lt;/strong&gt;ã€&lt;strong&gt;text(æ–‡æœ¬å†…å®¹)&lt;/strong&gt;ã€&lt;strong&gt;embedding(å‘é‡floatæµ®ç‚¹å‹é›†åˆ)&lt;/strong&gt;ã€&lt;strong&gt;metadata(å…ƒæ•°æ®)&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;BaseNodeæä¾›äº†ä¸€ä¸ª&lt;strong&gt;æ ‘ç»“æ„&lt;/strong&gt;çš„è®¾è®¡ï¼Œå¯¹äºä¸€ç¯‡æ–‡æ¡£è€Œè¨€ï¼Œä»å¤šçº§æ ‡é¢˜åˆ’åˆ†æ¥çœ‹ï¼Œæ ‘ç»“æ„èƒ½æ›´å¥½çš„æè¿°ä¸€ç¯‡æ–‡æ¡£çš„åŸºç¡€ç»“æ„&lt;/li&gt;
  &lt;li&gt;Documentæä¾›äº†ä¸€äº›å¤–éƒ¨åº”ç”¨æ¡†æ¶é€‚é…çš„æ–¹æ³•ï¼Œæ¯”å¦‚ï¼šLangChainã€EmbedChainç­‰ç­‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/document.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æœ€ç»ˆæ„å»ºå®Œæˆæ‰€æœ‰çš„Documentä¿¡æ¯åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸‹é¢ä¸€ä¸ªç»“æ„ä¿¡æ¯&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;æœ¬ç¤ºä¾‹ç¨‹åºï¼Œä½¿ç”¨çš„æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œç”±äºæˆ‘ä»¬å¹¶æœªæŒ‡å®šåˆ†å‰²ç­‰ç­–ç•¥ï¼ŒLlamaIndexå¯¹äºPDFæ–‡ä»¶æ˜¯ä»¥Pageä¸ºå•ä½ï¼Œè¿›è¡Œåˆ‡å‰²ï¼Œæœ€ç»ˆå°†æ‰€æœ‰çš„Documentå¯¹è±¡å­˜å‚¨è¿›å…¥å‘é‡æ•°æ®åº“&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114153311229.png&quot; alt=&quot;image-20240114153311229&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;212-æ„å»ºå‘é‡æ•°æ®åº“ç´¢å¼•index&quot;&gt;2.1.2 æ„å»ºå‘é‡æ•°æ®åº“ç´¢å¼•(Index)&lt;/h3&gt;

&lt;p&gt;å½“æœ¬åœ°æ•°æ®é›†å¤„ç†å®Œæˆï¼Œå¾—åˆ°ä¸€ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Document&lt;/code&gt;é›†åˆçš„æ—¶å€™ï¼Œæ­¤æ—¶ï¼Œè¿™éœ€è¦æ„å»ºå‘é‡æ•°æ®åº“çš„ç´¢å¼•ï¼Œä¸»è¦æ˜¯åŒ…å«å‡ ä¸ªè¿‡ç¨‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;è°ƒç”¨ä¸åŒçš„å‘é‡æ•°æ®åº“ä¸­é—´ä»¶ï¼Œæ„å»ºé›†åˆç´¢å¼•ï¼Œå¯¹äºESæ¥è¯´ï¼Œåˆ™æ˜¯åˆ›å»ºIndex&lt;/li&gt;
  &lt;li&gt;è°ƒç”¨Embeddingæ¨¡å‹(åŸºäºOpenAIæä¾›çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;text-embedding-ada-002&lt;/code&gt;æ¨¡å‹)ï¼Œå°†Documentå¯¹è±¡é›†åˆä¸­çš„textæ–‡æœ¬ï¼Œè¿›è¡Œå‘é‡åŒ–å¤„ç†å¹¶èµ‹å€¼&lt;/li&gt;
  &lt;li&gt;å°†&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Document&lt;/code&gt;é›†åˆçš„å¯¹è±¡å€¼(textã€embeddingã€metadata)å­˜å‚¨è¿›å…¥å‘é‡æ•°æ®åº“&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨LlamaIndexåˆ›å»ºESçš„å‘é‡ç´¢å¼•ç»“æ„ä¸­ï¼Œåˆå§‹æƒ…å†µä¸‹ï¼Œæ ¸å¿ƒå­—æ®µä¹Ÿæ˜¯å‰é¢æˆ‘ä»¬æåˆ°çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Document&lt;/code&gt;ç±»ä¸­çš„å‡ ä¸ªæ ¸å¿ƒå­—æ®µ(idã€embeddingã€contentã€metadata)ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114164439411.png&quot; alt=&quot;image-20240114164439411&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯åœ¨Documentå¯¹è±¡éå†ç»“æŸåï¼Œåœ¨æ•°æ®å­˜å‚¨é˜¶æ®µï¼Œè€ƒè™‘åˆ°å…ƒæ•°æ®çš„ä¿¡æ¯ï¼ŒLlamaIndexä¼šæ‰©å……metadataå…ƒæ•°æ®çš„å­—æ®µï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114164647308.png&quot; alt=&quot;image-20240114164647308&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å…ƒæ•°æ®ä¿¡æ¯ä¼šå°†æ–‡æ¡£çš„ä¿¡æ¯æå–å‡ºæ¥ï¼ŒåŒ…æ‹¬é¡µç ã€æ–‡ä»¶å¤§å°ã€æ–‡ä»¶åç§°ã€åˆ›å»ºæ—¥æœŸç­‰ç­‰ä¿¡æ¯&lt;/p&gt;

&lt;p&gt;æœ€ç»ˆåœ¨æœ¬åœ°æ•°æ®é›†çš„æƒ…å†µä¸‹ï¼ŒLlamaIndexåˆ›å»ºçš„ESæ•°æ®ç´¢å¼•ç»“æ„æœ€ç»ˆå°±ä¼šå˜æˆä¸‹é¢è¿™ç§ç»“æ„å½¢å¼ï¼š&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;mappings&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;properties&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;embedding&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;dense_vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;dims&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1536&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;index&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;similarity&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;cosine&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;metadata&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;properties&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;_node_content&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;fields&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;ignore_above&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;_node_type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;fields&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;ignore_above&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;creation_date&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;date&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;doc_id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;document_id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;file_name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;fields&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;ignore_above&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;file_path&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;fields&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;ignore_above&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;file_size&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;long&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;file_type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;fields&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;ignore_above&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;last_accessed_date&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;date&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;last_modified_date&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;date&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;page_label&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;fields&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;ignore_above&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;ref_doc_id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ•°æ®Indexå®šä¹‰å®Œæˆï¼ŒDocumentå¯¹è±¡å­˜å‚¨è¿›å…¥å‘é‡æ•°æ®åº“ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬çš„æ•°æ®é›†ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114173127581.png&quot; alt=&quot;image-20240114173127581&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;22-é—®ç­”è·å–ç­”æ¡ˆ&quot;&gt;2.2 é—®ç­”è·å–ç­”æ¡ˆ&lt;/h2&gt;

&lt;p&gt;åœ¨è·å–ç­”æ¡ˆçš„è¿‡ç¨‹ä¸­ï¼Œä¸»è¦åŒ…å«å‡ ä¸ªæ ¸å¿ƒçš„æ­¥éª¤ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ„å»ºç”¨æˆ·æŸ¥è¯¢Queryï¼Œå¯¹queryè¿›è¡ŒEmbeddingå¤„ç†ï¼Œå¬å›Topkçš„ç›¸ä¼¼ç‰‡æ®µå†…å®¹ã€‚&lt;/li&gt;
  &lt;li&gt;ç»„è£…Promptå·¥ç¨‹å†…å®¹ï¼Œå‘é€å¤§æ¨¡å‹è·å–ç­”æ¡ˆ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;221-å¬å›æŸ¥è¯¢è·å–topk&quot;&gt;2.2.1 å¬å›æŸ¥è¯¢è·å–TopK&lt;/h3&gt;

&lt;p&gt;é¦–å…ˆï¼Œåœ¨RAGçš„æŸ¥è¯¢é˜¶æ®µï¼Œä¸ç®¡æ˜¯ä½¿ç”¨é‚£ä¸ªå‘é‡æ•°æ®åº“ï¼Œæ ¹æ®æ•°æ®åº“çš„ç±»å‹ï¼Œå°†ç”¨æˆ·çš„queryè¯­å¥è¿›è¡ŒEmbeddingåï¼Œå†æ„å»ºæ•°æ®åº“çš„æŸ¥è¯¢æ¡ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114155247333.png&quot; alt=&quot;image-20240114155247333&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è¿™é‡Œé¢ä¼šåŒ…å«å‡ ä¸ªæ ¸å¿ƒçš„å‚æ•°ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;embeddingï¼šknnæŸ¥è¯¢çš„æµ®ç‚¹å‹å‘é‡æ•°ç»„å€¼&lt;/li&gt;
  &lt;li&gt;top_k:æ ¹æ®knnç›¸ä¼¼åº¦æŸ¥è¯¢è·å–å¾—åˆ°çš„topkå€¼æ•°é‡ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒLlamaIndexé»˜è®¤å€¼æ˜¯2&lt;/li&gt;
  &lt;li&gt;filtersï¼šè¿‡æ»¤æ¡ä»¶&lt;/li&gt;
  &lt;li&gt;alphaï¼šè¯­ä¹‰&amp;amp;å…³é”®è¯æ··åˆæ£€ç´¢çš„æƒé‡ï¼Œ0ä»£è¡¨bm25ç®—æ³•æ£€ç´¢ï¼Œ1åˆ™ä»£è¡¨knn&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;VectorStoreQuery&lt;/code&gt;ç±»ç»“æ„å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataclass&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;VectorStoreQuery&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;Vector store query.&quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# knnæœç´¢çš„æŸ¥è¯¢Embeddingæµ®ç‚¹å‹æ•°ç»„
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;query_embedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# knnæœç´¢çš„top kå–å€¼
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;similarity_top_k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;doc_ids&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;node_ids&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;query_str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;output_fields&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;embedding_field&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorStoreQueryMode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorStoreQueryMode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DEFAULT&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# NOTE: only for hybrid search (0 for bm25, 1 for vector search)
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# metadata filters
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;filters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MetadataFilters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# only for mmr
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;mmr_threshold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# NOTE: currently only used by postgres hybrid search
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;sparse_top_k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# NOTE: return top k results from hybrid search. similarity_top_k is used for dense search top k
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;hybrid_top_k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;


&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ ¹æ®queryçš„æ¡ä»¶ï¼Œä¼šä»å‘é‡æ•°æ®åº“ä¸­å¬å›è·å–å¾—åˆ°topkçš„TextNodeæ•°ç»„ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114175533596.png&quot; alt=&quot;image-20240114175533596&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;222-æ„å»ºpromptå‘é€å¤§æ¨¡å‹è·å–ç­”æ¡ˆ&quot;&gt;2.2.2 æ„å»ºPromptå‘é€å¤§æ¨¡å‹è·å–ç­”æ¡ˆ&lt;/h3&gt;

&lt;p&gt;æœ€ç»ˆå¬å›åˆ°å¼•ç”¨æ–‡æ¡£å†…å®¹åï¼Œå‰©ä¸‹çš„å°±æ˜¯æ„å»ºæ•´ä¸ªå¤§æ¨¡å‹å¯¹è¯çš„Promptå·¥ç¨‹ï¼Œæ¥çœ‹çœ‹LlamaIndexçš„åŸºç¡€Promptæ˜¯å¦‚ä½•æ„å»ºçš„&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114160925472.png&quot; alt=&quot;image-20240114160925472&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114180819057.png&quot; alt=&quot;image-20240114180819057&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;partial_format&lt;/code&gt;æ–¹æ³•è·å–å¾—åˆ°ä¸€ä¸ªåŸºç¡€çš„Promptæ¨¡ç‰ˆä¿¡æ¯ï¼Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;'Context information is below.
---------------------
{context_str}
---------------------
Given the context information and not prior knowledge, answer the query.
Query: {query_str}
Answer: '
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¿™é‡Œæœ‰ä¸¤ä¸ªæ ¸å¿ƒçš„å‚æ•°ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;context_str&lt;/code&gt;: ä»å‘é‡æ•°æ®åº“å¬å›æŸ¥è¯¢çš„çŸ¥è¯†åº“å¼•ç”¨æ–‡æœ¬æ•°æ®ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä»æ¨¡ç‰ˆçš„è®¾å®šä¹Ÿæ˜¯å‘Šè¯‰å¤§æ¨¡å‹åŸºäºçŸ¥è¯†ä¿¡æ¯è¿›è¡Œå›ç­”&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;query_str&lt;/code&gt;ï¼šç”¨æˆ·æé—®çš„é—®é¢˜&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è€Œæœ€ç»ˆçš„context_strä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114181236770.png&quot; alt=&quot;image-20240114181236770&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬çš„é—®é¢˜æ˜¯ï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ä½é™¢èµ·ä»˜çº¿å¤šå°‘é’±?&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ä»æœ€ç»ˆknnæ£€ç´¢å¬å›çš„æ–‡æ¡£ç‰‡æ®µæ¥çœ‹ï¼Œç²¾å‡†çš„æ‰¾åˆ°äº†çŸ¥è¯†åº“çš„å¼•ç”¨å†…å®¹ï¼Œæ­¤æ—¶ï¼Œäº¤ç»™å¤§æ¨¡å‹è¿›è¡Œå›ç­”ï¼Œè·å–æˆ‘ä»¬æƒ³è¦çš„ç­”æ¡ˆç»“æœã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114181429648.png&quot; alt=&quot;image-20240114181429648&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;3æ€»ç»“&quot;&gt;3.æ€»ç»“&lt;/h2&gt;

&lt;p&gt;å¥½äº†ï¼Œæœ¬æ–‡ä»LlamaIndexç»™æˆ‘ä»¬æä¾›çš„åŸºç¡€çš„ç¤ºä¾‹ç¨‹åºï¼ŒåŸºäºBasic RAGçš„åŸºç¡€æ¶æ„æ¥åˆ†ææ•°æ®çš„å¤„ç†ã€å¬å›å“åº”ç­‰è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°LlamaIndexæ¡†æ¶ç»™äº†æˆ‘ä»¬ä¸€ä¸ªå¾ˆå¥½çš„å¤„ç†æµç¨‹ï¼Œä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å¯¹äºåŸºç¡€çš„RAGæ¶æ„ï¼Œæœ‰ä¸€ä¸ªå¾ˆå¥½çš„è®¤çŸ¥ï¼Œè®©å¼€å‘è€…çŸ¥é“RAGæ˜¯ä¸€ä¸ªæ€æ ·çš„å¤„ç†è¿‡ç¨‹&lt;/li&gt;
  &lt;li&gt;åº•å±‚çš„å‘é‡æ•°æ®åº“å­˜å‚¨ç»“æ„è®¾è®¡å’Œä¸­é—´ç¨‹åºçš„ç»“æ„è®¾è®¡ï¼Œèƒ½å¤Ÿç»™åšRAGåº”ç”¨çš„å¼€å‘äººå‘˜ä¸€äº›å¯å‘ï¼Œæµè¡Œçš„RAGæ¡†æ¶åœ¨æ•°æ®ç»“æ„è®¾è®¡ä¸Šæ˜¯å¦‚ä½•åšçš„ï¼Œè¿™å¯¹äºä¼ä¸šå¼€å‘äººå‘˜æ¥è¯´ï¼Œæ¶æ„&amp;amp;æ•°æ®ç»“æ„è®¾è®¡æ˜¯æœ‰å¾ˆé‡è¦çš„å‚è€ƒæ„ä¹‰ã€‚&lt;/li&gt;
&lt;/ul&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="å¤§æ¨¡å‹" /><category term="RAGå®è·µ" /><category term="TorchV" /><category term="RAGæ¦‚è¿°" /><category term="RAG" /><category term="å¤§æ¨¡å‹" /><category term="LLM" /><summary type="html">1.å‰è¨€</summary></entry><entry><title type="html">TorchVçš„RAGå®è·µåˆ†äº«(äºŒ)ï¼šåŸºäºElasticSearchçš„æ··åˆæ£€ç´¢å®æˆ˜&amp;amp;åŸç†åˆ†æ</title><link href="http://localhost:4000/2023/12/27/torchv-rag-2/" rel="alternate" type="text/html" title="TorchVçš„RAGå®è·µåˆ†äº«(äºŒ)ï¼šåŸºäºElasticSearchçš„æ··åˆæ£€ç´¢å®æˆ˜&amp;amp;åŸç†åˆ†æ" /><published>2023-12-27T00:00:00+08:00</published><updated>2023-12-27T00:00:00+08:00</updated><id>http://localhost:4000/2023/12/27/torchv-rag-2</id><content type="html" xml:base="http://localhost:4000/2023/12/27/torchv-rag-2/">&lt;h2 id=&quot;æ¦‚è¿°&quot;&gt;æ¦‚è¿°&lt;/h2&gt;

&lt;p&gt;åœ¨æ˜¨å¤©å‘˜å¤–åˆ†äº«çš„&lt;a href=&quot;https://mp.weixin.qq.com/s/62b8DMfbnqGDJsCx4MwXeg&quot;&gt;ã€ŠTorchVçš„RAGå®è·µåˆ†äº«ï¼ˆ1ï¼‰â€”â€”RAGçš„å®šä½ã€æŠ€æœ¯é€‰å‹å’ŒRAGæŠ€æœ¯æ–‡ç« ç›®å½•ã€‹&lt;/a&gt;ä¸€æ–‡ä¸­ä»‹ç»äº†&lt;strong&gt;TorchV&lt;/strong&gt;çš„ç”±æ¥ï¼Œä¹Ÿåˆ†äº«äº†æˆ‘ä»¬çš„å‡ ä¸ªåŸºçº¿äº§å“å’Œåº”ç”¨æ¶æ„çš„æ–¹å‘ï¼Œæˆ‘ä»¬æƒ³çš„æ˜¯åœ¨åˆ›ä¸šçš„è¿‡ç¨‹ä¸­ï¼Œå°†æˆ‘ä»¬è‡ªå·±çš„ä¸€äº›äº§å“ç†å¿µã€æŠ€æœ¯å¿ƒå¾—éƒ½é€šè¿‡å…¬ä¼—å·å‘æ–‡çš„æ–¹å¼åˆ†äº«å‡ºæ¥ï¼Œæ›´å¤šçš„å’Œè¡Œä¸šå†…çš„ä¸“å®¶ä»¬å…±åŒäº¤æµï¼Œè¿™å¯¹æˆ‘ä»¬è‡ªå·±ä¹Ÿæ˜¯ä¸€ç§æå‡å’Œé”»ç‚¼ï¼Œä¹ŸæœŸå¾…å’Œå®¢æˆ·ä¸€èµ·å…±åˆ›æˆé•¿ï¼Œé€æ­¥æŠŠäº§å“æ‰“ç£¨å¥½ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ç›®å‰å¤§æ¨¡å‹åº”ç”¨æŠ€æœ¯æ¶æ„ä¸­ï¼Œé€šè¿‡å¬å›ä¸Šä¸‹æ–‡æ¥å›ç­”ç”¨æˆ·çš„é—®é¢˜æ˜¯è§£å†³å¤§æ¨¡å‹å½“ä¸‹çš„å¹»è§‰é—®é¢˜æœ€é è°±/ç»æµå®æƒ çš„ä¸€ç§è§£å†³æ–¹æ¡ˆ,RAGæ£€ç´¢å¢å¼ºæŠ€æœ¯åœ¨æ•´ä¸ªLLMæŠ€æœ¯æ¶æ„ä½“ç³»ä¸­çš„ä½œç”¨è¶Šæ¥è¶Šæ˜æ˜¾ã€‚è€Œæ£€ç´¢å¬å›å’Œç”¨æˆ·çš„queryé—®å¥çš„è´¨é‡åˆ™ç›´æ¥å…³ç³»åˆ°æœ€ç»ˆå¤§æ¨¡å‹çš„ç”Ÿæˆç»“æœã€‚åœ¨å‘é‡æ•°æ®åº“åŸºç¡€è®¾æ–½æ™®åŠçš„ä»Šå¤©ï¼Œä»…ä»…é€šè¿‡è¯­ä¹‰æœç´¢å¬å›å·²ç»æ— æ³•æ»¡è¶³ä¼ä¸šçº§çš„éœ€æ±‚ï¼Œå¤§å®¶å‘ç°ä¼ ç»Ÿçš„æœç´¢æŠ€æœ¯(åŸºäºå…³é”®è¯ã€è¯é¢‘ç­‰ç›¸å…³æ€§çš„æœç´¢)çš„ä½œç”¨ä¹Ÿæ˜¾å¾—å°¤ä¸ºé‡è¦ï¼Œæ··åˆæ£€ç´¢ä¹Ÿæˆä¸ºäº†ç›®å‰åœ¨RAGçš„æŠ€æœ¯æ¶æ„ä¸­çš„ä¸»æµæ£€ç´¢æ–¹å¼ï¼Œæ··åˆæ£€ç´¢é€šè¿‡æ‰¬é•¿é¿çŸ­çš„æ–¹å¼ï¼Œåœ¨ä¸åŒçš„ä¸šåŠ¡åº”ç”¨åœºæ™¯ä¸­å½¢æˆäº†å¾ˆå¥½çš„äº’è¡¥ï¼Œå¯¹äºä¸åŒçš„ä¸šåŠ¡åœºæ™¯éœ€æ±‚ä¸­ï¼Œå¯ä»¥æ›´çµæ´»çš„è¿›è¡Œé…ç½®æ»¡è¶³ä¸šåŠ¡éœ€è¦ï¼Œæ˜¯RAGæŠ€æœ¯æ¶æ„ä½“ç³»ä¸­éå¸¸é‡è¦çš„é‡è¦ä¸€ç¯ã€‚&lt;/p&gt;

&lt;p&gt;æœ¬æ–‡ä¸­æ‰€æåˆ°çš„æ··åˆæ£€ç´¢ä¸»è¦æ˜¯ä¸¤ç§æœç´¢æŠ€æœ¯çš„ç»“åˆï¼Œä¸»è¦å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ç›¸å…³æ€§æœç´¢ï¼š&lt;/strong&gt; åŸºäºBM25ã€TF-IDFç®—æ³•ï¼Œä¸»è¦é€‚ç”¨äºæ–‡æœ¬ç²¾ç¡®åŒ¹é…çš„ç›¸å…³æ€§åŒ¹é…æœç´¢ï¼Œå®ƒåœ¨åŒ¹é…ç‰¹å®šæœ¯è¯­ï¼ˆå¦‚äº§å“åæˆ–ä¸“ä¸šæœ¯è¯­ï¼‰æ–¹é¢è¡¨ç°å‡ºè‰²ï¼Œä½†å¯¹æ‹¼å†™é”™è¯¯å’ŒåŒä¹‰è¯è¾ƒä¸ºæ•æ„Ÿï¼Œå¯èƒ½ä¼šå¿½ç•¥ä¸€äº›é‡è¦çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;è¯­ä¹‰æœç´¢ï¼š&lt;/strong&gt; åŸºäºå‘é‡çš„Knnç®—æ³•è¿›è¡Œçš„è¯­ä¹‰æ£€ç´¢ï¼Œå®ƒèƒ½å¤ŸåŸºäºç”¨æˆ·çš„queryè¯­ä¹‰å«ä¹‰è¿›è¡Œå¤šè¯­è¨€å’Œå¤šæ¨¡æ€æœç´¢ï¼Œå¯¹æ‹¼å†™é”™è¯¯å…·æœ‰è¾ƒå¥½çš„å®¹é”™æ€§ï¼Œä½†å¯èƒ½ä¼šå¿½è§†å…³é”®è¯ã€‚æ­¤å¤–ï¼Œå®ƒçš„æ•ˆæœä¾èµ–äºå‘é‡åµŒå…¥çš„è´¨é‡ï¼Œå¹¶å¯¹éä¸“ä¸šé¢†åŸŸçš„æœ¯è¯­è¾ƒä¸ºæ•æ„Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æœ¬æ–‡é’ˆå¯¹ElasticSearchä¸­é—´ä»¶æ¥å®ç°æ•´ä¸ªå¤–éƒ¨çŸ¥è¯†åº“å‘é‡çš„å­˜å‚¨å’Œè®¡ç®—ï¼Œåœ¨RAGæŠ€æœ¯æ¶æ„ä¸­çš„æ··åˆæ£€ç´¢è¿›è¡Œæ¢ç´¢å’Œåˆ†æï¼Œç»“åˆæˆ‘ä»¬è‡ªå·±çš„å®é™…ä¸šåŠ¡æƒ…å†µï¼Œå¦‚ä½•é€šè¿‡åº•å±‚çš„æŠ€æœ¯é©±åŠ¨ï¼Œå®Œå–„æˆ‘ä»¬çš„äº§å“è®¾è®¡ï¼Œæ”¹å–„æ•´ä¸ªäº§å“æµç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;æ•´ç¯‡æ–‡ç« ä¸»è¦åŒ…æ‹¬ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ç®€ä»‹ï¼šç®€è¦æ¦‚è¿°ElasticSearchä¸­é—´ä»¶ä»¥åŠåœ¨RAGæŠ€æœ¯æ¶æ„çš„é€‰å‹åŠå®ç°&lt;/li&gt;
  &lt;li&gt;ç®—æ³•ç†è®ºï¼šå‚æ•°åœ¨æ··åˆæ£€ç´¢è¿‡ç¨‹ä¸­æ¶‰åŠçš„ç®—æ³•ç†è®ºçŸ¥è¯†ï¼Œé¢å‘çš„ä¸šåŠ¡åœºæ™¯åŠé€‰æ‹©æ–¹å¼&lt;/li&gt;
  &lt;li&gt;å¬å›Scoreåˆ†å€¼è®¡ç®—ï¼šè®²è§£ElasticSearchç»„ä»¶åœ¨å¬å›è®¡ç®—è¿‡ç¨‹ä¸­çš„Scoreåˆ†å€¼è§„åˆ™åŠç®—æ³•ç»†èŠ‚&lt;/li&gt;
  &lt;li&gt;TorchVäº§å“é©±åŠ¨ï¼šæŠ€æœ¯æ¨åŠ¨æˆ‘ä»¬TorchVäº§å“çš„äº§å“æ¶æ„è®¾è®¡ï¼Œå¦‚ä½•å½±å“äº§å“æµç¨‹&lt;/li&gt;
  &lt;li&gt;ç»“è®ºï¼šæ•´ç¯‡çš„æ€»ç»“æ¦‚è¿°åŠå‚è€ƒæ–‡ç« &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;elasticsearchç®€ä»‹&quot;&gt;ElasticSearchç®€ä»‹&lt;/h2&gt;

&lt;p&gt;åœ¨ä»‹ç»ElasticSearchçš„æ··åˆæ£€ç´¢ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç®€å•å›é¡¾ElasticSearchè¿™ä¸ªä¸­é—´ä»¶å¦‚ä½•åœ¨ç›®å‰AIæŠ€æœ¯åœºæ™¯çš„è½åœ°æƒ…å†µ&lt;/p&gt;

&lt;p&gt;åœ¨ç›®å‰çš„RAGå¤§æ¨¡å‹æŠ€æœ¯æ¶æ„ä½“ç³»ä¸­ï¼Œå‘é‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Vector&lt;/code&gt;æŠ€æœ¯å·²ç»ä½œä¸ºå¤§æ¨¡å‹å¤–æŒ‚çŸ¥è¯†åº“çš„éå¸¸é‡è¦çš„æŠ€æœ¯æ ˆï¼Œå‘é‡çš„æ ¸å¿ƒå¯¹äºæ•°æ®çš„è¡¨å¾(Embedding)ç„¶åæ‰§è¡Œç›¸ä¼¼åº¦(Similarity)è®¡ç®—ã€‚2023å¹´éšç€å¤§æ¨¡å‹æŠ€æœ¯çš„å‘å¸ƒå¸¦ç«äº†éå¸¸å¤šçš„å‘é‡æ•°æ®åº“ï¼Œç‰¹åˆ«æ˜¯&lt;a href=&quot;https://python.langchain.com/docs/get_started/introduction&quot;&gt;LangChain&lt;/a&gt;ã€&lt;a href=&quot;https://docs.llamaindex.ai/en/stable/&quot;&gt;llama_index&lt;/a&gt;ç­‰LLMæ•°æ®åº”ç”¨æ¡†æ¶çš„å‘å¸ƒï¼ŒåŒ…æ‹¬:&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Milvus&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Qdrant&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Pinecone&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Chroma&lt;/code&gt;ç­‰ç­‰ä¸“ä¸šçš„å‘é‡æ•°æ®åº“ä¸­é—´ä»¶ã€‚å‘é‡æ•°æ®ç»“æ„çš„å­˜å‚¨ä¸è®¡ç®—å¯ä»¥è¯´æ˜¯å½“å‰åšå¤§æ¨¡å‹åº”ç”¨çš„åŸºå»ºäº§å“äº†ï¼Œå°±å¥½åƒä¼ ç»Ÿè½¯ä»¶å·¥ç¨‹ä¸­çš„æ•°æ®åº“ä¸€æ ·ã€‚&lt;/p&gt;

&lt;p&gt;è€Œå¯¹äºElasticSearchè€Œè¨€ä¹ŸåŒæ ·å¦‚æ­¤ï¼Œå¯¹äºä¹‹å‰ä½¿ç”¨ElasticSearchä¸­é—´ä»¶çš„å¼€å‘äººå‘˜è€Œè¨€ï¼Œå¯èƒ½å¯¹äºå‘é‡æ•°æ®çš„å­˜å‚¨å’Œè®¡ç®—æ˜¯æ¯”è¾ƒé™Œç”Ÿçš„ï¼Œåœ¨ä¼ ç»Ÿè½¯ä»¶å·¥ç¨‹ç”¨ESæ¥å‚¨å­˜æœç´¢ä¸»è¦è¿˜æ˜¯åŸºäºå…³é”®è¯æœç´¢æŠ€æœ¯(BM25ã€TF-IDF)ç­‰å®ç°ï¼Œæœ¬è´¨è¿˜æ˜¯åŸºäºæ–‡æœ¬çš„ç²¾ç¡®åŒ¹é…ã€‚è€Œåœ¨æœ€è¿‘ESç»„ä»¶å‘å¸ƒçš„ç‰ˆæœ¬æ¥çœ‹ï¼Œç‰¹åˆ«æ˜¯ES 8.0ç‰ˆæœ¬å‘å¸ƒå¯¹äºKNNç®—æ³•æœç´¢çš„ä¼˜åŒ–æ”¯æŒæ¥çœ‹ï¼ŒAIå¤§æ¨¡å‹è¿™åœºæŠ€æœ¯é©å‘½é£æš´ï¼Œä¼¼ä¹ä¹Ÿä¸æƒ³è¢–æ‰‹æ—è§‚ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬é€‰æ‹©ElasticSearchä½œä¸ºTorchVçš„åŸºç¡€RAGæ¶æ„ç»„ä»¶ä¹Ÿæ˜¯å‡ºäºä»¥ä¸‹å‡ ä¸ªæ–¹é¢è€ƒè™‘ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å¼€ç®±å³ç”¨çš„è¯­ä¹‰æœç´¢åŠŸèƒ½ä»¥åŠä¸€æµçš„ç›¸å…³æ€§æ£€ç´¢(BM25/TF-IDF)ç®—æ³•å®ç°&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åŒºåˆ«äºå…¶å®ƒå‘é‡æ•°æ®åº“æ‰€ä¸å…·å¤‡çš„ç‰¹æœ‰åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼šèšåˆã€è¿‡æ»¤ã€é›†ç¾¤ã€åˆ†å¸ƒå¼ç­‰ç­‰ç‰¹æ€§ã€‚&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¤šå¹´çš„æŠ€æœ¯æ²‰æ·€å’Œç¤¾åŒºå‘å±•ï¼Œä¸åŒç¼–ç¨‹è¯­è¨€çš„ç”Ÿæ€å®Œå–„æˆç†Ÿåº¦ç­‰&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨ElasticSearchçš„ç›®å‰çš„ç‰ˆæœ¬ä¸­ï¼Œè¦ä½¿ç”¨å‘é‡å®ç°å­˜å‚¨å’Œè®¡ç®—å¯¹äºå¼€å‘è€…ä½¿ç”¨ä¸Šéå¸¸ç®€å•ï¼Œå¼€å‘è€…åœ¨å®šä¹‰ESçš„ç´¢å¼•ç»“æ„æ—¶ï¼Œå®šä¹‰å‘é‡å­—æ®µç±»å‹&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dense_vector&lt;/code&gt;,å¹¶ä¸”è‡ªå®šä¹‰å‘é‡ç»´åº¦&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dims&lt;/code&gt;(æœ€å¤§ç»´åº¦ä¸è¶…è¿‡4096(è‡ª8.xç‰ˆæœ¬å¼€å§‹))ï¼Œå¦‚ä¸‹ç´¢å¼•ç»“æ„ï¼š&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;PUT&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;-001&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;mappings&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;properties&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;my_vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;dense_vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;dims&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;my_text&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åœ¨æ‰§è¡Œæœç´¢æ—¶åˆ™å¯ä»¥é€šè¿‡&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/8.0/knn-search.html&quot;&gt;k-æœ€è¿‘é‚»(KNN)æœç´¢&lt;/a&gt;æ‰¾åˆ°ä¸æŸ¥è¯¢å‘é‡æœ€è¿‘çš„Kä¸ªå‘é‡ç»“æœå€¼æ¥è·å–ç»“æœï¼Œé€šè¿‡ç›¸ä¼¼åº¦å€¼æ¥è¡¡é‡è·å–æ–‡æ¡£ç‰‡æ®µã€‚&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;GET&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;-001&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;/_knn_search&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;knn&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;field&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;my_vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;query_vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;k&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;num_candidates&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;_source&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;date&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è€Œæˆ‘ä»¬åœ¨å‰é¢æåˆ°ï¼Œ&lt;strong&gt;æ··åˆæ£€ç´¢&lt;/strong&gt;(è¯­ä¹‰æœç´¢+ç›¸å…³æ€§æœç´¢)æ˜¯ç›®å‰åšRAGçš„éå¸¸é‡è¦æ–‡æ¡£å¬å›æŠ€æœ¯æ‰‹æ®µï¼Œçº¯KNNæœç´¢å¹¶ä¸èƒ½å®Œå…¨æ»¡è¶³ä¸šåŠ¡çš„éœ€æ±‚ï¼Œå› æ­¤åœ¨å½“å‰çš„RAGæŠ€æœ¯æ¶æ„ä½“ç³»ä¸­ï¼ŒESåœ¨ä¿æŒä¼ ç»Ÿç›¸å…³æ€§æœç´¢çš„åŸºç¡€ä¸Šï¼Œå¢åŠ å¯¹è¯­ä¹‰æœç´¢çš„æŠ€æœ¯æ”¯æŒå°±æ˜¾å¾—å¾ˆæœ‰å†²å‡»åŠ›ï¼Œæ¯•ç«Ÿåœ¨å‘é‡æœç´¢ç«çˆ†ä¹‹å‰ï¼ŒESä½œä¸ºæœç´¢å¼•æ“çš„è€å¤§å“¥ï¼Œåœ¨ä¼ä¸šçº§çš„äº§å“åº”ç”¨ä½“ç³»ä¸­ï¼Œåº”ç”¨èŒƒå›´è¿˜æ˜¯éå¸¸å¹¿æ³›çš„ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ç®—æ³•ä¸šåŠ¡åœºæ™¯&quot;&gt;ç®—æ³•&amp;amp;ä¸šåŠ¡åœºæ™¯&lt;/h2&gt;

&lt;p&gt;åœ¨åšæ··åˆæ£€ç´¢æ—¶ï¼Œæˆ‘ä»¬ä¼šæ¥è§¦åˆ°ä¸¤ç±»ç®—æ³•ï¼Œéœ€è¦å¯¹ç®—æ³•æœ‰ä¸€ä¸ªåŸºç¡€äº†è§£ï¼Œè¿™æœ‰åŠ©äºæˆ‘ä»¬åœ¨åº”ç”¨äº§å“çš„æŠ€æœ¯ä½“ç³»ä¸­åšå†³ç­–ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;è¯­ä¹‰æ£€ç´¢ï¼šåŸºäºå‘é‡ç©ºé—´çš„KNNç®—æ³•&lt;/li&gt;
  &lt;li&gt;ç›¸å…³æ€§æ£€ç´¢ï¼šä¼ ç»Ÿçš„æ–‡æœ¬ç²¾ç¡®åŒ¹é…æ–¹æ³•ï¼ŒåŒ…æ‹¬BM25ã€TF-IDF&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;è¯­ä¹‰æ£€ç´¢knn&quot;&gt;è¯­ä¹‰æ£€ç´¢(knn)&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm&quot;&gt;KNNç®—æ³•&lt;/a&gt;&lt;/strong&gt;ï¼škè¿‘é‚»ç®—æ³•ï¼Œæ˜¯æœºå™¨å­¦ä¹ ç®—æ³•ä¸­ä¸€ç§&lt;strong&gt;åŸºæœ¬åˆ†ç±»å’Œå›å½’æ–¹æ³•&lt;/strong&gt;ã€‚åœ¨ç»™å®šçš„ä¸€ä¸ªæ•°æ®é›†ä¸­ï¼Œå¯¹äºæ–°çš„æ•°æ®å®ä¾‹ï¼Œæ‰¾åˆ°ä¸è¯¥å®ä¾‹æœ€é‚»è¿‘çš„kä¸ªå®ä¾‹ï¼Œè¿™kä¸ªå®ä¾‹çš„å¤šæ•°å±äºæŸä¸ªåˆ†ç±»ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;è¿™å°±åƒä½ åœ¨ä¸€ä¸ªé™Œç”Ÿçš„åŸå¸‚ï¼Œä½ å¯èƒ½ä¼šé—®å‘¨å›´çš„kä¸ªäººå“ªå®¶é¤é¦†æœ€å¥½ã€‚å¦‚æœå¤§å¤šæ•°äººéƒ½æ¨èåŒä¸€å®¶é¤é¦†ï¼Œé‚£ä¹ˆä½ å¯èƒ½ä¼šé€‰æ‹©å»é‚£å®¶é¤é¦†ã€‚&lt;/p&gt;

  &lt;p&gt;è€Œæˆ‘ä»¬åœ¨é€‰æ‹©é¤é¦†çš„è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€ä¸ªé¤é¦†ä¼šæœ‰éå¸¸å¤šçš„ç»´åº¦æ¥æè¿°è¿™ä¸ªé¤é¦†çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼šåœ°ç†ä½ç½®ã€èœç³»ã€ä»·æ ¼ã€ç¯å¢ƒã€å£å‘³ç­‰ç­‰ï¼Œè¿™ä¸€ç³»åˆ—å‚æ•°å±æ€§å°±æ˜¯ç‰¹å¾å·¥ç¨‹ï¼Œç›®å‰çš„å‘é‡Embeddingæ¨¡å‹ç”¨æ¥å¯¹ä¸€æ®µæ–‡æœ¬è¿›è¡ŒEmbeddingï¼Œå…¶å®å°±æ˜¯å¯¹äºè¯¥æ–‡æœ¬å†…å®¹çš„çš„ç‰¹å¾ä¿¡æ¯è¿›è¡Œæå–æè¿°ã€‚&lt;/p&gt;

  &lt;p&gt;è¿™ä¸ªæ—¶å€™ï¼Œä½ ä¼šæ ¹æ®ä½ è‡ªå·±çš„è¯‰æ±‚ï¼Œå¯¹äºé¤é¦†çš„ä¸åŒç‰¹å¾è¦æ±‚ï¼Œæœ€ç»ˆé€‰æ‹©ä½ è¦å»å“ªå®¶é¤é¦†åƒé¥­ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-2/KnnClassification.svg&quot; alt=&quot;å›¾1-KNNç®—æ³•å›¾ä¾‹&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨Elasticsearchä¸­ï¼ŒKNNæœç´¢ä¸»è¦é€šè¿‡ä½¿ç”¨å‘é‡ç›¸ä¼¼åº¦(ç‰¹å¾ç©ºé—´ä¸­çš„ä¸¤ä¸ªå®ä¾‹ç‚¹é—´çš„è·ç¦»å¯ä»¥åæ˜ å‡ºä¸¤ç‚¹é—´çš„ç›¸ä¼¼ç¨‹åº¦)è¿›è¡Œåº¦é‡ï¼Œæ–‡æ¡£æ ¹æ®å‘é‡æ•°æ®é›†ä¸æŸ¥è¯¢å‘é‡çš„ç›¸ä¼¼åº¦è¿›è¡Œæ’åã€‚æ¯ä¸ªæ–‡æ¡£çš„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_score&lt;/code&gt; å°†ä»ç›¸ä¼¼åº¦ä¸­å¾—å‡ºï¼Œä»¥ç¡®ä¿åˆ†æ•°ä¸ºæ­£å¹¶ä¸”åˆ†æ•°è¶Šé«˜å¯¹åº”äºè¶Šé«˜çš„æ’åã€‚&lt;/p&gt;

&lt;p&gt;ESç›®å‰ä¸»è¦æä¾›äº†ä¸‰ç§åº¦é‡çš„æ ‡å‡†ä¾›æˆ‘ä»¬é€‰æ‹©(è€ƒè™‘åˆ°æœ¬æ–‡æ˜¯åŸºäºesï¼Œå› æ­¤ä¹Ÿåªå¯¹è¯¥ä¸‰ç§åº¦é‡æ ‡å‡†åšä»‹ç»ï¼Œå¯¹äºå…¶å®ƒçš„å‘é‡è®¡ç®—è·ç¦»çš„æ–¹å¼ï¼Œå¼€å‘è€…å¯ä»¥è‡ªè¡Œæœç´¢äº†è§£)&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;L2_norm&lt;/strong&gt;(æ¬§å¼è·ç¦»)ï¼šè¿™æ˜¯æœ€å¸¸ç”¨çš„è·ç¦»åº¦é‡æ–¹å¼ï¼Œå®ƒè®¡ç®—çš„æ˜¯ä¸¤ä¸ªå‘é‡åœ¨ç¬›å¡å°”åæ ‡ç³»ä¸­çš„ç›´çº¿è·ç¦»ã€‚æ–‡æ¡£çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;score&lt;/code&gt;è®¡ç®—æ–¹å¼ä¸ºï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;1 / (1 + l2_norm(query, vector)^2)&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;dot_product&lt;/strong&gt;(ç‚¹ç§¯)ï¼šç‚¹ç§¯æ˜¯ä¸¤ä¸ªå‘é‡çš„å¯¹åº”å…ƒç´ ç›¸ä¹˜ç„¶åæ±‚å’Œï¼Œæ–‡æ¡£ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_score&lt;/code&gt; è®¡ç®—ä¸º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(1 + dot_product(query, vector)) / 2&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;cosine&lt;/strong&gt;(ä½™å¼¦ç›¸ä¼¼åº¦,&lt;strong&gt;default&lt;/strong&gt;)ï¼šè®¡ç®—ä¸¤ä¸ªå‘é‡ä½™å¼¦ç›¸ä¼¼åº¦ï¼Œä½™å¼¦ç›¸ä¼¼æ€§åº¦é‡çš„æ˜¯ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„è§’åº¦ï¼Œè€Œä¸æ˜¯è·ç¦»ã€‚å®ƒçš„å€¼èŒƒå›´æ˜¯ -1 åˆ° 1ï¼Œå€¼è¶Šæ¥è¿‘ 1ï¼Œè¡¨ç¤ºä¸¤ä¸ªå‘é‡è¶Šç›¸ä¼¼ï¼Œæ–‡æ¡£ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_score&lt;/code&gt; è®¡ç®—ä¸º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(1 + cosine(query, vector)) / 2&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æˆ‘ä»¬åœ¨å¼€å‘RAGçš„å¤§æ¨¡å‹åº”ç”¨äº§å“ä¸­ï¼Œé€šå¸¸ä¼šå°†å¤–éƒ¨çš„çŸ¥è¯†åº“é€šè¿‡chunkåˆ†æ®µå­˜å‚¨å¤„ç†ï¼Œå¯¹äºç”¨æˆ·çš„queryï¼Œé€šè¿‡Embeddingæ¨¡å‹è¿›è¡Œè¡¨å¾ä¸ºå‘é‡åï¼Œä¸chunkç‰‡æ®µçš„å‘é‡è¿›è¡Œè·ç¦»è®¡ç®—ï¼Œæ­¤æ—¶ä½œä¸ºè·ç¦»åº¦é‡çš„æ–¹å¼è€ƒè™‘ï¼Œé‚£ä¹ˆæ ¹æ®å®é™…çš„ä¸šåŠ¡åœºæ™¯ï¼Œå°±å¯ä»¥è€ƒè™‘ä¸Šé¢çš„ä¸‰ç§ç±»å‹ä¸­çš„ä¸€ç§ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€èˆ¬é»˜è®¤é€‰æ‹©&lt;strong&gt;cosineä½™å¼¦ç›¸ä¼¼åº¦&lt;/strong&gt;è¿›è¡Œè®¡ç®—å¬å›ï¼Œä¸»è¦è€ƒè™‘ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;é•¿åº¦ä¸æ•æ„Ÿ&lt;/strong&gt;ï¼šåœ¨æ–‡æœ¬æ•°æ®ä¸­ï¼Œæ–‡æ¡£çš„é•¿åº¦å¯èƒ½ä¼šæœ‰å¾ˆå¤§çš„å·®å¼‚ï¼Œè¿™ä¼šå½±å“åˆ°å‘é‡çš„é•¿åº¦ã€‚ä½™å¼¦ç›¸ä¼¼æ€§åªå…³æ³¨å‘é‡çš„æ–¹å‘ï¼Œè€Œä¸å…³æ³¨é•¿åº¦ï¼Œå› æ­¤å®ƒå¯¹å°ºåº¦ä¸æ•æ„Ÿï¼Œé€‚åˆå¤„ç†è¿™ç§æƒ…å†µ(è™½ç„¶æˆ‘ä»¬åœ¨ä½¿ç”¨å‘é‡Embeddingæ¨¡å‹è¿›è¡Œè¡¨å¾æ—¶ï¼Œå‘é‡çš„ç»´åº¦éƒ½æ˜¯å›ºå®šçš„)ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ–¹å‘æ•æ„Ÿ&lt;/strong&gt;ï¼šåœ¨é—®ç­”ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å…³å¿ƒçš„æ˜¯æ–‡æ¡£çš„ä¸»é¢˜æˆ–è€…å†…å®¹æ˜¯å¦ç›¸ä¼¼ï¼Œè€Œä¸æ˜¯æ–‡æ¡£çš„é•¿åº¦ã€‚ä½™å¼¦ç›¸ä¼¼æ€§åº¦é‡çš„æ˜¯ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„è§’åº¦ï¼Œå¯ä»¥å¾ˆå¥½åœ°åæ˜ å‡ºæ–‡æ¡£çš„ä¸»é¢˜æˆ–è€…å†…å®¹æ˜¯å¦ç›¸ä¼¼ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;é«˜ç»´æ•°æ®&lt;/strong&gt;ï¼šå‘é‡Embeddingæ¨¡å‹è¡¨å¾çš„é«˜ç»´åº¦(768/1024/1536â€¦ç­‰ç­‰)å‘é‡ï¼Œé€‚åˆä½™å¼¦ç›¸ä¼¼æ€§é€‚åˆå¤„ç†è¿™ç§é«˜ç»´ç¨€ç–çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è€ŒESè‡ª8.0ç‰ˆæœ¬å‘å¸ƒåï¼ŒåŒæ ·ä¹Ÿæä¾›äº†å¯¹&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/knn-search.html&quot;&gt;KNNæœç´¢&lt;/a&gt;çš„ä¼˜åŒ–ï¼Œä¸»è¦æä¾›äº†ä¸¤ç§ç­–ç•¥ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;è¿‘é‚»KNNæœç´¢ç®—æ³•(&lt;strong&gt;ANN&lt;/strong&gt;)ï¼šæ•°æ®ç»“æ„åŸºäº&lt;a href=&quot;https://www.luxiangdong.com/2023/11/06/hnsw/&quot;&gt;HNSWç®—æ³•&lt;/a&gt;ç´¢å¼•å®ç°ï¼Œè¿‘ä¼¼ kNN æä¾›è¾ƒä½çš„å»¶è¿Ÿï¼Œä½†ä»£ä»·æ˜¯ç´¢å¼•é€Ÿåº¦è¾ƒæ…¢ä¸”å‡†ç¡®æ€§ä¸å®Œå–„(è¿™ä¹Ÿä¸ºåæ¥RAGæ¶æ„ä¸­çš„æ–‡æ¡£æ£€ç´¢ç»“æœåšReRanké‡æ’åŸ‹ä¸‹ä¼ç¬”ï¼Œå¯ä»¥å…³æ³¨å‘˜å¤–çš„è¿™ç¯‡&lt;a href=&quot;https://mp.weixin.qq.com/s/4UoRi8VhQjfE7zcpFnre4A&quot;&gt;ã€ŠRerankâ€”â€”RAGä¸­ç™¾å°ºç«¿å¤´æ›´è¿›ä¸€æ­¥çš„ç¥å™¨ï¼Œä»åŸç†åˆ°è§£å†³æ–¹æ¡ˆã€‹&lt;/a&gt;)ã€‚&lt;/li&gt;
  &lt;li&gt;ç²¾ç¡®ã€å¼ºåŠ›çš„ kNNæœç´¢(&lt;strong&gt;æš´åŠ›æœç´¢&lt;/strong&gt;)ï¼šåŸºäºå‡½æ•°å®ç°ï¼Œè¿™ç§æ–¹å¼èƒ½å¤Ÿä¿è¯ç»“æœçš„å‡†ç¡®æ€§ï¼Œé€šè¿‡è®¡ç®—&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;script_score&lt;/code&gt; å‡½æ•°æ‰«ææ¯ä¸ªåŒ¹é…æ–‡æ¡£è®¡ç®—å‘é‡è·ç¦»è·å–æ–‡æ¡£ç»“æœé›†ï¼Œè¿™ä¼šå¯¼è‡´æœç´¢é€Ÿåº¦ç¼“æ…¢(å¤§æ•°æ®é›†çš„åº”ç”¨åœºæ™¯ä¸‹)ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¼€å‘è€…åœ¨é€‰æ‹©KNNæœç´¢çš„ç®—æ³•ç­–ç•¥æ—¶ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…ä¸šåŠ¡éœ€è¦è¿›è¡ŒæŠ‰æ‹©ã€‚&lt;/p&gt;

&lt;h3 id=&quot;ç›¸å…³æ€§æ£€ç´¢bm25tf-idf&quot;&gt;ç›¸å…³æ€§æ£€ç´¢(BM25/TF-IDF)&lt;/h3&gt;

&lt;p&gt;ESè‡ª5.0ç‰ˆæœ¬ä¹‹åï¼Œé’ˆå¯¹æ–‡æ¡£çš„ç›¸å…³æ€§è¯„åˆ†æœºåˆ¶é»˜è®¤é‡‡ç”¨äº†BM25ç›¸ä¼¼åº¦ç®—æ³•(ä¹‹å‰æ˜¯åŸºäºTF-IDF)ï¼ŒBM25å…¨ç§°&lt;a href=&quot;https://en.wikipedia.org/wiki/Okapi_BM25&quot;&gt;Okapi BM25&lt;/a&gt;ã€‚Okapi æ˜¯ä½¿ç”¨å®ƒçš„ç¬¬ä¸€ä¸ªç³»ç»Ÿçš„åç§°ï¼Œå³Okapiä¿¡æ¯æ£€ç´¢ç³»ç»Ÿ,äº 20 ä¸–çºª 80 å¹´ä»£å’Œ 1990 å¹´ä»£åœ¨ä¼¦æ•¦åŸå¸‚å¤§å­¦å®æ–½ã€‚ BMåˆ™æ˜¯best matchingçš„ç¼©å†™ã€‚&lt;/p&gt;

&lt;p&gt;å› æ­¤å¯¹äºè¯çš„ç›¸å…³æ€§æ£€ç´¢æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯¹äºTF-IDFå’ŒBM25ä¹Ÿéœ€è¦æœ‰ä¸€ä¸ªåŸºç¡€çš„äº†è§£ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;TF-IDF(Term Frequency-Inverse Document Frequency)&lt;/strong&gt;:è¯é¢‘-é€†æ–‡æ¡£é¢‘ç‡æ˜¯ä¸€ä¸ªå¸¸ç”¨äºä¿¡æ¯æ£€ç´¢å’Œæ–‡æœ¬æŒ–æ˜çš„æƒé‡è®¡ç®—æ–¹æ³•ï¼Œå‡½æ•°å…¬å¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-2/tf_idf.png&quot; alt=&quot;tf-idf&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸»è¦ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;TFï¼ˆTerm Frequencyï¼Œè¯é¢‘ï¼‰&lt;/strong&gt;ï¼šè¡¡é‡ä¸€ä¸ªè¯åœ¨æ–‡æ¡£ä¸­å‡ºç°çš„é¢‘ç‡ã€‚å‡è®¾æŸä¸€è¯æ¡åœ¨æ–‡æœ¬ä¸­å‡ºç°çš„æ¬¡æ•°ä¸º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;n&lt;/code&gt;ï¼Œæ–‡æœ¬çš„æ€»è¯æ¡æ•°ä¸º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m&lt;/code&gt;ï¼Œåˆ™è¯é¢‘TFä¸ºn/m,ä¹Ÿå°±æ˜¯è¯é¢‘ï¼Œæ¯”å¦‚ä¸€ä¸ªå•è¯:&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;æ—…æ¸¸&lt;/code&gt;åœ¨æˆ‘ä»¬çš„ä¸€ç¯‡æ–‡æ¡£ä¸­å‡ºç°äº†4æ¬¡ï¼Œè€Œæˆ‘ä»¬çš„æ–‡æ¡£æ€»å…±åŒ…å«çš„è¯æ¡æ•°é‡æ˜¯100ï¼Œé‚£ä¹ˆè¯é¢‘çš„å€¼å°±æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;4/100&lt;/code&gt;ã€‚è¯é¢‘è¶Šé«˜ï¼Œè¯´æ˜è¿™ä¸ªè¯åœ¨æ–‡æ¡£ä¸­è¶Šé‡è¦ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;IDFï¼ˆInverse Document Frequencyï¼Œé€†æ–‡æ¡£é¢‘ç‡ï¼‰&lt;/strong&gt;ï¼šè¡¡é‡ä¸€ä¸ªè¯æ˜¯å¦å¸¸è§çš„åº¦é‡ã€‚å¦‚æœæŸä¸ªè¯åœ¨å¾ˆå¤šæ–‡æ¡£ä¸­éƒ½å‡ºç°ï¼Œé‚£ä¹ˆå®ƒå¯èƒ½å°±ä¸å…·æœ‰åŒºåˆ†èƒ½åŠ›(æ¯”å¦‚å¸¸ç”¨è¯ç­‰)ã€‚å®ƒçš„è®¡ç®—å…¬å¼æ˜¯ï¼šlog(æ–‡æ¡£æ€»æ•°(N) / åŒ…å«è¯¥è¯çš„æ–‡æ¡£æ•°(df))ã€‚é€†æ–‡æ¡£é¢‘ç‡è¶Šå¤§ï¼Œè¯´æ˜è¿™ä¸ªè¯è¶Šä¸å¸¸è§ï¼Œå¯èƒ½å°±è¶Šé‡è¦ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;TF-IDFå°±æ˜¯å°†è¿™ä¸¤ä¸ªå€¼ç›¸ä¹˜ï¼Œå¾—åˆ°çš„ç»“æœå°±æ˜¯ä¸€ä¸ªè¯çš„æƒé‡ï¼Œè¿™ä¸ªæƒé‡å¯ä»¥ç”¨æ¥è¡¨ç¤ºè¿™ä¸ªè¯å¯¹äºæ–‡æ¡£çš„é‡è¦æ€§ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥æ¯”è¾ƒä¸åŒæ–‡æ¡£çš„ç›¸ä¼¼æ€§ã€‚&lt;/p&gt;

&lt;p&gt;TF-IDFåœ¨å®è·µçš„å‘å±•ä¸­ä¼šå­˜åœ¨ä¸€äº›é—®é¢˜:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ–‡æ¡£é•¿åº¦é—®é¢˜ï¼šåœ¨é•¿æ–‡æ¡£ä¸­ï¼ŒæŸä¸ªè¯å¯èƒ½ä¼šå› ä¸ºæ–‡æ¡£æœ¬èº«çš„é•¿åº¦å°±æœ‰æ›´é«˜çš„å‡ºç°æ¬¡æ•°ï¼Œè€Œä¸æ˜¯å› ä¸ºè¿™ä¸ªè¯å¯¹äºæ–‡æ¡£çš„ä¸»é¢˜æ›´é‡è¦ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´TF-IDFå¯¹é•¿æ–‡æ¡£ä¸­çš„è¯ç»™äºˆè¿‡é«˜çš„æƒé‡ï¼Œè€Œå¿½è§†äº†çŸ­æ–‡æ¡£ä¸­çš„é‡è¦è¯&lt;/li&gt;
  &lt;li&gt;è¯é¢‘ä¸é¥±å’Œï¼šåœ¨å®é™…çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œè¯çš„é‡è¦æ€§å¹¶ä¸æ€»æ˜¯éšç€å®ƒçš„å‡ºç°æ¬¡æ•°çº¿æ€§å¢åŠ çš„ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªè¯åœ¨æ–‡æ¡£ä¸­å‡ºç°100æ¬¡å¯èƒ½å¹¶ä¸æ„å‘³ç€å®ƒæ¯”å‡ºç°10æ¬¡çš„è¯10å€é‡è¦ï¼Œç›¸åï¼Œå¯¹äºIDFè€Œè¨€ï¼Œå¦‚æœä¸€ä¸ªè¯åœ¨æ–‡æ¡£é›†ä¸­å‡ºç°çš„æ¬¡æ•°è¶Šå°‘ï¼Œé‚£ä¹ˆå®ƒçš„IDFå€¼å°±è¶Šé«˜ï¼Œè¢«è®¤ä¸ºè¶Šé‡è¦,ä¹Ÿå¹¶éä¸€å®šç¬¦åˆå®é™…ä¸šåŠ¡åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿™äº›é—®é¢˜éƒ½åœ¨BM25ä¸­å¾—åˆ°äº†æ”¹è¿›ï¼ŒBM25çš„è¯é¢‘éƒ¨åˆ†ä½¿ç”¨äº†ä¸€ä¸ªé¥±å’Œå‡½æ•°ï¼Œä½¿å¾—è¯é¢‘è¾¾åˆ°ä¸€å®šå€¼åï¼Œå¢åŠ è¯é¢‘å¯¹äºæœ€ç»ˆå¾—åˆ†çš„å½±å“ä¼šå˜å°ã€‚åŒæ—¶ï¼ŒBM25è¿˜è€ƒè™‘äº†æ–‡æ¡£é•¿åº¦çš„å½±å“ï¼Œé€šè¿‡ä¸€ä¸ªå½’ä¸€åŒ–å› å­æ¥è°ƒæ•´ä¸åŒé•¿åº¦æ–‡æ¡£ä¸­çš„è¯é¢‘ã€‚è¿™ä½¿å¾—BM25åœ¨å¤„ç†è¯é¢‘æœªé¥±å’Œå’Œæ–‡æ¡£é•¿åº¦é—®é¢˜æ—¶ï¼Œæ¯”TF-IDFæœ‰æ›´å¥½çš„æ€§èƒ½ã€‚&lt;/p&gt;

&lt;p&gt;BM25 çš„è®¡ç®—å…¬å¼ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-2/bm25.png&quot; alt=&quot;BM25&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å’ŒTF-IDFçš„è®¡ç®—å…¬å¼ç›¸æ¯”ï¼ŒBM25çš„å…¬å¼ç€å®æœ‰ç‚¹å“äººï¼Œä¸è¿‡å…¶å®æˆ‘ä»¬å…³æ³¨å‡ ä¸ªæ ¸å¿ƒçš„å‚æ•°å³å¯ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;å¯¹äºBM25ç®—æ³•åœ¨ElasticSearchä¸­çš„åº”ç”¨å…¬å¼å’Œå‚æ•°å˜é‡è¯´æ˜ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« &lt;a href=&quot;https://www.elastic.co/cn/blog/practical-bm25-part-2-the-bm25-algorithm-and-its-variables&quot;&gt;ã€ŠBM25 ç®—æ³•åŠå…¶å˜é‡ã€‹&lt;/a&gt;ï¼Œè¿™é‡Œæˆ‘ä»¬åªå…³å¿ƒå‡ ä¸ªæ ¸å¿ƒçš„å‚æ•°&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;k1&lt;/strong&gt;:æ§åˆ¶éçº¿æ€§é¡¹é¢‘ç‡å½’ä¸€åŒ–ï¼ˆè¯é¢‘é¥±å’Œåº¦ï¼‰ã€‚é»˜è®¤å€¼ä¸º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;1.2&lt;/code&gt; ã€‚è¾ƒä½çš„å€¼å¯¼è‡´è¾ƒå¿«çš„é¥±å’Œï¼Œè¾ƒé«˜çš„å€¼å¯¼è‡´è¾ƒæ…¢çš„é¥±å’Œã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-2/elas_1706.png&quot; alt=&quot;Term frequency saturation for TF/IDF and BM25&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;b&lt;/strong&gt;ï¼šè¯¥å‚æ•°æ§åˆ¶å­—æ®µé•¿åº¦å½’ä¸€åŒ–çš„å½±å“ç¨‹åº¦ã€‚bçš„å€¼åœ¨0åˆ°1ä¹‹é—´ï¼Œå½“bä¸º0æ—¶ï¼Œè¡¨ç¤ºå®Œå…¨ä¸è€ƒè™‘å­—æ®µé•¿åº¦çš„å½±å“ï¼›å½“bä¸º1æ—¶ï¼Œè¡¨ç¤ºå®Œå…¨è€ƒè™‘å­—æ®µé•¿åº¦çš„å½±å“ã€‚é»˜è®¤ä¸º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0.75&lt;/code&gt; ã€‚è¿™ä¸ªå‚æ•°å€¼ä¹Ÿæ˜¯é’ˆå¯¹ä¸Šé¢æˆ‘ä»¬æåˆ°TF-IDFåœ¨æ–‡æ¡£é•¿åº¦æœªè€ƒè™‘çš„æƒ…å†µä¸‹ä¸€ä¸ªåŠ æƒè®¡ç®—ï¼Œå½“ç„¶é»˜è®¤å€¼&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0.75&lt;/code&gt;æ˜¯å®˜æ–¹åŸºäºå¤§é‡çš„æ•°æ®å®éªŒå¾—åˆ°çš„ä¸€ä¸ªå€¼ï¼Œåœ¨é»˜è®¤åœºæ™¯ä¸‹éƒ½ä¼šæœ‰è¾ƒå¥½çš„æ•ˆæœï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨è°ƒæ•´ã€‚å¦‚æœæˆ‘ä»¬çš„é»˜è®¤æ£€ç´¢æ•ˆæœä¸ä½³ï¼Œåº”è¯¥ä»å…¶å®ƒæ–¹é¢æ¥è€ƒè™‘ä¼˜åŒ–ï¼Œè¿™ä¸ªåé¢æˆ‘ä»¬å†è¯´&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;scoreåˆ†å€¼è®¡ç®—æ³¨æ„äº‹é¡¹&quot;&gt;Scoreåˆ†å€¼è®¡ç®—&amp;amp;æ³¨æ„äº‹é¡¹&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;åœ¨ç†è§£äº†ç®—æ³•ã€esä¸­é—´ä»¶ä¹‹åï¼Œç»“åˆå®æˆ˜+Scoreåˆ†å€¼çš„è®¡ç®—ä½¿ç”¨è¿‡ç¨‹ï¼ŒåŒ…æ‹¬é…åˆESçš„Explainæ¥å£ï¼Œè®²æ¸…æ¥šScoreçš„è®¡ç®—è§„åˆ™ï¼ŒåŸç†&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;åœ¨å‰é¢äº†è§£äº†ESçš„æ•´ä¸ªæ£€ç´¢Scoreç®—æ³•ä»‹ç»ä¹‹åï¼Œå…¶å®å¯¹äºæ–‡æœ¬å†…å®¹çš„æ£€ç´¢å¬å›Scoreåˆ†å€¼è®¡ç®—ï¼Œå°±æ¯”è¾ƒæ¸…æ™°äº†ï¼Œå…ˆè¯´ç»“è®ºï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ElasticSearchåœ¨ä½¿ç”¨KNN+BM25æ£€ç´¢çš„æ··åˆæ£€ç´¢åˆ†å€¼Scoreè®¡ç®—å…¬å¼æ˜¯ï¼šknn_score+bm25_score&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨ESæ··åˆæ£€ç´¢çš„è¯­æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;POST&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;image-index/_search&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;query&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;match&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;query&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;mountain lake&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;boost&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;knn&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;å­—æ®µ&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;field&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;image-vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;è¾“å…¥å‘é‡&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;query_vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;54&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;-2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;kå€¼&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;k&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;æ¯ä¸ªåˆ†ç‰‡è¦è€ƒè™‘çš„æœ€è¿‘é‚»å±…å€™é€‰æ•°ã€‚ä¸èƒ½è¶…è¿‡&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;000&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;num_candidates&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;åŠ æƒå‚æ•°å€¼&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;boost&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;æ¡£è¢«è§†ä¸ºåŒ¹é…æ‰€éœ€çš„æœ€å°ç›¸ä¼¼åº¦&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;é…åˆfilterä½¿ç”¨ï¼Œæé«˜æ£€ç´¢æ•ˆç‡&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;similarity&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;è¿‡æ»¤æ¡ä»¶&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;filter&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;term&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;file-type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;png&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;size&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;query&lt;/code&gt;éƒ¨åˆ†çš„æ£€ç´¢æ‰€ä»£è¡¨çš„æ˜¯BM25ç®—æ³•çš„Scoreè®¡ç®—åˆ†å€¼å¬å›ï¼Œè€Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;knn&lt;/code&gt;éƒ¨åˆ†çš„æ£€ç´¢æ‰€ä»£è¡¨çš„åˆ™æ˜¯è¯­ä¹‰å‘é‡ç©ºé—´çš„è·ç¦»Scoreåˆ†å€¼ï¼Œæœ€ç»ˆçš„ç»“æœå€¼ç›¸åŠ åå€’æ’çš„ä¸€ä¸ªæ–‡æ¡£åˆ—è¡¨ç»“æœé›†&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;score=&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;match_score*0.9 + knn_score*0.1&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;bm25çš„score&quot;&gt;BM25çš„Score&lt;/h3&gt;

&lt;p&gt;å¯¹äºBM25ç®—æ³•çš„æ£€ç´¢åˆ†å€¼è®¡ç®—ï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/8.11/search-explain.html&quot;&gt;Explain API&lt;/a&gt;æ¥æŸ¥çœ‹æ•´ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Score&lt;/code&gt;çš„è®¡ç®—è¿‡ç¨‹ï¼Œæ•´ä¸ªè®¡ç®—è¿‡ç¨‹å°±å’ŒBM25ç®—æ³•å…¬å¼é‚£æ ·,å¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-2/image-20231227182031006.png&quot; alt=&quot;å›¾2-BM25ç®—æ³•scoreè§£é‡Šæ¥å£&quot; /&gt;&lt;/p&gt;

&lt;p&gt;BM25ç®—æ³•ä¼šå°†ç”¨æˆ·è¾“å…¥çš„matchå‚æ•°ï¼Œè®¡ç®—æ¯ä¸€ä¸ªåˆ†è¯çš„scoreåˆ†å€¼ï¼Œæœ€ç»ˆåŠ èµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªæ€»çš„åˆ†å€¼scoreæ•°æ®ï¼Œå¯¹äºæ¯ä¸€ä¸ªåˆ†è¯ï¼Œéƒ½å¯ä»¥é€šè¿‡è¯¥æ¥å£æŸ¥çœ‹åˆ°å®Œæ•´çš„è®¡ç®—è¿‡ç¨‹ï¼Œæ˜¯éå¸¸æ–¹ä¾¿çš„å¼€å‘è€…è¿›è¡Œç†è§£çš„ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨è¿™é‡Œè¿›è¡ŒBM25è®¡ç®—æ—¶ï¼Œæˆ‘å‰é¢æåˆ°BM25ç®—æ³•å¯èƒ½å­˜åœ¨æ£€ç´¢ä¸åˆ°æœ€ç»ˆæˆ‘ä»¬è¯´æœŸæœ›çš„æ–‡æœ¬ï¼Œä¼šæœ‰ä¸€äº›å…¶å®ƒå‚æ•°å½±å“æœ€ç»ˆæ•ˆæœï¼Œå¹¶ééœ€è¦æ›´æ”¹ç®—æ³•ä¸­çš„k1å’Œbè¿™ä¸¤ä¸ªå‚æ•°ï¼Œä¸»è¦è€ƒè™‘å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ESæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æœç´¢å’Œåˆ†æå¼•æ“ï¼Œæ•°æ®è¢«åˆ†ä¸ºå¤šä¸ªåˆ†ç‰‡ï¼ˆshardsï¼‰ï¼Œæ¯ä¸ªåˆ†ç‰‡å¯ä»¥åœ¨ä»»ä½•èŠ‚ç‚¹ä¸Šå­˜å‚¨ã€‚è¿™ä½¿å¾—æ•°æ®å¯ä»¥åœ¨å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´è¿›è¡Œåˆ†å¸ƒï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å®¹é‡å’Œæ€§èƒ½ï¼Œæœ€ç»ˆæ•°æ®åœ¨å­˜å‚¨æ„å»ºç´¢å¼•çš„æ—¶å€™ï¼Œesä¼šå‡è¡¡çš„è¿›è¡Œåˆ†å¸ƒå­˜å‚¨ï¼Œè€Œåœ¨å¬å›è®¡ç®—çš„è¿‡ç¨‹ä¸­ï¼Œæ•°æ®ä¹Ÿä¼šä»å„ä¸ªshardsåˆ†ç‰‡è¿›è¡Œå¬å›è®¡ç®—ã€‚å¼€å‘è€…åœ¨åˆ›å»ºç´¢å¼•(index)çš„æ—¶å€™ï¼Œå¯ä»¥è®¾ç½®shardsçš„åˆ†ç‰‡ä¸º1æˆ–è€…3ï¼Œæ¥æŸ¥çœ‹åŒºåˆ«ã€‚&lt;/li&gt;
  &lt;li&gt;esé»˜è®¤æä¾›äº†éå¸¸å¤šçš„tokenizeråˆ†è¯å™¨ï¼Œè€Œå¯¹äºä¸­æ–‡ç”¨æˆ·çš„ä½¿ç”¨è€…æ¥è¯´ï¼Œå“ªäº›è¯è¯¥åˆ†ï¼Œå“ªäº›è¯ä¸è¯¥åˆ†ï¼ŒåŒ…æ‹¬åŒä¹‰è¯çš„å½±å“ç­‰ç­‰ï¼Œéƒ½ä¼šå½±å“æ•´ä¸ªScoreåˆ†å€¼çš„è®¡ç®—ï¼Œåœ¨ç›®å‰esçš„ç”Ÿæ€ä¸­ï¼Œ&lt;a href=&quot;https://github.com/medcl/elasticsearch-analysis-ik&quot;&gt;ikåˆ†è¯å™¨&lt;/a&gt;å¯èƒ½æ˜¯å½“ä¸‹æœ€æˆç†Ÿçš„ä¸€ä¸ªpluginæ’ä»¶ï¼Œikæä¾›äº†ä¸€ä¸ªåŸºç¡€çš„è¯åº“ï¼ŒåŒæ—¶æ”¯æŒçƒ­æ›´æ–°ï¼Œå¯¹äºä¸Šå±‚åº”ç”¨äº§å“çš„è®¾è®¡èåˆï¼Œéå¸¸åˆšéœ€ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;knnçš„score&quot;&gt;KNNçš„Score&lt;/h3&gt;

&lt;p&gt;å¯¹äºKNNçš„æ£€ç´¢åˆ†å€¼è®¡ç®—ï¼Œå°±éå¸¸çš„ç®€å•äº†ï¼Œå¼€å‘è€…åœ¨æ„å»ºç”¨æˆ·ç´¢å¼•çš„æ—¶å€™ï¼Œé€‰æ‹©å…·ä½“çš„å‘é‡è·ç¦»ç±»å‹ï¼Œesåœ¨è®¡ç®—knnçš„æ—¶å€™ï¼Œå°±ä¼šæ ¹æ®å…¶ç®—æ³•è¿›è¡Œè®¡ç®—&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;PUT&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;my-index&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;-2&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;mappings&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;properties&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;my_vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;dense_vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;dims&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;é€‰æ‹©ç±»å‹ï¼Œcosineã€dot_productã€l&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;_norm&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;similarity&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;cosine&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€‰æ‹©ä¸åŒçš„ç±»å‹ï¼Œ å°±æ˜¯å•çº¯çš„å‘é‡è·ç¦»è®¡ç®—äº†ï¼ŒæŒ‰å…¬å¼å¥—ç”¨å°±å¯ä»¥äº†ã€‚&lt;/p&gt;

&lt;p&gt;ä¸è¿‡å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºä½¿ç”¨æœ€å¤šçš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cosine&lt;/code&gt;çš„æ–‡æ¡£ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_score&lt;/code&gt; è®¡ç®—ä¸º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(1 + cosine(query, vector)) / 2&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&quot;ï¸æ³¨æ„äº‹é¡¹&quot;&gt;âš ï¸æ³¨æ„äº‹é¡¹&lt;/h3&gt;

&lt;p&gt;å½“æˆ‘ä»¬ä½¿ç”¨æ··åˆæ£€ç´¢çš„æ—¶å€™ï¼Œæœ‰ä¸€äº›æ³¨æ„äº‹é¡¹å€¼å¾—æˆ‘ä»¬å…³æ³¨ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å¼€å‘è€…åœ¨ä½¿ç”¨Explain APIæ¥å£è¿›è¡Œè°ƒè¯•çš„æ—¶å€™ï¼Œç”±äºKNNçš„åˆ†å€¼æ˜¯å•ç‹¬è®¡ç®—ï¼Œæ‰€ä»¥åœ¨åˆ†æçš„æ—¶å€™ï¼Œä¸èƒ½æœ‰KNNçš„éƒ¨åˆ†&lt;/li&gt;
  &lt;li&gt;KNNæ£€ç´¢çš„å‚æ•°ï¼Œå¯ä»¥é…ç½®å¤šä¸ªknnçš„å‘é‡æŸ¥è¯¢å€¼ï¼Œå¦å¤–&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;filter&lt;/code&gt;è¿‡æ»¤å‚æ•°ä¼šæé«˜æ£€ç´¢çš„æ•ˆç‡ï¼Œä½†æ˜¯æé«˜æ£€ç´¢æ•ˆç‡çš„åŒæ—¶ï¼Œç”±äºæ€»æ˜¯ä¼šè®¡ç®—å¬å›æ–‡æ¡£è¿›è¡Œç›¸ä¼¼åº¦è®¡ç®—ï¼Œæ‰€ä»¥å¯ä»¥é…åˆ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;similarity&lt;/code&gt;æ¥ä¸€èµ·ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;torchväº§å“é©±åŠ¨æ€»ç»“&quot;&gt;TorchVäº§å“é©±åŠ¨&amp;amp;æ€»ç»“&lt;/h2&gt;

&lt;p&gt;å¯¹äºæ··åˆæ£€ç´¢ï¼Œæˆ‘ä»¬åœ¨ç®—æ³•å±‚é¢æœ‰äº†ç›´æ¥çš„äº†è§£åï¼Œæœ€ç»ˆåœ¨äº§å“å±‚é¢ä¼šå½±å“ä¸€äº›è®¾è®¡ã€‚&lt;/p&gt;

&lt;p&gt;1ã€æ··åˆæ£€ç´¢çš„æƒé‡è®¾ç½®ï¼šåœ¨ä¸Šé¢çš„scoreåˆ†å€¼è®¡ç®—å…¬å¼ä¸­ï¼Œæˆ‘ä»¬å…¶å®çŸ¥é“esæœ€ç»ˆæ˜¯é€šè¿‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bm25*boost&lt;/code&gt;+&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;knn*boost&lt;/code&gt;,é‚£ä¹ˆè¿™ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;boost&lt;/code&gt;åˆ™å¯ä»¥å½±å“æˆ‘ä»¬æœ€ç»ˆçš„å†…å®¹ï¼Œå› ä¸ºå¹¶ä¸æ˜¯æ‰€æœ‰çš„å®¢æˆ·å’Œä¸šåŠ¡åœºæ™¯éƒ½é€‚åˆknnæ£€ç´¢ï¼Œå¯èƒ½åœ¨å…¶ä»–å…³é”®çš„åœºæ™¯ä¸­ï¼Œå…³é”®è¯æ£€ç´¢ä¼šæ›´é€‚åˆ(æ¯”å¦‚ä¸€äº›åˆ©ç”¨å¤§æ¨¡å‹åšä¸€äº›å¼‚æ­¥çš„ä»»åŠ¡æå–ï¼ŒæŠ¥å‘Šè¾“å‡ºç­‰ç­‰ä¸šåŠ¡åœºæ™¯)ï¼Œæˆ‘ä»¬åœ¨äº§å“è®¾è®¡ä¸­åˆ™å¯ä»¥æ ¹æ®ä¸åŒçš„å®¢æˆ·è¯‰æ±‚ä»¥åŠä¸šåŠ¡è¯‰æ±‚ï¼Œå°±å¯ä»¥è®¾ç½®è¿™ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;boost&lt;/code&gt;æ¥å½±å“æœ€ç»ˆçš„å¬å›ç»“æœå¤©å¹³ï¼Œä»è€Œæ”¹å–„æˆ‘ä»¬çš„äº§å“æ•ˆæœã€‚&lt;/p&gt;

&lt;p&gt;åœ¨æˆ‘ä»¬çš„TorchVçš„äº§å“è®¾è®¡ä¸­ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;alpha&lt;/code&gt;å‚æ•°å€¼ï¼Œå–å€¼èŒƒå›´åœ¨0-1ä¹‹é—´ï¼Œå…·ä½“æ¥è¯´ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;alpha = 1&lt;/code&gt;ï¼šå®Œå…¨åŸºäºå‘é‡çš„æœç´¢,ä¹Ÿå°±æ˜¯KNNè¿‘é‚»æœç´¢&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;alpha = 0&lt;/code&gt;ï¼šå®Œå…¨åŸºäºå…³é”®è¯çš„æœç´¢ï¼ŒåŸºäºESçš„BM25ç®—æ³•æ£€ç´¢&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;2ã€åœ¨BM25ç®—æ³•çš„åœºæ™¯ä¸­ï¼Œåˆ†è¯æ˜¯éå¸¸é‡è¦çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå¯¹äºä¸åŒçš„è¡Œä¸šå®¢æˆ·ï¼Œè¯åº“çš„æ”¶é›†å»ºç«‹å¯¹äºäº§å“åº”ç”¨çš„æå‡è‚¯å®šæ˜¯ä¼šæœ‰è´¨çš„æå‡ï¼Œä¹Ÿæ˜¯æ¯ä¸ªå…¬å¸åšRAGäº§å“çš„æ ¸å¿ƒç«äº‰åŠ›ã€‚&lt;/p&gt;

&lt;p&gt;3ã€æŒç»­è¿è¥èƒ½åŠ›çš„é‡è¦æ€§ï¼ŒRAGé—®ç­”æ£€ç´¢åŠŸèƒ½åœ¨æŠ€æœ¯æ¶æ„è¿­ä»£ä¼˜åŒ–ä¸Šæ˜¯ä¸€ä¸ªæ–¹é¢ï¼Œä½†æ˜¯è¿è¥èƒ½åŠ›åŒæ ·é‡è¦ï¼Œå“ªæ€•æ˜¯ChatGPT4ï¼Œåœ¨é’ˆå¯¹ç‰¹æ®Šçš„æ•°æ®æ–‡ä»¶ï¼Œå¦‚æœæ•°æ®æ··ä¹±ï¼ŒçŸ¥è¯†åº“è´¨é‡ä¸é«˜ï¼Œé‚£ä¹ˆåŒæ ·å›ç­”å‡†ç¡®ç‡ä¸ä¼šå¾ˆå¥½çš„ï¼Œè¿™åœ¨æˆ‘ä»¬å’Œå®¢æˆ·è¿›è¡Œæ²Ÿé€šäº¤æµçš„åŒæ—¶ï¼Œè™½ç„¶RAGå¯èƒ½ä¼šç»™å®¢æˆ·çœ¼å‰ä¸€äº®çš„æ„Ÿè§‰ï¼Œä½†æ˜¯æŒç»­çš„æå‡ä»–çš„èƒ½åŠ›ï¼Œå‘æŒ¥æ›´å¤§çš„ä½œç”¨ï¼Œäº§å“çš„æŒç»­è¿è¥èƒ½åŠ›æ˜¯å¿…ä¸å¯å°‘çš„ã€‚&lt;/p&gt;

&lt;h2 id=&quot;å‚è€ƒ&quot;&gt;å‚è€ƒ&lt;/h2&gt;

&lt;p&gt;å¥½äº†ï¼Œå…¨æ–‡å®Œ.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://weaviate.io/blog/hybrid-search-explained&quot;&gt;https://weaviate.io/blog/hybrid-search-explained&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Okapi_BM25&quot;&gt;https://en.wikipedia.org/wiki/Okapi_BM25&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://arxiv.org/abs/1603.09320&quot;&gt;https://arxiv.org/abs/1603.09320&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.17/query-dsl-script-score-query.html#vector-functions&quot;&gt;https://www.elastic.co/guide/en/elasticsearch/reference/7.17/query-dsl-script-score-query.html#vector-functions&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://towardsdatascience.com/improving-retrieval-performance-in-rag-pipelines-with-hybrid-search-c75203c2f2f5&quot;&gt;https://towardsdatascience.com/improving-retrieval-performance-in-rag-pipelines-with-hybrid-search-c75203c2f2f5&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.luxiangdong.com/2023/11/06/hnsw/&quot;&gt;https://www.luxiangdong.com/2023/11/06/hnsw/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="å¤§æ¨¡å‹" /><category term="RAGå®è·µ" /><category term="TorchV" /><category term="RAGæ¦‚è¿°" /><category term="RAG" /><category term="å¤§æ¨¡å‹" /><category term="LLM" /><summary type="html">æ¦‚è¿°</summary></entry><entry><title type="html">RAGçš„æ¦‚è¿°</title><link href="http://localhost:4000/2023/12/23/rag-survey/" rel="alternate" type="text/html" title="RAGçš„æ¦‚è¿°" /><published>2023-12-23T00:00:00+08:00</published><updated>2023-12-23T00:00:00+08:00</updated><id>http://localhost:4000/2023/12/23/rag-survey</id><content type="html" xml:base="http://localhost:4000/2023/12/23/rag-survey/">&lt;p&gt;å¾…ç»­â€¦&lt;/p&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="å¤§æ¨¡å‹" /><category term="RAGæ¦‚è¿°" /><category term="RAG" /><category term="å¤§æ¨¡å‹" /><category term="LLM" /><summary type="html">å¾…ç»­â€¦</summary></entry><entry><title type="html">åŸºäºApple MLXæ¡†æ¶çš„M1è®¾å¤‡ä¸Šå¤§æ¨¡å‹å¾®è°ƒå®è·µ</title><link href="http://localhost:4000/2023/12/17/apple-mlx-lora-action/" rel="alternate" type="text/html" title="åŸºäºApple MLXæ¡†æ¶çš„M1è®¾å¤‡ä¸Šå¤§æ¨¡å‹å¾®è°ƒå®è·µ" /><published>2023-12-17T00:00:00+08:00</published><updated>2023-12-17T00:00:00+08:00</updated><id>http://localhost:4000/2023/12/17/apple-mlx-lora-action</id><content type="html" xml:base="http://localhost:4000/2023/12/17/apple-mlx-lora-action/">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h2&gt;

&lt;p&gt;åœ¨ä¸ä¹…å‰è‹¹æœå®˜æ–¹å¼€æºå‘å¸ƒäº†é’ˆå¯¹Apple Silicon èŠ¯ç‰‡ä¼˜åŒ–çš„ MLX æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œè¯¥æ¡†æ¶å¯ä»¥ç®€åŒ–ç ”ç©¶äººå‘˜åœ¨ Macã€iPadã€iPhone å¹³å°è®¾è®¡å’Œéƒ¨ç½²æ¨¡å‹çš„è¿‡ç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;MLXçš„ä¸»è¦ç‰¹æ€§åŒ…æ‹¬ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ç†Ÿæ‚‰çš„API&lt;/strong&gt;ï¼š&lt;strong&gt;MLX&lt;/strong&gt; å…·æœ‰ç´§éš NumPy çš„ Python APIã€‚ MLX è¿˜æ‹¥æœ‰åŠŸèƒ½é½å…¨çš„ C++ APIï¼Œå®ƒä¸ Python API éå¸¸ç›¸ä¼¼ã€‚ MLX å…·æœ‰ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mlx.nn&lt;/code&gt; å’Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mlx.optimizers&lt;/code&gt; ç­‰æ›´é«˜çº§åˆ«çš„åŒ…ï¼Œå…¶ API ç´§å¯†éµå¾ª PyTorchï¼Œä»¥ç®€åŒ–æ„å»ºæ›´å¤æ‚çš„æ¨¡å‹ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¯ç»„åˆå‡½æ•°è½¬æ¢&lt;/strong&gt;ï¼šMLX å…·æœ‰ç”¨äºè‡ªåŠ¨å¾®åˆ†ã€è‡ªåŠ¨çŸ¢é‡åŒ–å’Œè®¡ç®—å›¾ä¼˜åŒ–çš„å¯ç»„åˆå‡½æ•°è½¬æ¢&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æƒ°æ€§è®¡ç®— (Lazy computation)&lt;/strong&gt;ï¼šMLX ä¸­çš„è®¡ç®—æ˜¯æƒ°æ€§è®¡ç®—ã€‚æ•°ç»„ä»…åœ¨éœ€è¦æ—¶æ‰ä¼šå…·ä½“åŒ–&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åŠ¨æ€å›¾æ„å»º&lt;/strong&gt;ï¼šMLX ä¸­çš„è®¡ç®—å›¾é‡‡ç”¨åŠ¨æ€æ„å»ºï¼Œæ›´æ”¹å‡½æ•°å‚æ•°çš„å½¢çŠ¶ä¸ä¼šè§¦å‘ç¼“æ…¢çš„ç¼–è¯‘ï¼Œå¹¶ä¸”è°ƒè¯•ç®€å•ç›´è§‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¤šè®¾å¤‡ï¼š&lt;/strong&gt;å¯ä»¥åœ¨ä»»ä½•æ”¯æŒçš„è®¾å¤‡ä¸Šè¿è¡Œï¼ˆå½“å‰ä¸º CPU å’Œ GPUï¼‰ï¼Œç¡®ä¿ç”¨æˆ·èƒ½å¤Ÿå……åˆ†åˆ©ç”¨ç¡¬ä»¶&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å…·å¤‡ç»Ÿä¸€å†…å­˜ä¼˜åŠ¿&lt;/strong&gt;ï¼šMLX å’Œå…¶ä»–æ¡†æ¶çš„æ˜¾ç€åŒºåˆ«æ˜¯é‡‡ç”¨ç»Ÿä¸€å†…å­˜æ¨¡å‹ã€‚ MLX ä¸­çš„æ•°ç»„ä½äºå…±äº«å†…å­˜ä¸­ï¼Œå¯ä»¥åœ¨ä»»ä½•æ”¯æŒçš„è®¾å¤‡ç±»å‹ä¸Šæ‰§è¡Œ MLX é˜µåˆ—ä¸Šçš„æ“ä½œï¼Œè€Œæ— éœ€ç§»åŠ¨æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é¡¹ç›®åœ°å€ï¼š&lt;a href=&quot;https://github.com/ml-explore/mlx&quot;&gt;https://github.com/ml-explore/mlx&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;è€Œåœ¨ä»Šå¤©çš„Xä¸Šçœ‹åˆ°Appleå¼€å‘è€…åˆ†äº«è¯´å¯ä»¥åœ¨32GBçš„M1è®¾å¤‡ä¸Šä½¿ç”¨MLXæ¡†æ¶å¯¹Mistral 7B(æˆ–è€…llamA)ç­‰æ¨¡å‹è¿›è¡Œå¾®è°ƒ(Fine-tune)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/apple-mlx-lora-action/image-20231216193342777.png&quot; alt=&quot;image-20231216193342777&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;å‡†å¤‡&quot;&gt;å‡†å¤‡&lt;/h2&gt;

&lt;p&gt;çœ‹åˆ°å®˜æ–¹çš„ä¾‹å­ï¼Œæˆ‘çš„ç”µè„‘æ­£å¥½æ˜¯M1 32GBçš„é…ç½®ï¼Œå°±æŠŠä»£ç è·‘æ¥è¯•è¯•çœ‹&lt;/p&gt;

&lt;p&gt;é¦–å…ˆä»£ç ä¸‹è½½ä¸‹æ¥ï¼Œåœ°å€ï¼š&lt;a href=&quot;https://github.com/ml-explore/mlx-examples/tree/main/lora&quot;&gt;https://github.com/ml-explore/mlx-examples/tree/main/lora&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å®‰è£…ä¾èµ–ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pip &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; requirements.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¸‹è½½Mistral-7B(14.48GBå¤§å°)çš„æ¨¡å‹å¹¶è§£å‹&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;curl &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; https://files.mistral-7b-v0-1.mistral.ai/mistral-7B-v0.1.tar
&lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-xf&lt;/span&gt; mistral-7B-v0.1.tar
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å°†ä¸‹è½½ä¸‹æ¥çš„æ¨¡å‹æ–‡ä»¶è¿›è¡Œè½¬æ¢ï¼Œæ‰§è¡Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;convert.py&lt;/code&gt;æ–‡ä»¶, å‘½ä»¤å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# è½¬æ¢å‘½ä»¤&lt;/span&gt;
python convert.py &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;--torch-model&lt;/span&gt; &amp;lt;path_to_torch_model&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;--mlx-model&lt;/span&gt; &amp;lt;path_to_mlx_model&amp;gt;
&lt;span class=&quot;c&quot;&gt;# è½¬æ¢&lt;/span&gt;
python convert.py &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;--torch-model&lt;/span&gt; mistral-7B-v0.1 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;--mlx-model&lt;/span&gt; mistral-7b-v0.1-mlx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¸¤ä¸ªä¸»è¦çš„å‚æ•°:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;torch-model: Mistralæ¨¡å‹çš„ç›®å½•ï¼Œè§£å‹åä¸ºå½“å‰çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mistral-7B-v0.1&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;mlx-model: è¾“å‡ºç›®å½•åç§°ï¼Œè¿™é‡Œå–å&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mistral-7b-v0.1-mlx&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é€šè¿‡å‘½ä»¤è½¬æ¢åï¼Œè½¬æ¢çš„ç›®å½•æ–‡ä»¶ä¼šæœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/apple-mlx-lora-action/image-20231216201202978.png&quot; alt=&quot;image-20231216201202978&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;å¾®è°ƒfine-tune&quot;&gt;å¾®è°ƒ(Fine-tune)&lt;/h2&gt;

&lt;p&gt;å°†æ¨¡å‹ä¸‹è½½è½¬æ¢å®Œæˆåï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥ä½¿ç”¨å®˜æ–¹æä¾›çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lora.py&lt;/code&gt;è¿›è¡Œå¾®è°ƒ(&lt;strong&gt;Fine-tune&lt;/strong&gt;)äº†ï¼Œå…ˆæ¥çœ‹æ•°æ®é›†ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/apple-mlx-lora-action/image-20231216194706972.png&quot; alt=&quot;image-20231216194706972&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è®­ç»ƒçš„æ•°æ®é›†æ˜¯1000è¡Œï¼Œä¸»è¦çš„æ ¼å¼ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;å¾®è°ƒç›®æ ‡æ˜¯å¾—åˆ°ä¸€ä¸ªèƒ½å¤Ÿå°†è‡ªç„¶è¯­è¨€å¥å­è½¬æ¢ä¸ºSQL&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;table: 1-1000181-1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;columns: State/territory, Text/background colour, Format, Current slogan, Current series, Notes&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Q: Tell me what the notes are for South Australia &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;A: SELECT Notes FROM 1-1000181-1 WHERE Current slogan = 'SOUTH AUSTRALIA'&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ•°æ®é›†çš„æ ¼å¼å¾ˆæ¸…æ™°ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;table: è¡¨åç§°
columns: åˆ—åç§°
Q: ç”¨æˆ·é—®é¢˜
A: SQLè¯­å¥
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;è®­ç»ƒ&quot;&gt;è®­ç»ƒ&lt;/h2&gt;

&lt;p&gt;åœ¨ç¬¬ä¸€æ¬¡trainçš„è¿‡ç¨‹ä¸­ï¼Œç›´æ¥ä½¿ç”¨demoä¸­çš„å‘½ä»¤ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python lora.py &lt;span class=&quot;nt&quot;&gt;--model&lt;/span&gt; &amp;lt;path_to_model&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nt&quot;&gt;--train&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nt&quot;&gt;--iters&lt;/span&gt; 600
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¿è¡Œäº†å¤§æ¦‚10åˆ†é’Ÿåï¼Œç¨‹åºå°±å¼‚å¸¸é€€å‡ºäº†ï¼Œæç¤ºå†…å­˜ä¸è¶³ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/apple-mlx-lora-action/image-20231216195734079.png&quot; alt=&quot;image-20231216195734079&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨å£°æ˜å†…å­˜çš„è¿‡ç¨‹ä¸­ï¼Œå‡ºç°äº†å¼‚å¸¸ï¼Œæ— æ³•å¼€è¾Ÿæ–°å†…å­˜ç©ºé—´ï¼Œå¹¶ä¸”æ¯ç§’çš„Tokensæ•°é‡ä¹Ÿå¾ˆæ„ŸäººğŸ˜­&lt;/p&gt;

&lt;p&gt;åœ¨çœ‹äº†å®˜æ–¹çš„é’ˆå¯¹å†…å­˜çš„issueså»ºè®®åï¼Œå‘ç°æœ‰å‡ ä¸ªå‚æ•°æ˜¯å½±å“ç€å†…å­˜ä½¿ç”¨çš„ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;â€“batch-size&lt;/strong&gt;ï¼šå°è¯•é€šè¿‡ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--batch-size&lt;/code&gt; ä½¿ç”¨è¾ƒå°çš„æ‰¹é‡å¤§å°ã€‚ é»˜è®¤å€¼ä¸º 4ï¼Œå› æ­¤å°†å…¶è®¾ç½®ä¸º 2 æˆ– 1 å°†å‡å°‘å†…å­˜æ¶ˆè€—ã€‚ è¿™å¯èƒ½ä¼šå‡æ…¢é€Ÿåº¦ï¼Œä½†ä¹Ÿä¼šå‡å°‘å†…å­˜ä½¿ç”¨ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;â€“lora-layers&lt;/strong&gt;:å°‘å±‚æ•°ä»¥ä½¿ç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--lora-layers&lt;/code&gt; è¿›è¡Œå¾®è°ƒã€‚ é»˜è®¤å€¼ä¸º 16ï¼Œå› æ­¤æ‚¨å¯ä»¥å°è¯• 8 æˆ– 4ã€‚è¿™ä¼šå‡å°‘åå‘ä¼ æ’­æ‰€éœ€çš„å†…å­˜é‡ã€‚ å¦‚æœæ‚¨ä½¿ç”¨å¤§é‡æ•°æ®è¿›è¡Œå¾®è°ƒï¼Œå®ƒè¿˜å¯èƒ½ä¼šé™ä½å¾®è°ƒæ¨¡å‹çš„è´¨é‡ã€‚&lt;/li&gt;
  &lt;li&gt;æ•°æ®é›†ï¼šè¾ƒé•¿çš„ç¤ºä¾‹éœ€è¦æ›´å¤šçš„å†…å­˜ã€‚ å¦‚æœè¿™å¯¹æ‚¨çš„æ•°æ®æœ‰æ„ä¹‰ï¼Œæ‚¨å¯ä»¥åšçš„ä¸€ä»¶äº‹æ˜¯åœ¨åˆ¶ä½œ {train, valid, test}.jsonl æ–‡ä»¶æ—¶å°†ç¤ºä¾‹åˆ†è§£ä¸ºæ›´å°çš„åºåˆ—ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ ¹æ®å®˜æ–¹çš„å»ºè®®ï¼Œé‚£ä¹ˆä¿®æ”¹trainå‚æ•°ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python lora.py &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--model&lt;/span&gt; mistral-7b-v0.1-mlx &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--train&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--batch-size&lt;/span&gt; 1 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--lora-layers&lt;/span&gt; 4
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æŒ‰è¿™ä¸ªå‘½ä»¤æ‰§è¡Œåï¼Œåœ¨æˆ‘çš„M1è®¾å¤‡ä¸Šæ‰§è¡Œçš„è¿˜æ¯”è¾ƒå¿«ï¼Œæ¯ç§’çš„Tokensæ•°é‡å¹³å‡ä¸Š110å·¦å³&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/apple-mlx-lora-action/image-20231216200532260.png&quot; alt=&quot;image-20231216200532260&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è€ŒLossçš„å€¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Iter&lt;/th&gt;
      &lt;th&gt;Loss&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2.265&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;200&lt;/td&gt;
      &lt;td&gt;1.516&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;400&lt;/td&gt;
      &lt;td&gt;1.380&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;600&lt;/td&gt;
      &lt;td&gt;1.350&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;800&lt;/td&gt;
      &lt;td&gt;1.325&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;trainå®Œæˆåï¼Œä¼šåœ¨æœ¬åœ°é»˜è®¤ç”Ÿæˆä¸€ä¸ªæƒé‡æ–‡ä»¶&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;adapters.npz&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;æµ‹è¯•ç»“æœï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python lora.py &lt;span class=&quot;nt&quot;&gt;--model&lt;/span&gt; mistral-7b-v0.1-mlx &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nt&quot;&gt;--adapter-file&lt;/span&gt; adapters.npz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nt&quot;&gt;--num-tokens&lt;/span&gt; 50 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nt&quot;&gt;--prompt&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;table: 1-10015132-16
columns: Player, No., Nationality, Position, Years in Toronto, School/Club Team
Q: What is terrence ross' nationality
A: &quot;&lt;/span&gt;
Loading pretrained model
Total parameters 7243.436M
Trainable parameters 1.704M
Loading datasets
Generating
table: 1-10015132-16
columns: Player, No., Nationality, Position, Years &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;Toronto, School/Club Team
Q: What is terrence ross&lt;span class=&quot;s1&quot;&gt;' nationality
# å¤§æ¨¡å‹è¾“å‡º
A:  SELECT Nationality FROM 1-10015132-16 WHERE Player = '&lt;/span&gt;Terrence Ross&lt;span class=&quot;s1&quot;&gt;' blowing off the rosshill. SELECT Nationality FROM 1-10015
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä»ç»“æœçœ‹ï¼ŒSQLçš„å‰åŠéƒ¨åˆ†å†™å¯¹äº†ï¼Œå¹¶ä¸”ä¹Ÿè¯†åˆ«å‡ºäº†å­—æ®µã€whereæ¡ä»¶ï¼Œä½†æ˜¯åé¢çš„å¥å­å¥½åƒå°±ä¸å¤ªå¯¹äº†&lt;/p&gt;

&lt;p&gt;æˆ‘æ€€ç–‘æ˜¯åœ¨trainæ—¶ï¼Œå‚æ•°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--lora-layers 4&lt;/code&gt;çš„é—®é¢˜ï¼Œè¿™æ—¶ï¼Œæˆ‘å°†æ”¹å‚æ•°æ”¹ä¸º8ï¼Œåœ¨trainä¸€æ¬¡&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python lora.py &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--model&lt;/span&gt; mistral-7b-v0.1-mlx &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--train&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--adapter-file&lt;/span&gt; adapters_2_8_1.npz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--batch-size&lt;/span&gt; 2 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--lora-layers&lt;/span&gt; 8
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è€ŒLossçš„å€¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Iter&lt;/th&gt;
      &lt;th&gt;loss&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2.348&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;200&lt;/td&gt;
      &lt;td&gt;1.392&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;400&lt;/td&gt;
      &lt;td&gt;1.293&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;800&lt;/td&gt;
      &lt;td&gt;1.213&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1000&lt;/td&gt;
      &lt;td&gt;1.233&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ä¹‹åï¼ŒåŒæ ·çš„å‘½ä»¤ï¼Œå†æ¥çœ‹æ•ˆæœï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python lora.py &lt;span class=&quot;nt&quot;&gt;--model&lt;/span&gt; mistral-7b-v0.1-mlx &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nt&quot;&gt;--adapter-file&lt;/span&gt; adapters_2_8.npz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nt&quot;&gt;--num-tokens&lt;/span&gt; 50 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nt&quot;&gt;--prompt&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;table: 1-10015132-16
columns: Player, No., Nationality, Position, Years in Toronto, School/Club Team
Q: What is terrence ross' nationality
A: &quot;&lt;/span&gt;
Loading pretrained model
Total parameters 7243.436M
Trainable parameters 1.704M
Loading datasets
Generating
table: 1-10015132-16
columns: Player, No., Nationality, Position, Years &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;Toronto, School/Club Team
Q: What is terrence ross&lt;span class=&quot;s1&quot;&gt;' nationality
A:  SELECT Nationality FROM 1-10015132-16 WHERE Player = '&lt;/span&gt;Terrence Ross&lt;span class=&quot;s1&quot;&gt;' SELECT Nationality FROM 1-10015132-16 WHERE
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;çœ‹æ•ˆæœå¥½åƒåœ¨SQLè¯­å¥ä¸­ï¼Œæ¯”ä¸Šé¢çš„æ•ˆæœç¨å¾®è¦å¥½ä¸€ç‚¹äº†?ä½†æ˜¯ç»“æœè¿˜æ˜¯ä¸å¯¹ã€‚&lt;/p&gt;

&lt;p&gt;æ•ˆæœå¹¶æ²¡æœ‰è¾¾åˆ°é¢„æœŸï¼Œæˆ‘è§‰å¾—ä¸»è¦æ˜¯å¯èƒ½æœ‰å‡ ä¸ªæ–¹é¢çš„åŸå› ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;è®­ç»ƒæ•°æ®é›†å¤ªå°‘ï¼Œå¯¼è‡´å¤§æ¨¡å‹å¯èƒ½æ— æ³•,train.jsonlä¸­çš„æ•°æ®é›†æ˜¯1000&lt;/li&gt;
  &lt;li&gt;å‚æ•°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--lora-layers &lt;/code&gt;çš„é—®é¢˜ï¼Œé»˜è®¤æ˜¯16ï¼Œè™½ç„¶æˆ‘æœ€åæ”¹æˆäº†8ï¼Œä½†æ˜¯ä»å®˜æ–¹ç»™å‡ºçš„è¯´æ˜æ¥çœ‹ï¼Œè¯¥å‚æ•°ä¼šå½±å“è´¨é‡&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æˆ‘å°†å‚æ•°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--lora-layers &lt;/code&gt;ä¿®æ”¹ä¸º16è¿›è¡Œäº†å°è¯•ï¼Œè·‘ä¸äº†ï¼Œå¯èƒ½è¿˜æ˜¯æˆ‘çš„å†…å­˜å¤ªä½äº†ğŸ˜­ï¼Œé‚£æˆ‘åªèƒ½åŠ æ•°æ®é›†äº†&lt;/p&gt;

&lt;p&gt;ä¿®æ”¹äº†dataç›®å½•ä¸‹çš„wikisql.pyæ–‡ä»¶ï¼Œå°†æ•°æ®é›†ä¸‹è½½æ•´ç†çš„æ€»ä½“æ•°é‡ä¸Šå‡åˆ°10000ï¼Œä»£ç ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;__main__&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;datanames&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;train&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;dev&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sizes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;56355&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8421&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15878&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;datanames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sizes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;WikiSQL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Wrong &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataname&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; set size.&quot;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# Write the sets to jsonl
&lt;/span&gt;    &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;json&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# æ­¤å¤„åŸtrainå‚æ•°æ˜¯1000ï¼Œæˆ‘æ”¹æˆ5000
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;datasets&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;train&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;valid&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datasets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;data/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;.jsonl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;w&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;# Strip the &amp;lt;s&amp;gt;, &amp;lt;/s&amp;gt; since the tokenizer adds them
&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]},&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;fid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¿®æ”¹æ•°æ®é›†åï¼Œåœ¨trainè¿‡åï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„æƒé‡æ–‡ä»¶ï¼Œå‘½ä»¤ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python lora.py &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--model&lt;/span&gt; mistral-7b-v0.1-mlx &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--train&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--adapter-file&lt;/span&gt; adapters_2_8_1.npz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--batch-size&lt;/span&gt; 2 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--lora-layers&lt;/span&gt; 8
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;lossçš„trainè¿‡ç¨‹åˆ†å€¼å˜åŒ–ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Iter&lt;/th&gt;
      &lt;th&gt;loss&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2.348&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;200&lt;/td&gt;
      &lt;td&gt;1.472&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;400&lt;/td&gt;
      &lt;td&gt;1.410&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;600&lt;/td&gt;
      &lt;td&gt;1.387&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;800&lt;/td&gt;
      &lt;td&gt;1.360&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1000&lt;/td&gt;
      &lt;td&gt;1.349&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;å†æ¥çœ‹çœ‹æˆ‘ä»¬çš„promtå¾—åˆ°çš„ç»“æœï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/apple-mlx-lora-action/image-20231217105402278.png&quot; alt=&quot;image-20231217105402278&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä»ç»“æœæ¥çœ‹ï¼ŒSQLè¯­å¥çš„è¯­æ³•å¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆå¤§çš„é—®é¢˜ï¼Œåªæ˜¯ç»“æœæ²¡æœ‰è¾¾åˆ°é¢„æœŸï¼Œå¯èƒ½è¿˜æ˜¯å¾—ä»æ•°æ®é›†åŠç›¸å…³å‚æ•°æ‰¾ä¸€ä¸‹åŸå› ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ç»“è®º&quot;&gt;ç»“è®º&lt;/h2&gt;

&lt;p&gt;è™½ç„¶è¿è¡Œçš„ç»“æœè¿˜æ²¡æœ‰å®Œå…¨è¾¾åˆ°é¢„æœŸï¼Œä½†æ˜¯åœ¨MACä¸Šé€šè¿‡Appleæ¨å‡ºçš„MLXæ·±åº¦å­¦ä¹ æ¡†æ¶è¿›è¡ŒFine-tureçš„æŠ€æœ¯æ–¹æ¡ˆæ˜¯å¯è¡Œçš„ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¹Ÿä¸ºä»¥åå¤§æ¨¡å‹çš„è®­ç»ƒã€ç”Ÿæ€å‘å±•æä¾›äº†å¦å¤–ä¸€ç§å¯èƒ½æ€§ã€‚&lt;/p&gt;

&lt;p&gt;åŒ…æ‹¬æˆ‘ä»¬åº”ç”¨å¼€å‘è€…åœ¨åšRAGçš„è¿‡ç¨‹ä¸­ï¼Œå’Œæ•°æ®è¿›è¡Œå¯¹è¯çš„åœºæ™¯éšç€ä¸šåŠ¡çš„æ·±å…¥è‚¯å®šä¼šè§¦åŠï¼Œè€Œå¯¹æ¨¡å‹è¿›è¡Œå¾®è°ƒæ˜¯ä¸å¯é¿å…çš„ã€‚&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/ml-explore/mlx-examples/tree/main/lora&quot;&gt;https://github.com/ml-explore/mlx-examples/tree/main/lora&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/ml-explore/mlx&quot;&gt;https://github.com/ml-explore/mlx&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://twitter.com/awnihannun/status/1735782998623261071&quot;&gt;https://twitter.com/awnihannun/status/1735782998623261071&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="å¤§æ¨¡å‹" /><summary type="html">å‰è¨€</summary></entry><entry><title type="html">Python3.11åœ¨CentOS7ç¯å¢ƒä¸‹çš„å®‰è£…æŒ‡å®šOpenSSL</title><link href="http://localhost:4000/2023/11/07/centos-python311-install/" rel="alternate" type="text/html" title="Python3.11åœ¨CentOS7ç¯å¢ƒä¸‹çš„å®‰è£…æŒ‡å®šOpenSSL" /><published>2023-11-07T00:00:00+08:00</published><updated>2023-11-07T00:00:00+08:00</updated><id>http://localhost:4000/2023/11/07/centos-python311-install</id><content type="html" xml:base="http://localhost:4000/2023/11/07/centos-python311-install/">&lt;p&gt;å¦‚æœä½ æ˜¯åœ¨CentOS7 ä¸Šé¢æºç å®‰è£…Python3.11ç‰ˆæœ¬ï¼Œä½ å¯èƒ½ä¼šç¢°åˆ°å’Œæˆ‘ä¸€æ ·çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯OpenSSLæ¨¡å—å¤ªä½äº†ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨æºç ç¼–è¯‘å®‰è£…æ—¶ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šOpenSSLé‚£ä¹ˆåœ¨ä½¿ç”¨æ—¶ä¼šå‡ºç°ä¸€äº›å¼‚å¸¸ï¼Œè§£å†³æ–¹æ¡ˆï¼š&lt;/p&gt;

&lt;p&gt;1ã€æ›´æ–°yumè½¯ä»¶åŒ…&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;yum update
yum &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;openssl-devel bzip2-devel libffi-devel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2ã€ä¸‹è½½æœ€æ–°çš„OpenSSLæºç ï¼Œè§£å‹å¹¶ç¼–è¯‘&lt;/p&gt;

&lt;div class=&quot;language-py highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;usr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;src&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;wget&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ftp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;openssl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;org&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;openssl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gz&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;no&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;check&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;certificate&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è§£å‹OpenSSLåŒ…å¹¶å®‰è£…&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# è§£å‹&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-xzvf&lt;/span&gt; openssl-1.1.1q.tar.gz
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;openssl-1.1.1q
&lt;span class=&quot;c&quot;&gt;# ç¼–è¯‘&lt;/span&gt;
./config &lt;span class=&quot;nt&quot;&gt;--prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr &lt;span class=&quot;nt&quot;&gt;--openssldir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/ssl &lt;span class=&quot;nt&quot;&gt;--libdir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lib no-shared zlib-dynamic
make
&lt;span class=&quot;c&quot;&gt;# å®‰è£…&lt;/span&gt;
make &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3ã€éªŒè¯ç‰ˆæœ¬&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; openssl version
OpenSSL 1.1.1q  5 Jul 2022
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; which openssl
/usr/bin/openssl
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;4ã€ä¸‹è½½Pythonçš„æºç åŒ…ï¼Œè§£å‹å¹¶å®‰è£…&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;## è§£å‹&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-xzf&lt;/span&gt; Python-3.11.6.tgz
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;Python-3.11.6
&lt;span class=&quot;c&quot;&gt;# ç¼–è¯‘ï¼ˆæŒ‡å®špython3çš„ç›®å½•å’Œopensslæ¨¡å—ï¼‰&lt;/span&gt;
./configure &lt;span class=&quot;nt&quot;&gt;--prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/mnt/python/python3 &lt;span class=&quot;nt&quot;&gt;--with-openssl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr
&lt;span class=&quot;c&quot;&gt;# å®‰è£…&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;make
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;make &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;5ã€ç”Ÿæˆè½¯é“¾&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ç³»ç»Ÿä¸­å¯èƒ½å·²ç»å­˜åœ¨python3çš„å‘½ä»¤ï¼Œåˆ é™¤é‡æ–°å‘½åå³å¯&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;åœ¨ä¸Šé¢æˆ‘ä»¬æŒ‡å®šå®‰è£…ç›®å½•åœ¨&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/mnt/python/python3&lt;/code&gt;ä¸‹,æ‰€ä»¥å¯ä»¥ç›´æ¥åˆ›å»ºè½¯é“¾&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo ln&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; /mnt/python/python3/bin/python3.11 /usr/bin/python3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;references&quot;&gt;References&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/73407527/installing-ssl-package-with-pip-requires-ssl-package-to-be-already-installed&quot;&gt;Installing SSL package with PIP requires SSL package to be already installed&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="Blog" /><category term="Python" /><summary type="html">å¦‚æœä½ æ˜¯åœ¨CentOS7 ä¸Šé¢æºç å®‰è£…Python3.11ç‰ˆæœ¬ï¼Œä½ å¯èƒ½ä¼šç¢°åˆ°å’Œæˆ‘ä¸€æ ·çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯OpenSSLæ¨¡å—å¤ªä½äº†ã€‚</summary></entry><entry><title type="html">è¶…èµçš„åšå®¢ä¸»é¢˜åˆ†äº«ï¼Œå€¼å¾—ä¸€çœ‹</title><link href="http://localhost:4000/2023/10/16/jekyll-theme-chirpy-share/" rel="alternate" type="text/html" title="è¶…èµçš„åšå®¢ä¸»é¢˜åˆ†äº«ï¼Œå€¼å¾—ä¸€çœ‹" /><published>2023-10-16T00:00:00+08:00</published><updated>2023-10-16T00:00:00+08:00</updated><id>http://localhost:4000/2023/10/16/jekyll-theme-chirpy-share</id><content type="html" xml:base="http://localhost:4000/2023/10/16/jekyll-theme-chirpy-share/">&lt;p&gt;æœ€è¿‘åœ¨å­¦ä¹ RAGã€&lt;a href=&quot;/categories/å¤§æ¨¡å‹/&quot;&gt;å¤§æ¨¡å‹&lt;/a&gt;ç­‰é¢†åŸŸæ–¹é¢çš„æŠ€æœ¯ï¼Œæƒ³åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­åšæ€»ç»“æ€§çš„è¾“å‡ºï¼Œå› æ­¤å°±æƒ³æŠŠè‡ªå·±ä¹‹å‰å¼„çš„åšå®¢é‡æ–°æ•´ç†ä¸€ç•ª,ä¸»è¦æœ‰å‡ ä¸ªåŸå› :&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;åšå®¢ç½‘é¡µæ— æ³•é€‚é…ç§»åŠ¨ç«¯(éå¸¸é‡è¦çš„ä¸€ä¸ªç‰¹æ€§)&lt;/li&gt;
  &lt;li&gt;ä¸»é¢˜æœ‰äº›è…»äº†,æƒ³æ¢ä¸ªæ–°ä¸»é¢˜&lt;/li&gt;
  &lt;li&gt;GitHub Pages &amp;lt;-&amp;gt; åšå®¢ &amp;lt;-&amp;gt; å¾®ä¿¡å…¬ä¼—å· æ•´ä½“é“¾è·¯çš„æ–‡ç« ç¼–å†™å‘å¸ƒé¡ºç•…çš„è¯‰æ±‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åæ¥ï¼Œå°±åŸºäºè‡ªå·±çš„æƒ³æ³•ï¼Œæ•´ç†çš„äº†è¦é‡æ–°æ•´ç†åšå®¢çš„éœ€æ±‚ï¼Œåˆ—äº†ä¸€ä¸ªæ€ç»´å¯¼å›¾ï¼Œå¦‚ä¸‹å›¾:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_build.png&quot; alt=&quot;å›¾1-åšå®¢éœ€æ±‚æ•´ç†&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸»è¦ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢è€ƒè™‘ï¼š&lt;/p&gt;

&lt;h2 id=&quot;1åŸºç¡€æ¡†æ¶&quot;&gt;1.åŸºç¡€æ¡†æ¶&lt;/h2&gt;

&lt;p&gt;è‚¯å®šæ˜¯åŸºäºç›®å‰å·²ç»å¼€æ”¾æµè¡Œçš„åšå®¢æ¡†æ¶è¿›è¡Œæ”¹é€ ,è¿™æ ·èƒ½å¤Ÿå¿«é€Ÿçš„æ­å»ºå®Œæˆ,è€Œä¸”æ— éœ€è€ƒè™‘é¡µé¢å¸ƒå±€çš„æƒ…å†µ&lt;/p&gt;

&lt;p&gt;è¿™é‡Œåˆ—çš„å¤§éƒ¨åˆ†æˆ‘éƒ½æ˜¯ç”¨è¿‡&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://vuepress.vuejs.org/zh/guide/&quot;&gt;VuePress&lt;/a&gt;: Vue é©±åŠ¨çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨,åœ¨å¾ˆæ—©ç»™&lt;a href=&quot;https://doc.xiaominfo.com/v2/&quot;&gt;Knife4j&lt;/a&gt;å†™å¼€æºçš„æŠ€æœ¯æ–‡æ¡£æ—¶å°±ä½¿ç”¨çš„è¿™ä¸ª&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://vitepress.dev/&quot;&gt;VitePress&lt;/a&gt;: åœ¨Viteæ¡†æ¶å‡ºæ¥å,åŸºäºViteç”Ÿæ€ä¸‹çš„é™æ€ç½‘é¡µç”Ÿæˆå™¨ï¼Œæ˜¯ä¸€ä¸ªéå¸¸æ£’çš„ç»„ä»¶ï¼Œé€Ÿåº¦é£å¿«ï¼Œå½“è¿™æ¬¡æˆ‘å¹¶æ²¡æœ‰é€‰æ‹©è¿™ä¸ªã€‚åŸå› åé¢ä¼šè¯´æ˜&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://hexo.io/zh-cn/&quot;&gt;Hexo&lt;/a&gt; :å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶,ä¹Ÿæ˜¯å¾ˆæ—©çš„ä¸€ä¸ªæ¡†æ¶ï¼Œä¸»é¢˜æ ·å¼éå¸¸çš„å¤šï¼Œ&lt;a href=&quot;https://www.luxiangdong.com/&quot;&gt;å‘˜å¤–çš„ç½‘ç«™&lt;/a&gt;å°±ä½¿ç”¨äº†è¿™ä¸ªæ¡†æ¶&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docusaurus.io/&quot;&gt;Docusaurus&lt;/a&gt;: åŸºäºReactæŠ€æœ¯æ ˆçš„ä¸€ä¸ªé™æ€ç½‘ç«™ç”Ÿæˆå™¨ï¼ŒåŒæ ·éå¸¸çš„ä¼˜ç§€ï¼Œç›®å‰&lt;a href=&quot;https://doc.xiaominfo.com/&quot;&gt;Knife4j&lt;/a&gt;çš„å¼€æºæŠ€æœ¯æ–‡æ¡£ç”¨è¿™ä¸ªç¼–å†™&lt;/li&gt;
  &lt;li&gt;ğŸ‘‰ &lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt; : åŸºäºRubyè¯­è¨€ç¼–å†™çš„è€ç‰Œåšå®¢æ¡†æ¶ï¼Œæœ¬æœŸçš„ä¸»è§’&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿™é‡Œé€‰æ‹©&lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt; ä¸»è¦åŸå› æœ‰å‡ ä¸ªï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ä¹‹å‰çš„åšå®¢å°±æ˜¯ç”¨&lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt; æ¥å†™çš„ï¼Œè€Œè¿ç§»åšå®¢æ˜¯ä¸€é¡¹æ¯”è¾ƒç¹æ‚çš„ä»»åŠ¡ï¼Œä¸æƒ³æµªè´¹å¤ªå¤šçš„æ—¶é—´&lt;/li&gt;
  &lt;li&gt;åšå®¢ç½‘ç«™æˆ‘è§‰å¾—&lt;strong&gt;æœ€é‡è¦çš„æ˜¯åœ¨äºä½œè€…çš„åšæŒè¾“å‡º&lt;/strong&gt;ï¼Œä¸»é¢˜åªè¦åŠŸèƒ½æ»¡è¶³è¦æ±‚å³å¯ï¼Œä¸å¿…è¿½æ±‚å¤ªèŠ±å“¨çš„åŠŸèƒ½&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;2é¦–é¡µå†…å®¹&quot;&gt;2.é¦–é¡µå†…å®¹&lt;/h2&gt;

&lt;p&gt;ç¬¬äºŒä¸ªæ–¹é¢è€ƒè™‘çš„å› ç´ æ˜¯é¦–é¡µçš„å†…å®¹ï¼Œåƒ&lt;a href=&quot;https://vuepress.vuejs.org/zh/guide/&quot;&gt;VuePress&lt;/a&gt;å’Œ&lt;a href=&quot;https://vitepress.dev/&quot;&gt;VitePress&lt;/a&gt;é»˜è®¤çš„é¦–é¡µå†…å®¹å…¶å®æ˜¯éå¸¸ç®€æ´çš„ï¼Œæˆ‘è§‰å¾—æ›´é€‚åˆäº§å“çš„å±•ç¤ºï¼Œä¸é€‚åˆåšå®¢ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥èŠ±æ—¶é—´æ”¹é€ ï¼Œæˆ–è€…é€‰æ‹©ä¸€ä¸ªå¾ˆæ£’çš„ä¸»é¢˜è¿›è¡Œæ›¿æ¢ï¼Œè¿™é‡Œä¸»è¦æ˜¯æ—¶é—´ä¸å¤Ÿï¼Œå°±æ²¡æœ‰é€‰æ‹©è¿™ä¸ªï¼Œå¹¶éæ‰€ä»–ä»¬ä¸å¥½ã€‚è€Œæˆ‘æ‰€è€ƒè™‘çš„æ˜¯ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;é¦–é¡µçš„å†…å®¹è¦ä¸»é¢˜é²œæ˜ï¼Œè¯¦ç»†é˜è¿°æ•´ä¸ªç«™ç‚¹å†…å®¹&lt;/li&gt;
  &lt;li&gt;å¤šç¯‡æ–‡ç« åˆ™åˆ†é¡µï¼Œåšå®¢å¿…é¡»å…¨éƒ¨åœ¨é¦–é¡µå±•ç¤ºï¼Œä¸è·³è½¬åˆ°äºŒçº§é¡µé¢&lt;/li&gt;
  &lt;li&gt;å°½å¯èƒ½å¤šçš„å±•ç¤ºå†…å®¹ï¼Œ&lt;strong&gt;é¦–é¡µçš„èµ„æºæ˜¯éå¸¸å®è´µçš„&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä»¥ä¸‹å°±æ˜¯è¯¥åšå®¢çš„é¦–é¡µï¼Œéå¸¸ç¬¦åˆæˆ‘çš„è¯‰æ±‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_index.png&quot; alt=&quot;å›¾2-åšå®¢é¦–é¡µ&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;3åŸºæœ¬åŠŸèƒ½&quot;&gt;3.åŸºæœ¬åŠŸèƒ½&lt;/h2&gt;

&lt;p&gt;æ¥ä¸‹æ¥å°±æ˜¯è€ƒè™‘åšå®¢æ¡†æ¶ä¸€ä¸ªåŸºç¡€çš„åŠŸèƒ½ï¼Œè¿™é‡Œä»ä¸ªäººçš„è¯‰æ±‚ï¼Œåˆ—äº†ä»¥ä¸‹çš„è¦æ±‚ï¼š&lt;/p&gt;

&lt;h3 id=&quot;31-é€‚é…ç§»åŠ¨ç«¯&quot;&gt;3.1 &lt;strong&gt;é€‚é…ç§»åŠ¨ç«¯&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;ç§»åŠ¨ç«¯æ—¶ä»£ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç‰¹æ€§&lt;/strong&gt;ï¼Œæœ‰æ—¶å€™åœ¨å‘å…¬ä¼—å·æ–‡ç« æ—¶å¯ä»¥åœ¨åº•éƒ¨é…ç½®åŸæ–‡é“¾æ¥ï¼Œå¯¹äºè¯»è€…æ¥è¯´å¯ä»¥æ— å·®åˆ«é˜…è¯»&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_mobile.png&quot; alt=&quot;å›¾3-ç§»åŠ¨ç«¯é€‚é…&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;32-ç«™å†…æœç´¢&quot;&gt;3.2 &lt;strong&gt;ç«™å†…æœç´¢&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;å¯ä»¥æä¾›ç«™å†…æœç´¢çš„åŠŸèƒ½ï¼Œä¸ç®¡æ˜¯æ„å»ºæœ¬åœ°åšå®¢ç´¢å¼•è¿˜æ˜¯ä½¿ç”¨å¤–éƒ¨çš„å®ç°ï¼Œä¾‹å¦‚ã€Š&lt;a href=&quot;/posts/knife4j-document-active-search/&quot;&gt;Final.æ¿€æ´»Knife4jå®˜ç½‘çš„æ–‡æ¡£æœç´¢åŠŸèƒ½&lt;/a&gt;ã€‹æåˆ°çš„&lt;a href=&quot;https://www.algolia.com/&quot;&gt;algolia&lt;/a&gt;éƒ½æ˜¯å¯ä»¥çš„&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_search.png&quot; alt=&quot;å›¾4-ç«™å†…æœç´¢&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;33-å½’æ¡£åŠŸèƒ½&quot;&gt;3.3 &lt;strong&gt;å½’æ¡£åŠŸèƒ½&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;ä¸ç®¡æ˜¯åˆ†ç±»è¿˜æ˜¯æ—¥æœŸå½’æ¡£ï¼Œéƒ½æ˜¯å¿…é¡»çš„åŠŸèƒ½&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;åˆ†ç±»å½’æ¡£ï¼šèƒ½å¤Ÿç»™è¯»è€…ä¸€ä¸ªå¿«é€Ÿç´¢å¼•ï¼ŒæŸ¥çœ‹æ„Ÿå…´è¶£çš„å†…å®¹&lt;/li&gt;
  &lt;li&gt;æ—¥æœŸå½’æ¡£: æ ¹æ®æœ€æ–°æ—¥æœŸæŸ¥çœ‹æ›´æ–°çš„ç¯‡å¹…,åŒæ—¶ä¹Ÿæ˜¯å¯¹ä½œè€…çš„ä¸€ä¸ªé­ç­–ï¼Œéå¸¸å®ç”¨&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_arch.png&quot; alt=&quot;å›¾5-å½’æ¡£&quot; /&gt;
&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_arch1.png&quot; alt=&quot;å›¾6-å½’æ¡£1&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;34-è¯„è®ºåŠŸèƒ½&quot;&gt;3.4 &lt;strong&gt;è¯„è®ºåŠŸèƒ½&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;è¯„è®ºç®—æ˜¯ä¸€ä¸ªä¸ªäººè¯‰æ±‚å§,å¹¶éå¼ºåˆ¶ï¼Œå½“ç„¶å¦‚æœæœ‰é»˜è®¤æä¾›é‚£æ›´å¥½ï¼Œæœ¬ç«™ç‚¹åŸºäº&lt;a href=&quot;https://giscus.app/zh-CN&quot;&gt;giscus&lt;/a&gt;å®ç°
&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_comment.png&quot; alt=&quot;å›¾7-è¯„è®º&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;35-æ–‡ç« åˆ†äº«&quot;&gt;3.5 &lt;strong&gt;æ–‡ç« åˆ†äº«&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;å¿«é€Ÿåˆ†äº«åˆ°å„å¤§ç¤¾äº¤å¹³å°ï¼Œéå¸¸å®ç”¨çš„åŠŸèƒ½&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_share.jpg&quot; alt=&quot;å›¾7-åˆ†äº«&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;36-ç«™ç‚¹ç»Ÿè®¡&quot;&gt;3.6 &lt;strong&gt;ç«™ç‚¹ç»Ÿè®¡&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;è¯¥åŠŸèƒ½æˆ‘æƒ³ç›®å‰å„ä¸ªæ¡†æ¶éƒ½æ”¯æŒï¼Œä½¿ç”¨ç™¾åº¦ç»Ÿè®¡æˆ–è€…Google Analyticsåº”è¯¥éƒ½éå¸¸æ–¹ä¾¿&lt;/p&gt;

&lt;h3 id=&quot;37-rss&quot;&gt;3.7 &lt;strong&gt;RSS&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;æ ¹æ®ä¸ªäººå–œå¥½æä¾›&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_feed.jpg&quot; alt=&quot;å›¾8-è¯„è®º&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;4-åšå®¢å¤§çº²&quot;&gt;4. åšå®¢å¤§çº²&lt;/h2&gt;

&lt;p&gt;ä¸ªäººçš„åšå®¢ï¼Œæˆ‘è§‰å¾—æ•´ä½“çš„å¤§çº²å†…å®¹ä¸å¿…å¤ªå¤šï¼Œåªéœ€è¦å…³æ³¨å†™ä½œå†…å®¹å³å¯ï¼Œèƒ½å¤Ÿå°†å†™ä½œå†…å®¹èƒ½å¤Ÿå¿«é€Ÿçš„ç´¢å¼•åˆ°å¹¶ä¸”ç»™è¯»è€…ä¸€ä¸ªæ¸…æ™°çš„ç»“æ„ï¼Œå°±å¯ä»¥äº†&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥æˆ‘çš„åšå®¢å¤§çº²ä¸»è¦æ˜¯å››ä¸ªï¼š &lt;strong&gt;ä¸»é¡µ&lt;/strong&gt;ã€&lt;strong&gt;æ ‡ç­¾&lt;/strong&gt;ã€&lt;strong&gt;å½’æ¡£&lt;/strong&gt;ã€&lt;strong&gt;å…³äº&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;5æ€»ç»“&quot;&gt;5.æ€»ç»“&lt;/h2&gt;

&lt;p&gt;æœ¬ç«™çš„åšå®¢åŸºäº&lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt;çš„&lt;a href=&quot;https://github.com/cotes2020/jekyll-theme-chirpy&quot;&gt;chirpy&lt;/a&gt;ä¸»é¢˜å®ç°ï¼Œè¯¥ä¸»é¢˜æ»¡è¶³äº†åšä¸»çš„æ‰€æœ‰è¯‰æ±‚ï¼Œéå¸¸æ£’ï¼Œå¸Œæœ›ä½ ä¹Ÿèƒ½å¤Ÿå–œæ¬¢!!!&lt;/p&gt;

&lt;p&gt;æœ¬ç«™æºç ï¼š&lt;a href=&quot;https://github.com/xiaoymin/xiaoymin.github.io&quot;&gt;https://github.com/xiaoymin/xiaoymin.github.io&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;åšå®¢é¦–é¡µï¼š&lt;a href=&quot;https://www.xiaominfo.com/&quot;&gt;https://www.xiaominfo.com/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä¸»é¢˜åœ°å€: &lt;a href=&quot;https://github.com/cotes2020/jekyll-theme-chirpy&quot;&gt;https://github.com/cotes2020/jekyll-theme-chirpy&lt;/a&gt;&lt;/p&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="Blog" /><summary type="html">æœ€è¿‘åœ¨å­¦ä¹ RAGã€å¤§æ¨¡å‹ç­‰é¢†åŸŸæ–¹é¢çš„æŠ€æœ¯ï¼Œæƒ³åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­åšæ€»ç»“æ€§çš„è¾“å‡ºï¼Œå› æ­¤å°±æƒ³æŠŠè‡ªå·±ä¹‹å‰å¼„çš„åšå®¢é‡æ–°æ•´ç†ä¸€ç•ª,ä¸»è¦æœ‰å‡ ä¸ªåŸå› :</summary></entry></feed>