<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.3">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2024-04-01T20:37:58+08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">å…«ä¸€èœåˆ€</title><subtitle>å…«ä¸€èœåˆ€çš„ä¸ªäººåšå®¢</subtitle><author><name>è‚–ç‰æ°‘</name></author><entry><title type="html">åˆ›ä¸šï¼šå¤§æ¨¡å‹RAGç³»ç»Ÿä¸‰ä¸ªæœˆçš„å¼€å‘å¿ƒå¾—å’Œæ€è€ƒ</title><link href="http://localhost:4000/2024/04/01/torchv-summary-01/" rel="alternate" type="text/html" title="åˆ›ä¸šï¼šå¤§æ¨¡å‹RAGç³»ç»Ÿä¸‰ä¸ªæœˆçš„å¼€å‘å¿ƒå¾—å’Œæ€è€ƒ" /><published>2024-04-01T00:00:00+08:00</published><updated>2024-04-01T00:00:00+08:00</updated><id>http://localhost:4000/2024/04/01/torchv-summary-01</id><content type="html" xml:base="http://localhost:4000/2024/04/01/torchv-summary-01/">&lt;h1 id=&quot;1-å‰è¨€&quot;&gt;1. å‰è¨€&lt;/h1&gt;

&lt;p&gt;è‡ªä»å’Œ&lt;a href=&quot;https://www.luxiangdong.com/&quot;&gt;å‘˜å¤–&lt;/a&gt;ä»ä¸Šå®¶å…¬å¸ç¦»èŒåï¼Œæˆ‘ä»¬å°±è‡ªå·±æå…¬å¸æŠ•å…¥åˆ°äº†RAGå¤§æ¨¡å‹çš„AIäº§å“åº”ç”¨çš„å¼€å‘ä¸­ï¼Œè¿™ä¸­é—´æœ‰ä¸€ä¸ªæ˜¥èŠ‚ï¼Œå‰åçš„æ€»æ—¶é—´å¤§æ¦‚æ˜¯ä¸‰ä¸ªæœˆå·¦å³ï¼Œåœ¨è¿™ä¸‰ä¸ªæœˆæœŸé—´ï¼ŒåŸºæœ¬æ˜¯æ˜¼å¤œå…¼ç¨‹å•Šï¼Œåˆ°ä»Šå¤©3æœˆåº•ç»“æŸï¼Œäº§å“ç›®å‰çœ‹æ˜¯æœ‰äº†ä¸€ä¸ªåŸºç¡€çš„é›å½¢ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨è¿™æœŸé—´ï¼Œå‘˜å¤–è´Ÿè´£æ•´ä¸ªäº§å“çš„è¥é”€ã€å•†ä¸šå®¢æˆ·çš„æ´½è°ˆç­‰æ–¹é¢çš„å†…å®¹ï¼Œæˆ‘å’Œé˜¿åŒ…è´Ÿè´£æ•´ä½“çš„æŠ€æœ¯æ¶æ„æ­å»ºï¼Œä»£ç ä»0-1çš„ç¼–å†™ï¼Œæˆ‘ä»¬æ˜¯1æœˆåˆçš„æ ·å­ï¼Œäº§å“åˆæ­¥ä¸Šçº¿äº†ä¸€ä¸ªç‰ˆæœ¬ï¼Œå¼€å§‹æ¥å—ä¼ä¸šå®¢æˆ·çš„è¯•ç”¨ï¼Œè¿™è®©æˆ‘ä»¬æ¥å—åˆ°äº†å¤§é‡çš„éœ€æ±‚ï¼Œä»¥åŠæˆ‘ä»¬äº§å“åœ¨ç›®å‰çš„å¸‚åœºç¯å¢ƒä¸­è¿˜å­˜åœ¨å“ªäº›ç«äº‰åŠ›ä¸è¶³éœ€è¦æ”¹è¿›çš„åœ°æ–¹ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‰ä¸ªæœˆæ—¶é—´è¿‡å»äº†ï¼Œåœ¨æˆ‘ä»¬çš„TorchV AI äº§å“åˆæ­¥æˆå‹ä¹‹é™…ï¼Œå’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹å¼€å‘RAGã€LLMç³»ç»Ÿä»¥æ¥çš„ä¸€äº›å¿ƒå¾—å’Œç»éªŒã€‚&lt;/p&gt;

&lt;h1 id=&quot;2-ragç®€ä»‹&quot;&gt;2. RAGç®€ä»‹&lt;/h1&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/summary-01/IMG_7625.jpeg&quot; alt=&quot;å›¾1-RAGåŸºç¡€æ¶æ„&quot; /&gt;&lt;/p&gt;

&lt;p&gt;RAG(æ£€ç´¢å¢å¼ºç”Ÿæˆ)åè¯ä¸€å¼€å§‹æ¥æºäº&lt;strong&gt;2020å¹´&lt;/strong&gt;çš„ä¸€ç‰‡è®ºæ–‡ã€Š&lt;a href=&quot;https://arxiv.org/abs/2005.11401&quot;&gt;Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks&lt;/a&gt;ã€‹ï¼Œæ—¨åœ¨ä¸ºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æä¾›é¢å¤–çš„ã€æ¥è‡ªå¤–éƒ¨çŸ¥è¯†æºçš„ä¿¡æ¯ã€‚è¿™æ ·ï¼ŒLLM åœ¨ç”Ÿæˆæ›´ç²¾ç¡®ã€æ›´è´´åˆä¸Šä¸‹æ–‡çš„ç­”æ¡ˆçš„åŒæ—¶ï¼Œä¹Ÿèƒ½æœ‰æ•ˆå‡å°‘äº§ç”Ÿè¯¯å¯¼æ€§ä¿¡æ¯çš„å¯èƒ½ã€‚&lt;/p&gt;

&lt;p&gt;å¯ä»¥è¯´åœ¨ç›®å‰å¤§æ¨¡å‹äº•å–·çš„ä»Šå¤©ï¼ŒRAGä½œä¸ºä¸€é¡¹ä¸ºå¯†é›†å‹çŸ¥è¯†NLPä»»åŠ¡çš„å¤„ç†æŒ‡æ˜äº†æ–¹å‘ï¼Œé…åˆAIå¤§æ¨¡å‹ï¼Œè®©ä¸–ç•Œå‘ç”Ÿäº†ç¿»å¤©è¦†åœ°çš„å˜åŒ–ï¼Œæ•°ä»¥ä¸‡è®¡çš„å¼€å‘è€…éƒ½æ¶Œå…¥è¿™ä¸ªèµ›é“ï¼ŒåŒæ—¶ç«äº‰ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬çŸ¥é“LLMç›®å‰å­˜åœ¨çš„ä¸€äº›é—®é¢˜å’ŒæŒ‘æˆ˜ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;æˆ‘è‡ªå·±ç†è§£LLMå¤§æ¨¡å‹æœ¬è´¨å°±æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‰€æœ‰çš„çŸ¥è¯†éƒ½é€šè¿‡å‹ç¼©æŠ€æœ¯å…¨éƒ¨å‹ç¼©åœ¨ä¸€ä¸ª/å¤šä¸ªGBçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œæœ€ç»ˆåœ¨è·å–æ•°æ®çš„æ—¶å€™ï¼Œé€šè¿‡LLMçš„æ¨¡å‹æ¶æ„ï¼Œæ¨ç†èƒ½åŠ›ï¼Œå°†æ‰€æœ‰çš„çŸ¥è¯†ä¿¡æ¯åˆç”Ÿæˆå‡ºæ¥ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;åœ¨æ²¡æœ‰ç­”æ¡ˆçš„æƒ…å†µä¸‹æä¾›è™šå‡ä¿¡æ¯(èƒ¡è¯´å…«é“ã€å¹»è§‰)ã€‚&lt;/li&gt;
  &lt;li&gt;æ¨¡å‹çŸ¥è¯†çš„æ›´æ–°æˆæœ¬ã€å‘¨æœŸã€åŠå¤§æ¨¡å‹çš„é€šç”¨èƒ½åŠ›é—®é¢˜ï¼ˆå¤§å…¬å¸æ‰ç©çš„è½¬ï¼‰&lt;/li&gt;
  &lt;li&gt;æ•°æ®å®‰å…¨å’Œéšç§ç­‰é—®é¢˜&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è€ŒRAGæŠ€æœ¯çš„å‡ºç°ï¼Œæ­£å¥½èƒ½æœ‰æ•ˆçš„ç¼“è§£ç›®å‰å¤§æ¨¡å‹å­˜åœ¨çš„ä¸€äº›é—®é¢˜ï¼Œä¸»è¦è¡¨ç°æ–¹é¢å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ç»æµé«˜æ•ˆçš„å¤„ç†çŸ¥è¯†&amp;amp;å¼€ç®±å³ç”¨ï¼šåªéœ€è¦å€ŸåŠ©ä¿¡æ¯æ£€ç´¢&amp;amp;å‘é‡æŠ€æœ¯ï¼Œå°†ç”¨æˆ·çš„é—®é¢˜å’ŒçŸ¥è¯†åº“è¿›è¡Œç›¸å…³æ€§æœç´¢ç»“åˆï¼Œå°±èƒ½é«˜æ•ˆçš„æä¾›å¤§æ¨¡å‹ä¸çŸ¥é“çš„çŸ¥è¯†ï¼ŒåŒæ—¶å…·æœ‰&lt;strong&gt;æƒå¨æ€§&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;æœ‰æ•ˆé¿å…å¹»è§‰é—®é¢˜ï¼šè™½ç„¶æ— æ³•100%è§£å†³å¤§æ¨¡å‹çš„å¹»è§‰é—®é¢˜ï¼Œä½†é€šè¿‡RAGæŠ€æœ¯èƒ½å¤Ÿæœ‰æ•ˆçš„é™ä½å¹»è§‰ï¼Œåœ¨è½¯ä»¶ç³»ç»Ÿä¸­ç»“åˆå¤§æ¨¡å‹æä¾›å¹‚ç­‰çš„APIæ¥å£å°±å¯ä»¥å‘æŒ¥å¤§æ¨¡å‹çš„é‡å¤§ä½œç”¨&lt;/li&gt;
  &lt;li&gt;æ•°æ®å®‰å…¨ï¼šä¼ä¸šçš„æ•°æ®å¯ä»¥å¾—åˆ°æœ‰æ•ˆçš„ä¿æŠ¤,é€šè¿‡ç§æœ‰åŒ–éƒ¨ç½²åŸºäºRAGç³»ç»Ÿå¼€å‘çš„AIäº§å“ï¼Œèƒ½å¤Ÿåœ¨ä½“éªŒAIå¸¦æ¥çš„ä¾¿åˆ©æ€§çš„åŒæ—¶ï¼Œåˆèƒ½é¿å…ä¼ä¸šéšç§æ•°æ®çš„æ³„æ¼ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;3-ragæŠ€æœ¯æ¶æ„æ€è€ƒ&quot;&gt;3. RAGæŠ€æœ¯&amp;amp;æ¶æ„æ€è€ƒ&lt;/h1&gt;

&lt;p&gt;æ—¢ç„¶æˆ‘ä»¬çŸ¥é“ï¼ŒRAGä½œä¸ºå¯†é›†å‹çŸ¥è¯†åº“çš„å¤„ç†å’Œå¤§æ¨¡å‹é…åˆèµ·æ¥æœ‰ç€å¤©ç„¶ä¼˜åŠ¿ï¼Œé‚£ä¹ˆå¦‚ä½•åšå¥½RAGçš„å¼€å‘ï¼Ÿ&lt;/p&gt;

&lt;p&gt;RAGåº”ç”¨çš„&lt;strong&gt;åŸºç¡€æŠ€æœ¯æ ¸å¿ƒ&lt;/strong&gt;æ˜¯ï¼š&lt;strong&gt;è®©å¤§æ¨¡å‹ä¾é ç°æœ‰çš„æ•°æ®(PDF/WORD/Excel/HTMLç­‰ç­‰)ç²¾å‡†çš„å›ç­”ç”¨æˆ·çš„é—®é¢˜&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;è¿™æ˜¯æœ€åŸºç¡€çš„åŠŸèƒ½ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æœ€ä½è¦æ±‚ï¼Œä»»ä½•åšRAGé¢†åŸŸçš„AIåº”ç”¨äº§å“ï¼ŒæŠ€æœ¯å±‚é¢éƒ½éœ€è¦å»çªç ´è§£å†³çš„æŠ€æœ¯éš¾é¢˜ã€‚&lt;/p&gt;

&lt;p&gt;æ³¨æ„&lt;strong&gt;ä¸¤ä¸ªæ ¸å¿ƒ&lt;/strong&gt;ç‚¹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ğŸ“ &lt;strong&gt;ä¾èµ–ç°æœ‰çš„çŸ¥è¯†åº“&lt;/strong&gt;ï¼šä¾èµ–å®¢æˆ·æœ¬èº«çš„æ•°æ®æ˜¯ä¸ºäº†ç»™å¤§æ¨¡å‹æä¾›å¼ºæœ‰åŠ›çš„æ•°æ®æ”¯æ’‘,&lt;strong&gt;é¿å…å¤§æ¨¡å‹èƒ¡è¯´å…«é“&lt;/strong&gt;,ä¼ä¸šç§æœ‰çš„æ•°æ®å¤§æ¨¡å‹å¹¶æ²¡æœ‰å°†æ•°æ®çº³å…¥æ¨¡å‹è¿›è¡Œè®­ç»ƒ,æ‰€ä»¥å¤§æ¨¡å‹å¯¹äºä¼ä¸šç§æœ‰çš„æ•°æ®åŠç›¸å…³é—®é¢˜,å¤§æ¨¡å‹ä¸å¯èƒ½çŸ¥é“ï¼Œå³ä½¿å¤§æ¨¡å‹èƒ½å›ç­”ä½ è¿™ä¸ªé¢†åŸŸçš„é—®é¢˜ï¼Œé‚£ä¹Ÿæ˜¯å› ä¸ºä½ è¿™ä¸ªé—®é¢˜åœ¨å¤§æ¨¡å‹è®­ç»ƒçš„æ•°æ®é›†ä¸­æ—©å°±å­˜åœ¨äº†ï¼Œè€Œä¸”æ˜¯å…¬å¼€çš„æ•°æ®é›†å’Œé—®é¢˜ï¼Œè€Œ&lt;strong&gt;ä¼ä¸šç§æœ‰çš„æ•°æ®(è´¢åŠ¡æŠ¥å‘Šã€éšç§æ•°æ®ç­‰)å¤§æ¨¡å‹æ˜¯ä¸å¯èƒ½æ‹¥æœ‰çš„&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;ğŸ¹ &lt;strong&gt;ç²¾å‡†å‘½ä¸­å›ç­”&lt;/strong&gt;ï¼šä¸€æ—¦å®¢æˆ·å°†è‡ªå·±çš„ç§æœ‰æ•°æ®ä¸Šä¼ äº†ä¹‹å,æˆ‘ä»¬è¦åšçš„å°±æ˜¯ä¾é æ­¤æ•°æ®&lt;strong&gt;ç²¾å‡†å›ç­”ç”¨æˆ·çš„é—®é¢˜&lt;/strong&gt;ï¼Œè€Œè¦åšåˆ°ç²¾å‡†å›ç­”å‘½ä¸­,æŠ€æœ¯äººå‘˜éœ€è¦åšå¤šæ–¹é¢çš„åŠªåŠ›ğŸ’ªã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æŠ€æœ¯äººå¯¹äºRAGåº”ç”¨è€ƒè™‘çš„æœ€æ ¸å¿ƒçš„å°±æ˜¯è¿™ä¸¤ç‚¹ï¼Œè€ŒæŠ€æœ¯æµ‹ä¸ºäº†è¦å®ç°è¿™ä¸€ä¸ª&lt;strong&gt;ç›®æ ‡&lt;/strong&gt;ï¼Œå…¶è¦†ç›–çš„çŸ¥è¯†é¢ä»¥åŠæŠ€æœ¯éš¾åº¦éƒ½æ˜¯éå¸¸å¤§çš„ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘å¾ˆæ—©ä¹‹å‰å‚è€ƒå¤§æ¨¡å‹çš„æŠ€æœ¯æ¶æ„å‘å±•ï¼Œä¸ºRAGç”»äº†ä¸€å¼ ç±»ä¼¼çš„å›¾ï¼Œå¦‚ä¸‹ï¼š&lt;img src=&quot;/assets/images/rag/torchv/summary-01/image-20240330154925101.png&quot; alt=&quot;å›¾2-RAGå‘å±•æ¶æ„æ ‘&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è¿™é‡Œé¢æˆ‘ä¸ºåšRAGç³»ç»Ÿçš„æ€»ç»“ä¸ºä¸‰é¢—æ ‘ï¼ŒLLMå¤§æ¨¡å‹æ˜¯åœŸå£¤ï¼Œä¸»è¦ä¸ºï¼š&lt;strong&gt;æ•°æ®å·¥ç¨‹&lt;/strong&gt;ã€&lt;strong&gt;æ£€ç´¢ç”Ÿæˆ&lt;/strong&gt;ã€&lt;strong&gt;ä¸šåŠ¡ç³»ç»Ÿ&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;è¿™é‡Œé¢å¹¶æ²¡æœ‰æŠŠå¯¹æ¨¡å‹çš„å¾®è°ƒæ”¾å…¥è¿›æ¥ï¼Œå½“æˆ‘ä»¬æŠŠåŸºç¡€å·¥ç¨‹åšåˆ°80åˆ†åï¼Œä¹Ÿè®¸å¯¹Embeddingæ¨¡å‹ã€Chatæ¨¡å‹ç­‰å¾®è°ƒå·¥ä½œä¼šåŠ å…¥è¿›æ¥ï¼Œé’ˆå¯¹ç‰¹å®šçš„ä¸šåŠ¡åœºæ™¯åšä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;æ•°æ®å·¥ç¨‹:&lt;/strong&gt; çŸ¥è¯†åº“çš„å½¢å¼ä¸°å¯Œå¤šå½©,è¿™å…¶ä¸­é…åˆRAGæˆ‘ä»¬è¦åšçš„äº‹æƒ…éå¸¸å¤šï¼ŒåŒ…æ‹¬æ–‡ä»¶ç±»å‹ã€æ ¼å¼ã€åˆ†å‰²ç­–ç•¥ã€çŸ¥è¯†ç±»å‹ã€ç´¢å¼•æ–¹å¼ç­‰ç­‰&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ£€ç´¢ç”Ÿæˆ:&lt;/strong&gt;å½“æˆ‘ä»¬å¤„ç†å®Œæˆæ•°æ®åï¼Œé…åˆå¤§æ¨¡å‹éœ€è¦è¿›è¡Œæ£€ç´¢ç”Ÿæˆï¼Œè€Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒåŒ…æ‹¬ï¼šPromptå·¥ç¨‹ã€ç®—æ³•ç­–ç•¥ã€æ£€ç´¢æ–¹å¼ã€ä¸­é—´ä»¶ã€å¤§æ¨¡å‹ã€æŸ¥è¯¢å¤„ç†ç­‰å†…å®¹&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä¸šåŠ¡ç³»ç»Ÿ&lt;/strong&gt;: è¿™æ˜¯é…åˆå•†ä¸šè¡Œä¸ºæ‰€è¡ç”Ÿçš„ä¸šåŠ¡ç³»ç»Ÿ&amp;amp;ä¸Šå±‚äº§å“åº”ç”¨ï¼ŒåŒ…æ‹¬ç§Ÿæˆ·ã€è®¡è´¹ã€å¼€æ”¾å¹³å°ã€æ´å¯Ÿã€è¿è¥ç­‰ä¸šåŠ¡ç³»ç»Ÿï¼Œè¿™äº›ä¸šåŠ¡ç³»ç»Ÿåœ¨TorchV AIçš„äº§å“ä½“ç³»éƒ½ä¸€ä¸€ä½“ç°&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é€šè¿‡ä¸Šé¢çš„å›¾ï¼Œæˆ‘ä»¬å¤§æ¦‚å°±èƒ½çŸ¥é“ï¼Œ&lt;strong&gt;RAG+LLMå¤§æ¨¡å‹ç³»ç»Ÿçš„äº§å“å¼€å‘ï¼Œæ˜¯ä¸€ä¸ªç»¼åˆæ€§éå¸¸å¼ºçš„å·¥ä½œå†…å®¹ï¼Œè¿™å°±å’Œå¤§æ¨¡å‹çš„è®­ç»ƒä¸€æ ·ï¼Œæ•´ä¸ªå·¥ç¨‹åºå¤§ç¹æ‚ï¼Œæ˜¯ä¸€ä¸ªç³»ç»Ÿæ€§å·¥ç¨‹&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœæˆ‘ä»¬æŠŠä¸‰é¢—æ ‘ä¸­çš„æ¯ä¸€é¡¹éƒ½ä½œä¸ºä¸€ä¸ªæŠ€æœ¯å› å­ï¼Œä¸åŒçš„æ­¥éª¤å¤„ç†ä¼˜åŒ–ï¼Œéƒ½ä¼šå½±å“ç€æœ€ç»ˆå¤–éƒ¨çš„å•†ä¸šçš„å½±å“åŠ›ï¼Œè¿™å°±ä¼šäº§ç”Ÿé‡å˜åˆ°è´¨å˜çš„è½¬å˜ã€‚&lt;/p&gt;

&lt;p&gt;å‡è®¾ï¼š&lt;strong&gt;æˆ‘ä»¬æŠŠæ•°æ®å·¥ç¨‹å’Œæ£€ç´¢å·¥ç¨‹æ‰€æœ‰çš„æ­¥éª¤åœ¨æŠ€æœ¯å±‚é¢æå‡äº†10%ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨å’ŒåŒç±»ç«å“å»ç«äº‰æ—¶ï¼Œæˆ‘ä»¬çš„ä¼˜åŠ¿æ˜¯å¤šå¤§å‘¢ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;31-æ•°æ®å·¥ç¨‹&quot;&gt;3.1 æ•°æ®å·¥ç¨‹&lt;/h2&gt;

&lt;p&gt;åœ¨å¤§æ¨¡å‹åœˆå­é‡Œï¼Œç»å…¸åè¨€ï¼š&lt;strong&gt;Garbage in and garbage out&lt;/strong&gt;ï¼Œæ„æ€æ˜¾è€Œæ˜“è§ï¼Œä½ ç»™å¤§æ¨¡å‹é€çš„æ•°æ®è´¨é‡è¶Šé«˜ï¼Œé‚£ä¹ˆå¤§æ¨¡å‹çš„å“åº”å›ç­”æ•ˆæœå°±è¶Šå¥½ï¼Œåä¹‹ï¼Œå¦‚æœä½ ä¸¢åƒåœ¾ç»™å¤§æ¨¡å‹ï¼Œé‚£ä¹ˆå¤§æ¨¡å‹ä¹Ÿä¼šç»™ä½ è¿”å›åƒåœ¾ï½&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥ä»è¿™ç‚¹æ¥çœ‹ï¼Œä¸Šå±‚çš„åº”ç”¨å¼€å‘è€…ï¼Œè¦åšå¥½çŸ¥è¯†åº“ç±»å‹çš„äº§å“ï¼Œ&lt;strong&gt;æ•°æ®å·¥ç¨‹&lt;/strong&gt;ç»å¯¹æ˜¯ç¬¬ä¸€é“æ‹¦è·¯è™ï¼Œä»æ•°æ®é›†çš„ä¸åŒé¢†åŸŸè¿›è¡Œåˆ†ç±»,ç›®å‰å­˜åœ¨éå¸¸å¤šçš„æ•°æ®æ ¼å¼&lt;/p&gt;

&lt;p&gt;è¿™é‡Œé¢åŒ…å«çš„å¤šç§ä¸åŒçš„æŒ‘æˆ˜&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å¸¸è§æ–‡ä»¶è§£æ&lt;/strong&gt;ï¼šåŸºäºæ–‡ä»¶ç±»å‹çš„æ•°æ®é›†æ˜¯æœ€å¸¸è§çš„,ä¹Ÿæ˜¯ä½¿ç”¨æœ€å¹¿çš„,ä¾‹å¦‚(PDF/WORD/Excel/CSV/Html/Markdown)ç­‰æ ¼å¼&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å…³ç³»å‹/NoSQLæ•°æ®åº“&lt;/strong&gt;: ç”¨æˆ·çš„æ•°æ®å…¨éƒ¨å­˜å‚¨åœ¨æ•°æ®åº“ä¸­é—´ä»¶ä¸­ï¼Œä¾‹å¦‚MySQL/Postgresç­‰ï¼ŒNoSQLæ•°æ®åº“ä¸­ï¼Œè¿™ç§æ•°æ®æºçš„æå–åˆ°æ˜¯ä¸éš¾ï¼Œå¼€å‘è€…åªéœ€è¦æ ¹æ®ä¸åŒçš„æ•°æ®åº“æ ‡å‡†åè®®è¿›è¡Œå¯¹æ¥æŠ½å–å³å¯ï¼Œè¦åšçš„æ˜¯é€‚é…ä¸åŒçš„æ•°æ®åº“ç±»å‹&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç½‘ç»œæ•°æ®é›†&lt;/strong&gt;ï¼šå¯¹äºç½‘ç»œæ•°æ®é›†çš„å¤„ç†ï¼Œé‚£ä¹ˆå°±éœ€è¦å¼€å‘è€…ç²¾é€šçˆ¬è™«ä¹‹é“,è€Œç½‘ç»œä¸Šçš„æ•°æ®é›†ç§ç±»ä¹Ÿæ˜¯éå¸¸å¹¿çš„ï¼Œæ™®é€šçš„W3Cç½‘é¡µ(æ ¼å¼ç§ç±»å¤æ‚ç¹å¤š)ï¼Œè§†é¢‘ã€éŸ³é¢‘ç­‰ç­‰ä¿¡æ¯&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä¸åŒç±»å‹çš„æ•°æ®æå–ï¼š&lt;/strong&gt;åŒ…æ‹¬æ–‡æœ¬ã€å›¾ç‰‡ã€è¡¨æ ¼ã€è§†é¢‘ç­‰ï¼Œå•å•ä¸€ä¸ªè¡¨æ ¼æ•°æ®çš„åœ¨ä¸åŒçš„æ–‡ä»¶æ ¼å¼çš„å¤„ç†ï¼Œå°±éœ€è¦èŠ±è´¹å¤§é‡çš„ç²¾åŠ›å»ä¼˜åŒ–&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æå–æ–¹å¼çš„ç±»åˆ«&lt;/strong&gt;ï¼šä¼ ç»Ÿçš„è½¯ä»¶å·¥ç¨‹ã€OCRã€å¤§æ¨¡å‹ç­‰ç­‰&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åˆ†å‰²ç­–ç•¥&lt;/strong&gt;ï¼šåˆ†å‰²ç­–ç•¥åœ¨RAGçš„æŠ€æœ¯ä½“ç³»ä¸­æœ‰ç€ä¸¾è¶³è½»é‡çš„åœ°ä½,åˆ†å‰²çš„ä¸å¥½ï¼Œä¼šåœ¨ä¿¡æ¯æ£€ç´¢(IR)çš„è¿‡ç¨‹ä¸­ä¸¢å¤±è¯­ä¹‰ï¼ŒåŒ…æ‹¬ï¼šè¯­ä¹‰åˆ†å‰²ã€å¤§æ¨¡å‹åˆ†å‰²ã€æŒ‰å›ºå®šTokenåˆ†å‰²ã€æ–‡æ¡£ç»“æ„åˆ†å‰²ç­‰ç­‰&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Embeddingç´¢å¼•æ„å»ºï¼š&lt;/strong&gt;é™¤äº†ç»™æ¯ä¸€ä¸ªchunkå—æ„å»ºå‘é‡ç´¢å¼•ï¼Œå…ƒæ•°æ®ã€æ ‡é¢˜ã€æ¦‚è¦æ€»ç»“ç­‰ç­‰ä¹Ÿä¼šå¯¹ç³»ç»Ÿå‡†ä¸å‡†æœ‰ä¸åŒçš„è¦æ±‚ï¼ŒåŒæ—¶è¿˜è¦å’Œä¸Šå±‚çš„ä¸šåŠ¡è¿›è¡Œç»“åˆã€‚&lt;/li&gt;
  &lt;li&gt;Moreâ€¦&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨æ•°æ®å·¥ç¨‹è¿™æ£µæ ‘ä¸Šï¼Œæ‰€æœ‰çš„æŠ€æœ¯å‘å±•éƒ½ä¸æ˜¯åœæ»ä¸å‰çš„ï¼Œè¿™é‡Œä»…ä»…åªæ˜¯åˆ—äº†ä¸€äº›åŸºç¡€çš„æ ‘æï¼Œæˆ‘ç›¸ä¿¡åœ¨å¤§æ¨¡å‹AIäº•å–·çˆ†å‘çš„ä»Šå¤©ï¼Œä¼šæ›´å¿«æ¨è¿›æ•°æ®å·¥ç¨‹(ETL)çš„å‘å±•ã€‚&lt;/p&gt;

&lt;h2 id=&quot;32-æ£€ç´¢ç”Ÿæˆ&quot;&gt;3.2 æ£€ç´¢ç”Ÿæˆ&lt;/h2&gt;

&lt;p&gt;å½“æˆ‘ä»¬æŠŠæ‰€æœ‰çš„çŸ¥è¯†æ•°æ®å¤„ç†å®Œæ¯•ï¼Œå€ŸåŠ©å¤§æ¨¡å‹æ¥æ„å»ºä¸€ä¸ªChatç³»ç»Ÿæ—¶ï¼Œä¿¡æ¯æ£€ç´¢æŠ€æœ¯åˆ™æ˜¯å¿…ç„¶è¦ç”¨åˆ°çš„&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ä»è¿™é‡Œæˆ‘ä»¬å¥½åƒå‘ç°ï¼ŒåšRAGï¼Œæ— éå°±æ˜¯åšæœç´¢?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;åœ¨ç›®å‰çš„RAGæ£€ç´¢çš„æŠ€æœ¯ä½“ç³»ä¸­ï¼Œæœ€æ™®éçš„æ— éä¸¤ç§ï¼šå…³é”®è¯å’Œå‘é‡è¯­ä¹‰æ£€ç´¢&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å…³é”®è¯æ£€ç´¢ï¼šåŸºäºç±»ä¼¼BM25è¿™ç±»è¯é¢‘å€’æ’æŠ€æœ¯ï¼Œé€šè¿‡ç»Ÿè®¡å…³é”®è¯çš„æ–¹å¼æ¥æ‰§è¡Œæœç´¢ï¼Œç¼ºç‚¹æ˜¯æ— è¯­ä¹‰ä¿¡æ¯&lt;/li&gt;
  &lt;li&gt;å‘é‡è¯­ä¹‰æ£€ç´¢ï¼šé€šè¿‡å°†æ‰€æœ‰çŸ¥è¯†ç‰‡æ®µé€šè¿‡BERTç­‰é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹è¿›è¡Œè¡¨å¾æå–ï¼Œè¡¨ç¤ºä¸ºå¤šç»´çš„å‘é‡æ•°æ®ï¼Œé€šè¿‡KNN/ANNç®—æ³•æœç´¢è·å–ç»“æœã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å½“ç„¶ï¼Œåœ¨ç›®å‰çš„å¾ˆå¤šå‘é‡æ•°æ®åº“ä¸­é—´ä»¶ä¸­ï¼Œè¿™ä¸¤ç±»æ£€ç´¢å¼•æ“éƒ½å¾—åˆ°äº†æ”¯æŒï¼Œæˆ–è€…æ˜¯æ··åˆæ£€ç´¢ä¹Ÿæ˜¯ä¸€ç§é‡è¦çš„æŠ€æœ¯æ‰‹æ®µã€‚&lt;/p&gt;

&lt;p&gt;åœ¨æ•´ä¸ªæ£€ç´¢ç”Ÿæˆçš„è¿‡ç¨‹ä¸­ï¼Œè¿™æ£µæ ‘åŒæ ·å…³æ³¨çš„æŠ€æœ¯ç»†èŠ‚ä¹Ÿéå¸¸çš„å¤šï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Promptå·¥ç¨‹&lt;/strong&gt;ï¼šå’Œå¤§æ¨¡å‹å¯¹è¯ï¼ŒæŠ€æœ¯äººå‘˜å¿…é¡»æŒæ¡çš„Promptå·¥ç¨‹ï¼Œé€šè¿‡FewShotã€CoTã€ZeroShotç­‰æŠ€æœ¯ï¼Œé’ˆå¯¹ä¸åŒçš„ä¸šåŠ¡åœºæ™¯èƒ½å‘æŒ¥é‡å¤§çš„ä½œç”¨ï¼Œå¼€å‘äººå‘˜éœ€è¦æ ¹æ®å…·ä½“çš„ä¸šåŠ¡åœºæ™¯æ¥è°ƒè¯•ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å’Œå¤§æ¨¡å‹å¯¹æ¥ï¼Œ&lt;strong&gt;è§£å†³å¹‚ç­‰æ€§&lt;/strong&gt;çš„é‡è¦æ‰‹æ®µ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;LLMå¤§æ¨¡å‹&lt;/strong&gt;ï¼šglm3/4ã€ç™¾å·ã€åƒé—®ã€æœˆä¹‹æš—é¢ã€gpt3.5ã€gpt4ç­‰ç­‰å¤§æ¨¡å‹ï¼Œåœ¨ä¸åŒçš„åœºæ™¯ã€èƒ½åŠ›å„æœ‰ä¾§é‡ï¼Œè¿›è¡Œæ·±åº¦çš„ä¸šåŠ¡è°ƒè¯•/é€‚é…åŒæ ·é‡è¦ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ£€ç´¢å¬å›è¿‡ç¨‹å¤„ç†&lt;/strong&gt;ï¼šå¤šè½®å¯¹è¯ã€æŸ¥è¯¢é‡å†™ã€å¤šè·³ã€å¤šè·¯å¬å›ã€å­æŸ¥è¯¢ç­‰ç­‰ï¼Œä¼´éšä¸šåŠ¡åœºæ™¯çš„æ·±å…¥ï¼Œæ¯ä¸€ä¸ªChainçš„ç¯èŠ‚ä¿è¯ç¨³å®šå¯é ï¼Œä¸æ˜¯è½»æ¾çš„äº‹&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä¸­é—´ä»¶&lt;/strong&gt;ï¼šç³»ç»Ÿç¨³å®šé«˜å¯ç”¨ã€å¯æ‰©å±•ç¦»ä¸å¼€ä¸­é—´ä»¶çš„æ”¯æŒï¼Œå¦‚ç¼“å­˜ã€æ¶ˆæ¯é˜Ÿåˆ—ã€å‘é‡æ•°æ®åº“ã€å›¾æ•°æ®åº“ç­‰ç­‰éƒ½æ˜¯å¿…ä¸å¯å°‘çš„&lt;/li&gt;
  &lt;li&gt;More:â€¦.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨æ£€ç´¢ç”Ÿæˆçš„è¿™æ£µæ ‘ä¸Šï¼Œå’Œæ•°æ®å·¥ç¨‹å¯†åˆ‡é…åˆä¸å¯åˆ†å‰²ï¼Œéƒ½æ˜¯åœ¨é™ä½å¤§æ¨¡å‹å¹»è§‰çš„é“è·¯ä¸Šæ·±æŒ–æŠ€æœ¯ç»†èŠ‚ã€‚&lt;/p&gt;

&lt;h1 id=&quot;4-æŠ€æœ¯äº§å“é¢†å¯¼é©±åŠ¨å•†ä¸šçš„å‘å±•&quot;&gt;4. æŠ€æœ¯&amp;amp;äº§å“é¢†å¯¼é©±åŠ¨å•†ä¸šçš„å‘å±•&lt;/h1&gt;

&lt;p&gt;åšRAGè¿™ç±»AIåº”ç”¨å¼€å‘ä»¥æ¥ï¼Œæ„Ÿå—æœ€æ·±çš„æ˜¯å’Œä¹‹å‰åšé¡¹ç›®å¹¶ä¸ç›¸åŒï¼Œä¸€æ–¹é¢æ˜¯æŠ€æœ¯æ ˆå‘å±•è¾ƒæ–°ï¼Œæ–°æŠ€æœ¯å¸¦æ¥çš„æŠ€æœ¯å˜é©ï¼Œéœ€æ±‚å±‚å‡ºä¸ç©·ï¼Œå¦å¤–ï¼Œç›®å‰çš„AIåº”ç”¨ï¼Œæˆ‘è§‰å¾—æ›´å¤šçš„æ˜¯&lt;strong&gt;æŠ€æœ¯&amp;amp;äº§å“æ¥é¢†å¯¼é©±åŠ¨å•†ä¸šçš„å‘å±•&lt;/strong&gt;ï¼Œè¿™å’Œæ™®é€šè½¯ä»¶ä¼ä¸šçš„å¼€å‘æµç¨‹æˆ–è®¸æœ‰æ‰€ä¸åŒã€‚å¾ˆå¤šåšé¡¹ç›®é›†æˆçš„å…¬å¸ï¼Œåšçš„é¡¹ç›®æœªå¿…æ˜¯æœ‰ä»·å€¼çš„ï¼Œå¯èƒ½é”€å”®äººå‘˜åªéœ€è¦æå®šæŸä¸ªé¡¹ç›®éå¸¸é‡è¦çš„äººï¼Œé¡¹ç›®å°±æ‹¿ä¸‹äº†ï¼Œè¿™æ—¶è½¯ä»¶å¼€å‘äººå‘˜åªéœ€è¦æŒ‰åŠŸèƒ½æ¸…å•è¿›è¡Œå¼€å‘å³å¯ã€‚ä½†æ˜¯è½¯ä»¶åŠŸèƒ½æœªå¿…æ˜¯æœ‰ä»·å€¼çš„ã€‚&lt;/p&gt;

&lt;p&gt;è¿™é‡Œæˆ‘è§‰å¾—å‡ ç‚¹éå¸¸é‡è¦ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ–°AIæŠ€æœ¯çš„è¿…é€Ÿå‘å±•å¿…ç„¶é©æ–°ä¹‹å‰çš„è½¯ä»¶æµç¨‹å’Œå¼€å‘è¿‡ç¨‹ï¼Œåœ¨æ€æƒ³æ˜¯å¿…é¡»è½¬å˜ã€‚&lt;/li&gt;
  &lt;li&gt;å¤§æ¨¡å‹å¹»è§‰å¾ˆä¸¥é‡ï¼Œé€šè¿‡RAGæŠ€æœ¯è§£å†³å¹»è§‰&lt;strong&gt;åš60åˆ†å¾ˆå®¹æ˜“&lt;/strong&gt;ï¼Œä½†æ˜¯æŠŠåº•å±‚çš„èƒ½åŠ›æå‡åˆ°80åˆ†ç”šè‡³90åˆ†ï¼Œæ˜¯éå¸¸éš¾çš„äº‹æƒ…ï¼Œè¿™éœ€è¦ä¸€ä¸ªé•¿æœŸç´¯ç§¯è¿­ä»£çš„è¿‡ç¨‹ã€‚&lt;/li&gt;
  &lt;li&gt;ä¼ä¸šå®¢æˆ·ä¸ä¼šä¸ºäº†ä¸€ä¸ªåªæœ‰60-70åˆ†çš„æŠ€æœ¯äº§å“ä¹°å•ä»˜è´¹ï¼Œå¯¹å¾…è½¯ä»¶ç¼–ç ã€æŠ€æœ¯æ¶æ„å®ç°ï¼Œå¼€å‘äººå‘˜åœ¨æ€æƒ³ä¸Šä¹Ÿæ˜¯éœ€è¦è½¬å˜çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æˆ‘ä»¬å›¢é˜Ÿå†…éƒ¨ç»è¿‡è¿™æ®µæ—¶é—´çš„è¿­ä»£ï¼Œä¹Ÿç¢°äº†å¾ˆå¤šå®¢æˆ·çš„éœ€æ±‚ï¼Œå›¢é˜Ÿçš„æ–¹å‘ä¹Ÿæ˜¯åœ¨å‘å±•ä¸­ä¸æ–­çš„è¿›è¡Œè°ƒæ•´ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬åœ¨æˆç«‹TorchV AIæ—¶ï¼Œæ•´ä½“æ¶æ„å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/summary-01/torchv.png&quot; alt=&quot;å›¾3-TorchVæ¶æ„&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬ä»¥RAGæŠ€æœ¯ä¸ºæ ¸å¿ƒï¼Œåœ¨ä¸Šå±‚åšæˆ‘ä»¬çš„ä¸­é—´ä»¶å±‚ï¼Œè¿™é‡Œé¢æœ€æ ¸å¿ƒçš„ä¸‰ä¸ªï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ä¸»è¦æ ¸å¿ƒé—®é¢˜èšç„¦åœ¨é™ä½å¤§æ¨¡å‹å¹»è§‰ã€ä¸åŒæ•°æ®æºè¿æ¥ä¸Šé¢&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;TorchV IC(å¹‚ç­‰åˆ†ç±»å™¨)&lt;/strong&gt;:è®©æ—¢å®šçš„äº‹å®æ•°æ®å‘æŒ¥æ›´å¤§æ¯”é‡ï¼Œå¼•å…¥å°½å¯èƒ½å¤šçš„å¹‚ç­‰ï¼Œå¯¹æŠ—å’Œé™ä½LLMçš„å¹»è§‰;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;TorchV Actuator(æ‰§è¡Œå™¨)&lt;/strong&gt;:ä¼˜åŒ–TorchVç‰¹æœ‰é£æ ¼çš„è¾“å‡ºæ ¼å¼ï¼ŒåŒ…æ‹¬äº¤äº’ç•Œé¢çš„ç»„è£…ï¼Œå¯¹åº”ç”¨æ›´å‹å¥½;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;TorchV Connector(è¿æ¥å™¨)&lt;/strong&gt;:è¿æ¥æœ¬åœ°æ•°æ®ï¼Œæœ‰åºè§£å†³æœ¬åœ°åŒ–åœºæ™¯ä¸‹æ•°æ®å¤šæ ·æ€§å’Œå¤æ‚æ€§é—®é¢˜.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é€šè¿‡RAGæŠ€æœ¯+ä¸­é—´ä»¶çš„æ–¹å¼ï¼Œå¼€å‘å‡ºäº†æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªäº§å“åŸºçº¿TorchV Botã€‚é€šè¿‡æŒç»­çš„äº§å“è¿­ä»£å’Œä¸åŒå®¢æˆ·éœ€æ±‚ç¢°æ’ï¼Œæˆ‘ä»¬çš„TorchV BotåŸºçº¿äº§å“çš„æ¶æ„ä¹Ÿåˆæ­¥æˆå‹ã€‚å¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://www.luxiangdong.com/images/torchv_website/products_ai_apps.png&quot; alt=&quot;å›¾4-TorchV.AIåº”ç”¨æ¶æ„&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸»è¦ç»„ä»¶æ‹†åˆ†å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;RAGå’ŒAgent&lt;/strong&gt;ï¼šRAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰å’ŒAgentæ˜¯ç›®å‰å¤§è¯­è¨€æ¨¡å‹è½åœ°åˆ°ä¼ä¸šåº”ç”¨çš„äº‹å®æ ‡å‡†ï¼Œä¹Ÿæ˜¯TorchV AIçš„æ ¸å¿ƒä¸­é—´ä»¶ä¹‹ä¸€ï¼›&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Tenant&lt;/strong&gt;ï¼šç§Ÿæˆ·ç³»ç»Ÿï¼Œè¿™æ˜¯æˆ‘ä»¬æ”¯èµ·å¤šç§Ÿæˆ·PaaS/SaaSå¹³å°çš„åŸºç¡€ï¼›&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;OSS&lt;/strong&gt;ï¼šåœ¨çº¿æ–‡ä»¶å­˜å‚¨ï¼ŒåŒ…æ‹¬å®¢æˆ·ä¸Šä¼ çš„æ–‡ä»¶ï¼Œä»¥åŠä»URLä¸­å¯¼å…¥çš„æ•°æ®ç­‰ï¼›&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ChatBot&lt;/strong&gt;ï¼šTorchV AIä¼šæä¾›ä¸€ä¸ªé»˜è®¤çš„Webç‰ˆé—®ç­”ç³»ç»Ÿï¼Œå®¢æˆ·å¯ä»¥åœ¨ä¸Šé¢å¯¹çŸ¥è¯†è¿›è¡Œæµ‹è¯•ï¼Œå¯¹äºå†…éƒ¨ä½¿ç”¨åœºæ™¯ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼›&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ•°æ®&amp;amp;æ´å¯Ÿåˆ†æ&lt;/strong&gt;ï¼šå¯¹æ•°æ®è¿›è¡Œåˆ†æï¼ŒåŒ…æ‹¬å®¢æˆ·é¢„å…ˆè®¾å®šçš„ä¸€äº›æ´å¯Ÿæ¡ä»¶ï¼Œä¸€æ—¦è§¦å‘æ¡ä»¶ï¼Œå°±ä¼šè¿›è¡ŒæŒ‡å®šåŠ¨ä½œï¼Œå¦‚äº§å“å’ŒæœåŠ¡çš„æ¨èï¼Œå’¨è¯¢åˆ†æµç­‰ã€‚å®¢æˆ·åœ¨è¿™é‡Œä¹Ÿå¯ä»¥å¯¹æ•°æ®è¿›è¡ŒåŒæ­¥ï¼Œå¯¼å…¥åˆ°è‡ªå·±çš„ç³»ç»Ÿï¼Œä½œä¸ºæ•°æ®åˆ†æçš„æ•°æ®åŸºç¡€ï¼›&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;çŸ¥è¯†åº“ç®¡ç†&lt;/strong&gt;ï¼šåˆ›å»ºçŸ¥è¯†åº“ï¼Œä¸ºæ¯ä¸ªçŸ¥è¯†åº“ä¸Šä¼ å’Œå¯¼å…¥æ–‡ä»¶ï¼Œä¸€æ—¦ä¸Šä¼ ï¼Œæ–‡ä»¶ç«‹å³è¢«ç³»ç»Ÿå¤„ç†ï¼Œå˜æˆchunkï¼ˆå°å—æ–‡æœ¬ï¼‰å’Œembeddingä¹‹åçš„å‘é‡æ•°æ®ç­‰ï¼›&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;è¿è¥åå°&lt;/strong&gt;ï¼šåŒ…æ‹¬è®¡è´¹ç³»ç»Ÿã€å„ç±»å‚æ•°é…ç½®ã€å¯¹è¯è®°å½•æŸ¥çœ‹å’Œæ ‡æ³¨ã€ç”¨æˆ·æƒé™è®¾ç½®å’Œåé¦ˆå¤„ç†ç­‰åŠŸèƒ½ï¼›&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åº”ç”¨ä¸­å¿ƒ&lt;/strong&gt;ï¼šä¸€ä¸ªå®¢æˆ·å³å¯åˆ›å»ºå¤šä¸ªåº”ç”¨ï¼Œç„¶åé€šè¿‡APIå¯¹æ¥è‡ªå·±çš„åŸæœ‰ç³»ç»Ÿï¼Œæˆ–è€…æ ¹æ®APIåˆ›å»ºæ–°åº”ç”¨ã€‚é™¤äº†APIä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜æä¾›ä¸€é”®åµŒå…¥çš„å¯¹æ¥æ–¹å¼ï¼Œåªéœ€å¼•å…¥å‡ è¡Œjsä»£ç ï¼Œå³å¯åœ¨å®¢æˆ·çš„Webåº”ç”¨ä¸Šå¼€å¯æ‚¬æµ®iconï¼Œæä¾›TorchV AIçš„å¯¹è¯èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä»¥ä¸Šåˆ™æ˜¯ç›®å‰TorchVçš„äº§å“é›å½¢ï¼Œæ›´å¤šç»†èŠ‚å¯ä»¥è®¿é—®&lt;a href=&quot;https://www.torchv.com&quot;&gt;å®˜ç½‘:https://www.torchv.com&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;5-æ¶æ„ç¼–ç¨‹è¯­è¨€çš„é€‰æ‹©&quot;&gt;5. æ¶æ„&amp;amp;ç¼–ç¨‹è¯­è¨€çš„é€‰æ‹©&lt;/h1&gt;

&lt;p&gt;éšç€å¤§æ¨¡å‹LLMçš„çˆ†ç«ï¼ŒåŒ…æ‹¬&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LangChain&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LlamaIndex&lt;/code&gt;ç­‰ä»¥LLMä¸ºåŸºç¡€çš„æ•°æ®Pythonæ¡†æ¶çš„å‡ºç°ï¼Œå¾ˆå¤šå¼€å‘è€…åœ¨é€‰æ‹©å¼€å‘RAGç³»ç»Ÿåº”ç”¨æ—¶ï¼Œä¼šå¯èƒ½æ— æ³•ç€æ‰‹ã€‚&lt;/p&gt;

&lt;p&gt;èµ·åˆåœ¨å¼€å‘RAGåº”ç”¨çš„æ—¶å€™ï¼Œä¹Ÿçº ç»“è¿‡ç¼–ç¨‹è¯­è¨€çš„é€‰æ‹©ï¼Œåœ¨è¿™æœŸé—´èµ°äº†å¾ˆå¤šçš„å¼¯è·¯ï¼Œä¹Ÿå¾—åˆ°äº†ä¸€äº›æ•™è®­ã€‚&lt;/p&gt;

&lt;p&gt;å…ˆè¯´ç»“è®ºï¼ŒTorchV.AIçš„äº§å“é€‰Java+Pythonä½œä¸ºæœåŠ¡ç«¯çš„å¼€å‘è¯­è¨€ã€‚&lt;/p&gt;

&lt;p&gt;è¿™é‡Œé¢æœ‰ä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å‘˜å¤–å’Œæˆ‘éƒ½æ˜¯å¤šå¹´çš„Javaè¯­è¨€å¼€å‘å‡ºç”Ÿï¼Œä»ç¼–ç ã€ç”Ÿæ€ç­‰æ–¹é¢çš„äº†è§£ç¨‹åº¦ï¼Œé‚£è‡ªç„¶æ˜¯ä¸å¯èƒ½æŠ›å¼ƒJava&lt;/li&gt;
  &lt;li&gt;Pythonè¯­è¨€æ˜¯æ— å¯é¿å…çš„ï¼Œä½†æ˜¯åœ¨æ•´ä¸ªå·¥ç¨‹é‡Œé¢ï¼ŒèŒè´£æ˜¯æœ‰åˆ†å·¥çš„ï¼Œ&lt;strong&gt;æ— çŠ¶æ€&lt;/strong&gt;çš„ä¸€äº›é€»è¾‘æ“ä½œéƒ½é€šè¿‡Pythonæ¥å®ç°&lt;/li&gt;
  &lt;li&gt;ä¼ä¸šçº§å¼€å‘è¯­è¨€ä»¥åŠæŠ€æœ¯ç»„ä»¶ç”Ÿæ€&lt;/li&gt;
  &lt;li&gt;ä¸­é—´ä»¶ä¸°å¯Œç¨‹åº¦ã€å¼€å‘ç¤¾åŒºçš„å¥åº·å‘å±•&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä¸‹å›¾æ˜¯æˆ‘ç”»çš„ä¸€ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Java&lt;/code&gt; VS &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Python&lt;/code&gt;è¿™ä¸¤ä¸ªç¼–ç¨‹è¯­è¨€åœ¨ä¸åŒé¢†åŸŸçš„ä¸€äº›ç‰¹æ€§å¯¹æ¯”ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/summary-01/language.png&quot; alt=&quot;å›¾5-ç¼–ç¨‹è¯­è¨€é€‰æ‹©&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ç›®å‰å¸‚é¢ä¸Šå¼€å‘RAGå¤§æ¨¡å‹åº”ç”¨æœ€ç«çš„å½“å±&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LangChain&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LlamaIndex&lt;/code&gt;è¿™ä¸¤ä¸ªæ¡†æ¶ï¼Œéƒ½æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Python&lt;/code&gt;è¯­è¨€è¿›è¡Œå¼€å‘ï¼Œæä¾›äº†å¼€ç®±å³ç”¨çš„åŠŸèƒ½ï¼Œå¯èƒ½åœ¨&lt;strong&gt;ä¸è¶…è¿‡10è¡Œä»£ç &lt;/strong&gt;çš„æƒ…å†µä¸‹ï¼Œå°±èƒ½è½»æ¾å®Œæˆä¸€ä¸ªRAGå¤§æ¨¡å‹åº”ç”¨çš„demoã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬èµ·åˆä¹Ÿæ˜¯åœ¨çº ç»“åœ¨è¿™æœŸé—´å¦‚ä½•æ›´å¥½çš„åšå–èˆï¼Œåæ¥å›¢é˜Ÿå†…éƒ¨ç»è¿‡è®¨è®ºï¼Œè¿˜æ˜¯å°†éƒ¨åˆ†çš„ä¸šåŠ¡é€»è¾‘æ”¾åœ¨Javaè¯­è¨€ä¸­ï¼Œé‡å†™RAGè¿‡ç¨‹ä¸­çš„ä¸€äº›æ ¸å¿ƒé€»è¾‘å’Œç»„ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;è¿™é‡Œé¢çš„æ€è€ƒï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;RAGæ¶æ„æ¶‰åŠåˆ°çš„ä¸œè¥¿å¤šä¸”æ‚ï¼Œå¼€ç®±å³ç”¨çš„LLMæ•°æ®å¤„ç†æ¡†æ¶å¯èƒ½æ— æ³•æ»¡è¶³ä¼ä¸šçš„ä¸šåŠ¡è¯‰æ±‚(éœ€æ±‚å˜åŒ–å¤šç«¯)&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;RAGç›®å‰å¹¶æ²¡æœ‰å‘å±•æˆä¸ºHTTPè§„èŒƒä¸€æ ·çš„åè®®çº¦å®šï¼Œæ‰€ä»¥ä¸åŒçš„RAGè¿‡ç¨‹ã€LLMæ¨¡å‹ç­‰éƒ½ä¼šå¯¼è‡´RAGçš„æ•ˆæœå·®å¼‚&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å›½å†…LLMç™¾èŠ±é½æ”¾ï¼Œæ— æ³•å¼€ç®±å³ç”¨ï¼Œå›½å†…çš„ä¸åŒéœ€æ±‚ä¹Ÿéœ€è¦æ»¡è¶³(æœ¬åœ°åŒ–é€‚é…)&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç»“åˆåœ¨å¼€å‘RAGåº”ç”¨ä¸­æ¶‰åŠåˆ°çš„æ•°æ®å·¥ç¨‹ç­‰éƒ¨åˆ†é€»è¾‘ï¼Œæˆ‘ä»¬ç»“åˆä¸¤å¤§è¯­è¨€çš„ç‰¹æ€§ï¼Œä¹Ÿèƒ½å¾ˆè½»æ¾çš„å‹¾ç”»å‡ºä¸€å¼ ä¾¿è¯­è¨€çº§åˆ«çš„æ¶æ„å›¾ï¼Œæ¶µç›–äº†åœ¨ä¼ä¸šå¼€å‘ã€ä¸šåŠ¡åœºæ™¯è½åœ°æ—¶ï¼Œå¦‚ä½•å¿«é€Ÿçš„é€‚é…ä¸Šå±‚åº”ç”¨çš„éœ€æ±‚ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/summary-01/rag_languages.png&quot; alt=&quot;å›¾6-åŸºäºè¯­è¨€èƒ½åŠ›çº§åˆ«çš„RAGæ¶æ„ç¤ºæ„å›¾&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨è¿™ç§å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ™°çš„çœ‹åˆ°ï¼Œä¸åŒçš„ä»»åŠ¡&amp;amp;éœ€æ±‚ï¼ŒèŒè´£åˆ†å·¥æ˜¯æ¯”è¾ƒæ˜ç¡®çš„ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Javaï¼šä½¿ç”¨Javaç”Ÿæ€æ—¶ï¼Œé’ˆå¯¹ä¸šåŠ¡ç³»ç»Ÿçš„æ•°æ®ä¸€è‡´æ€§ï¼Œåˆ†å¸ƒå¼ã€é‰´æƒã€é™æµç­‰ä¼ä¸šåº”ç”¨æ¥å£çš„ç‰¹æ€§å¼€å‘ï¼Œç›®å‰éƒ½æœ‰éå¸¸æˆç†Ÿçš„è§£å†³æ–¹æ¡ˆ&lt;/li&gt;
  &lt;li&gt;Pythonï¼šæ¶‰åŠåˆ°æ— çŠ¶æ€çš„æœåŠ¡æ—¶ï¼Œæ”¯æ’‘ä¸Šå±‚åº”ç”¨çš„å¤„ç†ï¼ŒåŒ…æ‹¬æ•°æ®å·¥ç¨‹ã€Chatæ¨¡å‹ã€æ•°æ®å¤„ç†ã€å¾®è°ƒç­‰ç³»ç»Ÿå·¥ç¨‹ï¼Œé‚£ä¹ˆç”¨Pythonæ˜¯æ¯«æ— ç–‘é—®&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨è¿™é‡Œï¼Œå½“æˆ‘ä»¬ä½¿ç”¨åº”ç”¨å¼€å‘æ—¶ï¼ŒæŒ‘é€‰ç¼–ç¨‹è¯­è¨€æ¥å¼€å‘åº”ç”¨æœåŠ¡ï¼Œä¼˜å…ˆè€ƒè™‘çš„æ˜¯ç”Ÿæ€å’Œç¨³å®šæ€§ã€‚&lt;/p&gt;

&lt;p&gt;å½“ç„¶ï¼Œè¿™é‡Œé¢å¹¶æ²¡æœ‰å”¯ä¸€çš„æ ‡å‡†ï¼Œæ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µå‡ºå‘æ¥é€‰æ‹©æ˜¯æœ€ä¼˜çš„ï¼Œä»¥ä¸Šä»…ä»…åªæ˜¯åˆ†äº«ä¸€ä¸‹æˆ‘çš„çœ‹æ³•ã€‚&lt;/p&gt;

&lt;h1 id=&quot;6-æ€»ç»“&quot;&gt;6. æ€»ç»“&lt;/h1&gt;

&lt;p&gt;å¥½äº†ï¼Œå…¨æ–‡å®Œï¼Œåšä¸€ä¸ªæ€»ç»“ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;RAGã€LLMç­‰AIäº§å“çš„å¼€å‘æ˜¯æ—¥æ–°æœˆå¼‚çš„ï¼ŒæŠ€æœ¯æ ˆä½“ç³»ä¼šé£é€Ÿå‘å±•,å¯¹äºå…¬å¸è€Œè¨€ï¼Œå°æ­¥å¿«è·‘ï¼Œå¿«é€Ÿè¯•é”™å¯èƒ½æ˜¯éå¸¸é‡è¦çš„&lt;/li&gt;
  &lt;li&gt;åº”ç”¨åœºæ™¯ç›®å‰ä»…ä»…åªæ˜¯èšç„¦åœ¨çŸ¥è¯†å¯†é›†å‹ä»»åŠ¡ï¼Œæœªæ¥éšç€æŠ€æœ¯çš„å‘å±•ï¼Œä¼šæ‰©å±•åˆ°æ›´å¤šçš„è¡Œä¸šä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;TorchV.AIç›®å‰æ˜¯åˆšèµ·æ­¥é˜¶æ®µï¼Œä¹Ÿæ¬¢è¿æ›´å¤šçš„ä¼ä¸šå®¢æˆ·è¯•ç”¨ï¼Œåˆä½œï¼ï¼ï¼&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬çš„å®˜ç½‘åœ°å€ï¼š&lt;a href=&quot;https://www.torchv.com&quot;&gt;https://www.torchv.com&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;7-references&quot;&gt;7. References&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.torchv.com&quot;&gt;https://www.torchv.com&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.luxiangdong.com&quot;&gt;https://www.luxiangdong.com&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://arxiv.org/abs/2005.11401&quot;&gt;https://arxiv.org/abs/2005.11401&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="å¤§æ¨¡å‹" /><category term="RAGå®è·µ" /><category term="TorchV" /><category term="RAGæ¦‚è¿°" /><category term="RAG" /><category term="å¤§æ¨¡å‹" /><category term="LLM" /><summary type="html">1. å‰è¨€</summary></entry><entry><title type="html">TorchVçš„RAGå®è·µåˆ†äº«(ä¸‰):è§£ællama_indexçš„æ•°æ®å­˜å‚¨ç»“æ„å’Œå¬å›ç­–ç•¥è¿‡ç¨‹</title><link href="http://localhost:4000/2024/01/14/torchv-rag-3/" rel="alternate" type="text/html" title="TorchVçš„RAGå®è·µåˆ†äº«(ä¸‰):è§£ællama_indexçš„æ•°æ®å­˜å‚¨ç»“æ„å’Œå¬å›ç­–ç•¥è¿‡ç¨‹" /><published>2024-01-14T00:00:00+08:00</published><updated>2024-01-14T00:00:00+08:00</updated><id>http://localhost:4000/2024/01/14/torchv-rag-3</id><content type="html" xml:base="http://localhost:4000/2024/01/14/torchv-rag-3/">&lt;h1 id=&quot;1å‰è¨€&quot;&gt;1.å‰è¨€&lt;/h1&gt;

&lt;p&gt;LlamaIndexæ˜¯ä¸€ä¸ªåŸºäºLLMçš„æ•°æ®å¤„ç†æ¡†æ¶ï¼Œåœ¨RAGé¢†åŸŸéå¸¸æµè¡Œï¼Œç®€å•çš„å‡ è¡Œä»£ç å°±èƒ½å®ç°æœ¬åœ°çš„æ–‡ä»¶çš„å¯¹è¯åŠŸèƒ½ï¼Œå¯¹å¼€å‘è€…æä¾›äº†æè‡´çš„å°è£…ï¼Œå¼€ç®±å³ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;æœ¬æ–‡ä»¥å®˜æ–¹æä¾›çš„æœ€ç®€å•çš„ä»£ç†ç¤ºä¾‹ä¸ºä¾‹ï¼Œåˆ†æLlamaIndexåœ¨æ•°æ®è§£æã€å‘é‡Embeddingã€æ•°æ®å­˜å‚¨åŠå¬å›çš„æ•´ä¸ªæºç è¿‡ç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;é€šè¿‡å­¦ä¹ æ¡†æ¶çš„æºç ä¹Ÿèƒ½è®©å¼€å‘è€…ä»¬åœ¨å®é™…çš„ä¼ä¸šå¤§æ¨¡å‹åº”ç”¨å¼€å‘ä¸­ï¼Œå¯¹RAGæœ‰ä¸€ä¸ªæ›´æ¸…æ™°çš„äº†è§£å’Œè®¤çŸ¥ã€‚&lt;/p&gt;

&lt;p&gt;æœ¬æ¬¡é€‰ç”¨çš„æŠ€æœ¯ç»„ä»¶ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;llm&lt;/strong&gt;ï¼šOpenAI&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Embedding&lt;/strong&gt;ï¼šOpenAI&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;VectorDB&lt;/strong&gt;ï¼šElasticSearch&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å®˜æ–¹ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;c1&quot;&gt;# 1.æ„å»ºå‘é‡æ•°æ®åº“å­˜å‚¨å¯¹è±¡å®ä¾‹
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vector_store&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ElasticsearchStore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;index_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;my_index&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;es_url&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://localhost:9200&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;storage_context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StorageContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_defaults&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vector_store&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vector_store&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# åŠ è½½æœ¬åœ°çš„æ•°æ®é›†
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documents&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SimpleDirectoryReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'data'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# æ„å»ºç´¢å¼•
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorStoreIndex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_documents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;storage_context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;storage_context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# æœåŠ¡å¯¹è±¡ï¼Œæ„å»ºqueryå¼•æ“
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;service_context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ServiceContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_defaults&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;llm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OpenAI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;query_engine&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;as_query_engine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;service_context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;service_context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# é—®é—®é¢˜
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query_engine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ä½é™¢èµ·ä»˜çº¿å¤šå°‘é’±?&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# å“åº”ç­”æ¡ˆ
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;2å¤„ç†è¿‡ç¨‹&quot;&gt;2.å¤„ç†è¿‡ç¨‹&lt;/h1&gt;

&lt;h2 id=&quot;21-æ•°æ®å¤„ç†è¿‡ç¨‹&quot;&gt;2.1 æ•°æ®å¤„ç†è¿‡ç¨‹&lt;/h2&gt;

&lt;p&gt;åœ¨æ•°æ®å¤„ç†çš„è¿‡ç¨‹ä¸­ï¼Œä¸»è¦åŒ…å«å‡ ä¸ªæ ¸å¿ƒçš„æ­¥éª¤ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;åˆå§‹åŒ–å‘é‡å­˜å‚¨å¼•æ“ï¼Œç›®å‰å‘é‡æ•°æ®åº“ç±»å‹éå¸¸å¤šï¼Œç¬”è€…æœ¬æœºè·‘äº†ä¸€ä¸ªesçš„dockeré•œåƒï¼Œè¿™é‡Œå°±é€‰æ‹©esäº†&lt;/li&gt;
  &lt;li&gt;è¯»å–æ•°æ®ï¼Œæ•°æ®æ ¼å¼åŒ…æ‹¬ï¼šPDFã€WORDã€TXTç­‰ç­‰æ–‡æœ¬æ•°æ®&lt;/li&gt;
  &lt;li&gt;åœ¨æ•°æ®è¯»å–å®Œæˆåï¼Œä¼šå¯¹æ–‡æ¡£å†…å®¹è¿›è¡Œåˆ†å‰²ï¼Œç„¶åEmbedding(è°ƒç”¨embeddingæ¨¡å‹)å­˜å‚¨å…¥åº“&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;211-å¤„ç†åŠ è½½ä¸åŒçš„æ–‡ä»¶ç±»å‹æ„å»ºdocument&quot;&gt;2.1.1 å¤„ç†åŠ è½½ä¸åŒçš„æ–‡ä»¶ç±»å‹(æ„å»ºDocument)&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SimpleDirectoryReader&lt;/code&gt;æ˜¯llamaindexæä¾›çš„ä¸€ä¸ªåŸºäºæ–‡ä»¶å¤¹çš„è¯»å–å™¨ç±»ï¼Œä¼šæ ¹æ®æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶æ‰©å±•åç¼€ç±»å‹è‡ªåŠ¨åŠ è½½æ•°æ®&lt;/p&gt;

&lt;p&gt;ä¸»è¦æ”¯æŒçš„æ–‡ä»¶æ•°æ®ç±»å‹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;DEFAULT_FILE_READER_CLS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BaseReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.hwp&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HWPReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.pdf&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PDFReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.docx&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DocxReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.pptx&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PptxReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.ppt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PptxReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.pptm&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PptxReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.jpg&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.png&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.jpeg&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.mp3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VideoAudioReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.mp4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VideoAudioReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.csv&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PandasCSVReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.epub&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EpubReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.md&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MarkdownReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.mbox&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MboxReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;.ipynb&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IPYNBReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SimpleDirectoryReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BaseReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;Simple directory reader.

    Load files from file directory.
    Automatically select the best file reader given file extensions.

    Args:
        input_dir (str): Path to the directory.
        input_files (List): List of file paths to read
            (Optional; overrides input_dir, exclude)
        exclude (List): glob of python file paths to exclude (Optional)
        exclude_hidden (bool): Whether to exclude hidden files (dotfiles).
        encoding (str): Encoding of the files.
            Default is utf-8.
        errors (str): how encoding and decoding errors are to be handled,
              see https://docs.python.org/3/library/functions.html#open
        recursive (bool): Whether to recursively search in subdirectories.
            False by default.
        filename_as_id (bool): Whether to use the filename as the document id.
            False by default.
        required_exts (Optional[List[str]]): List of required extensions.
            Default is None.
        file_extractor (Optional[Dict[str, BaseReader]]): A mapping of file
            extension to a BaseReader class that specifies how to convert that file
            to text. If not specified, use default from DEFAULT_FILE_READER_CLS.
        num_files_limit (Optional[int]): Maximum number of files to read.
            Default is None.
        file_metadata (Optional[Callable[str, Dict]]): A function that takes
            in a filename and returns a Dict of metadata for the Document.
            Default is None.
    &quot;&quot;&quot;&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;supported_suffix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DEFAULT_FILE_READER_CLS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;....&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ€»å…±æ”¯æŒäº†16ä¸ªæ–‡ä»¶æ•°æ®ç±»å‹ï¼Œæ•´ç†åˆ°è¡¨æ ¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;æ–‡ä»¶ç±»å‹&lt;/th&gt;
      &lt;th&gt;ä¾èµ–ç»„ä»¶&lt;/th&gt;
      &lt;th&gt;è¯´æ˜&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;hwp&lt;/td&gt;
      &lt;td&gt;olefile&lt;/td&gt;
      &lt;td&gt;Â &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;pdf&lt;/td&gt;
      &lt;td&gt;pypdf&lt;/td&gt;
      &lt;td&gt;Â &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;docx&lt;/td&gt;
      &lt;td&gt;docx2txt&lt;/td&gt;
      &lt;td&gt;Â &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;pptxã€pptmã€ppt&lt;/td&gt;
      &lt;td&gt;python-pptxã€transformersã€torch&lt;/td&gt;
      &lt;td&gt;ç”¨åˆ°ä¸€äº›æ¨¡å‹ï¼Œå¯¹æ•°æ®è¿›è¡Œç†è§£ã€æå–&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;jpgã€pngã€jpegã€&lt;/td&gt;
      &lt;td&gt;sentencepieceã€transformersã€torch&lt;/td&gt;
      &lt;td&gt;ç”¨åˆ°ä¸€äº›æ¨¡å‹ï¼Œå¯¹æ•°æ®è¿›è¡Œç†è§£ã€æå–&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;mp3ã€mp4&lt;/td&gt;
      &lt;td&gt;whisper&lt;/td&gt;
      &lt;td&gt;ç”¨åˆ°ä¸€äº›æ¨¡å‹ï¼Œå¯¹æ•°æ®è¿›è¡Œç†è§£ã€æå–&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;csv&lt;/td&gt;
      &lt;td&gt;pandas&lt;/td&gt;
      &lt;td&gt;Â &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;epub&lt;/td&gt;
      &lt;td&gt;EbookLibã€html2text&lt;/td&gt;
      &lt;td&gt;Â &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;md&lt;/td&gt;
      &lt;td&gt;æ— &lt;/td&gt;
      &lt;td&gt;æœ¬åœ°æµç›´æ¥openï¼Œè¯»å–æ–‡æœ¬&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;mbox&lt;/td&gt;
      &lt;td&gt;bs4ã€mailbox&lt;/td&gt;
      &lt;td&gt;Â &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ipynb&lt;/td&gt;
      &lt;td&gt;nbconvert&lt;/td&gt;
      &lt;td&gt;Â &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;æ•´ä¸ªReaderç±»çš„UMLç±»å›¾è®¾è®¡å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/llamaindex-reader-uml.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æ‰€æœ‰æ–‡ä»¶æ•°æ®ç±»å‹çš„Readerï¼Œé€šè¿‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;load_data&lt;/code&gt;æ–¹æ³•ï¼Œæœ€ç»ˆå¾—åˆ°è¯¥æ–‡æ¡£çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Document&lt;/code&gt;å¯¹è±¡é›†åˆï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Document&lt;/code&gt;ç±»æ˜¯LlamaIndexæ¡†æ¶çš„å¤„ç†æ–‡æ¡£çš„æ ¸å¿ƒç±»å¯¹è±¡,ä»è¯¥ç±»çš„ç»“æ„è®¾è®¡æ¥çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸€ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;æ ¸å¿ƒå­—æ®µ&lt;/strong&gt;ï¼š&lt;strong&gt;id(æ–‡æ¡£å”¯ä¸€id)&lt;/strong&gt;ã€&lt;strong&gt;text(æ–‡æœ¬å†…å®¹)&lt;/strong&gt;ã€&lt;strong&gt;embedding(å‘é‡floatæµ®ç‚¹å‹é›†åˆ)&lt;/strong&gt;ã€&lt;strong&gt;metadata(å…ƒæ•°æ®)&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;BaseNodeæä¾›äº†ä¸€ä¸ª&lt;strong&gt;æ ‘ç»“æ„&lt;/strong&gt;çš„è®¾è®¡ï¼Œå¯¹äºä¸€ç¯‡æ–‡æ¡£è€Œè¨€ï¼Œä»å¤šçº§æ ‡é¢˜åˆ’åˆ†æ¥çœ‹ï¼Œæ ‘ç»“æ„èƒ½æ›´å¥½çš„æè¿°ä¸€ç¯‡æ–‡æ¡£çš„åŸºç¡€ç»“æ„&lt;/li&gt;
  &lt;li&gt;Documentæä¾›äº†ä¸€äº›å¤–éƒ¨åº”ç”¨æ¡†æ¶é€‚é…çš„æ–¹æ³•ï¼Œæ¯”å¦‚ï¼šLangChainã€EmbedChainç­‰ç­‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/document.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æœ€ç»ˆæ„å»ºå®Œæˆæ‰€æœ‰çš„Documentä¿¡æ¯åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸‹é¢ä¸€ä¸ªç»“æ„ä¿¡æ¯&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;æœ¬ç¤ºä¾‹ç¨‹åºï¼Œä½¿ç”¨çš„æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œç”±äºæˆ‘ä»¬å¹¶æœªæŒ‡å®šåˆ†å‰²ç­‰ç­–ç•¥ï¼ŒLlamaIndexå¯¹äºPDFæ–‡ä»¶æ˜¯ä»¥Pageä¸ºå•ä½ï¼Œè¿›è¡Œåˆ‡å‰²ï¼Œæœ€ç»ˆå°†æ‰€æœ‰çš„Documentå¯¹è±¡å­˜å‚¨è¿›å…¥å‘é‡æ•°æ®åº“&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114153311229.png&quot; alt=&quot;image-20240114153311229&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;212-æ„å»ºå‘é‡æ•°æ®åº“ç´¢å¼•index&quot;&gt;2.1.2 æ„å»ºå‘é‡æ•°æ®åº“ç´¢å¼•(Index)&lt;/h3&gt;

&lt;p&gt;å½“æœ¬åœ°æ•°æ®é›†å¤„ç†å®Œæˆï¼Œå¾—åˆ°ä¸€ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Document&lt;/code&gt;é›†åˆçš„æ—¶å€™ï¼Œæ­¤æ—¶ï¼Œè¿™éœ€è¦æ„å»ºå‘é‡æ•°æ®åº“çš„ç´¢å¼•ï¼Œä¸»è¦æ˜¯åŒ…å«å‡ ä¸ªè¿‡ç¨‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;è°ƒç”¨ä¸åŒçš„å‘é‡æ•°æ®åº“ä¸­é—´ä»¶ï¼Œæ„å»ºé›†åˆç´¢å¼•ï¼Œå¯¹äºESæ¥è¯´ï¼Œåˆ™æ˜¯åˆ›å»ºIndex&lt;/li&gt;
  &lt;li&gt;è°ƒç”¨Embeddingæ¨¡å‹(åŸºäºOpenAIæä¾›çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;text-embedding-ada-002&lt;/code&gt;æ¨¡å‹)ï¼Œå°†Documentå¯¹è±¡é›†åˆä¸­çš„textæ–‡æœ¬ï¼Œè¿›è¡Œå‘é‡åŒ–å¤„ç†å¹¶èµ‹å€¼&lt;/li&gt;
  &lt;li&gt;å°†&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Document&lt;/code&gt;é›†åˆçš„å¯¹è±¡å€¼(textã€embeddingã€metadata)å­˜å‚¨è¿›å…¥å‘é‡æ•°æ®åº“&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨LlamaIndexåˆ›å»ºESçš„å‘é‡ç´¢å¼•ç»“æ„ä¸­ï¼Œåˆå§‹æƒ…å†µä¸‹ï¼Œæ ¸å¿ƒå­—æ®µä¹Ÿæ˜¯å‰é¢æˆ‘ä»¬æåˆ°çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Document&lt;/code&gt;ç±»ä¸­çš„å‡ ä¸ªæ ¸å¿ƒå­—æ®µ(idã€embeddingã€contentã€metadata)ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114164439411.png&quot; alt=&quot;image-20240114164439411&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯åœ¨Documentå¯¹è±¡éå†ç»“æŸåï¼Œåœ¨æ•°æ®å­˜å‚¨é˜¶æ®µï¼Œè€ƒè™‘åˆ°å…ƒæ•°æ®çš„ä¿¡æ¯ï¼ŒLlamaIndexä¼šæ‰©å……metadataå…ƒæ•°æ®çš„å­—æ®µï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114164647308.png&quot; alt=&quot;image-20240114164647308&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å…ƒæ•°æ®ä¿¡æ¯ä¼šå°†æ–‡æ¡£çš„ä¿¡æ¯æå–å‡ºæ¥ï¼ŒåŒ…æ‹¬é¡µç ã€æ–‡ä»¶å¤§å°ã€æ–‡ä»¶åç§°ã€åˆ›å»ºæ—¥æœŸç­‰ç­‰ä¿¡æ¯&lt;/p&gt;

&lt;p&gt;æœ€ç»ˆåœ¨æœ¬åœ°æ•°æ®é›†çš„æƒ…å†µä¸‹ï¼ŒLlamaIndexåˆ›å»ºçš„ESæ•°æ®ç´¢å¼•ç»“æ„æœ€ç»ˆå°±ä¼šå˜æˆä¸‹é¢è¿™ç§ç»“æ„å½¢å¼ï¼š&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;mappings&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;properties&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;embedding&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;dense_vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;dims&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1536&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;index&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;similarity&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;cosine&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;metadata&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;properties&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;_node_content&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;fields&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;ignore_above&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;_node_type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;fields&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;ignore_above&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;creation_date&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;date&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;doc_id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;document_id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;file_name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;fields&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;ignore_above&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;file_path&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;fields&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;ignore_above&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;file_size&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;long&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;file_type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;fields&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;ignore_above&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;last_accessed_date&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;date&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;last_modified_date&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;date&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;page_label&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;fields&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;ignore_above&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;ref_doc_id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ•°æ®Indexå®šä¹‰å®Œæˆï¼ŒDocumentå¯¹è±¡å­˜å‚¨è¿›å…¥å‘é‡æ•°æ®åº“ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬çš„æ•°æ®é›†ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114173127581.png&quot; alt=&quot;image-20240114173127581&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;22-é—®ç­”è·å–ç­”æ¡ˆ&quot;&gt;2.2 é—®ç­”è·å–ç­”æ¡ˆ&lt;/h2&gt;

&lt;p&gt;åœ¨è·å–ç­”æ¡ˆçš„è¿‡ç¨‹ä¸­ï¼Œä¸»è¦åŒ…å«å‡ ä¸ªæ ¸å¿ƒçš„æ­¥éª¤ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ„å»ºç”¨æˆ·æŸ¥è¯¢Queryï¼Œå¯¹queryè¿›è¡ŒEmbeddingå¤„ç†ï¼Œå¬å›Topkçš„ç›¸ä¼¼ç‰‡æ®µå†…å®¹ã€‚&lt;/li&gt;
  &lt;li&gt;ç»„è£…Promptå·¥ç¨‹å†…å®¹ï¼Œå‘é€å¤§æ¨¡å‹è·å–ç­”æ¡ˆ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;221-å¬å›æŸ¥è¯¢è·å–topk&quot;&gt;2.2.1 å¬å›æŸ¥è¯¢è·å–TopK&lt;/h3&gt;

&lt;p&gt;é¦–å…ˆï¼Œåœ¨RAGçš„æŸ¥è¯¢é˜¶æ®µï¼Œä¸ç®¡æ˜¯ä½¿ç”¨é‚£ä¸ªå‘é‡æ•°æ®åº“ï¼Œæ ¹æ®æ•°æ®åº“çš„ç±»å‹ï¼Œå°†ç”¨æˆ·çš„queryè¯­å¥è¿›è¡ŒEmbeddingåï¼Œå†æ„å»ºæ•°æ®åº“çš„æŸ¥è¯¢æ¡ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114155247333.png&quot; alt=&quot;image-20240114155247333&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è¿™é‡Œé¢ä¼šåŒ…å«å‡ ä¸ªæ ¸å¿ƒçš„å‚æ•°ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;embeddingï¼šknnæŸ¥è¯¢çš„æµ®ç‚¹å‹å‘é‡æ•°ç»„å€¼&lt;/li&gt;
  &lt;li&gt;top_k:æ ¹æ®knnç›¸ä¼¼åº¦æŸ¥è¯¢è·å–å¾—åˆ°çš„topkå€¼æ•°é‡ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒLlamaIndexé»˜è®¤å€¼æ˜¯2&lt;/li&gt;
  &lt;li&gt;filtersï¼šè¿‡æ»¤æ¡ä»¶&lt;/li&gt;
  &lt;li&gt;alphaï¼šè¯­ä¹‰&amp;amp;å…³é”®è¯æ··åˆæ£€ç´¢çš„æƒé‡ï¼Œ0ä»£è¡¨bm25ç®—æ³•æ£€ç´¢ï¼Œ1åˆ™ä»£è¡¨knn&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;VectorStoreQuery&lt;/code&gt;ç±»ç»“æ„å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataclass&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;VectorStoreQuery&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;Vector store query.&quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# knnæœç´¢çš„æŸ¥è¯¢Embeddingæµ®ç‚¹å‹æ•°ç»„
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;query_embedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# knnæœç´¢çš„top kå–å€¼
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;similarity_top_k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;doc_ids&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;node_ids&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;query_str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;output_fields&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;embedding_field&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorStoreQueryMode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorStoreQueryMode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DEFAULT&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# NOTE: only for hybrid search (0 for bm25, 1 for vector search)
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# metadata filters
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;filters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MetadataFilters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# only for mmr
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;mmr_threshold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# NOTE: currently only used by postgres hybrid search
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;sparse_top_k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# NOTE: return top k results from hybrid search. similarity_top_k is used for dense search top k
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;hybrid_top_k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;


&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ ¹æ®queryçš„æ¡ä»¶ï¼Œä¼šä»å‘é‡æ•°æ®åº“ä¸­å¬å›è·å–å¾—åˆ°topkçš„TextNodeæ•°ç»„ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114175533596.png&quot; alt=&quot;image-20240114175533596&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;222-æ„å»ºpromptå‘é€å¤§æ¨¡å‹è·å–ç­”æ¡ˆ&quot;&gt;2.2.2 æ„å»ºPromptå‘é€å¤§æ¨¡å‹è·å–ç­”æ¡ˆ&lt;/h3&gt;

&lt;p&gt;æœ€ç»ˆå¬å›åˆ°å¼•ç”¨æ–‡æ¡£å†…å®¹åï¼Œå‰©ä¸‹çš„å°±æ˜¯æ„å»ºæ•´ä¸ªå¤§æ¨¡å‹å¯¹è¯çš„Promptå·¥ç¨‹ï¼Œæ¥çœ‹çœ‹LlamaIndexçš„åŸºç¡€Promptæ˜¯å¦‚ä½•æ„å»ºçš„&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114160925472.png&quot; alt=&quot;image-20240114160925472&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114180819057.png&quot; alt=&quot;image-20240114180819057&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;partial_format&lt;/code&gt;æ–¹æ³•è·å–å¾—åˆ°ä¸€ä¸ªåŸºç¡€çš„Promptæ¨¡ç‰ˆä¿¡æ¯ï¼Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;'Context information is below.
---------------------
{context_str}
---------------------
Given the context information and not prior knowledge, answer the query.
Query: {query_str}
Answer: '
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¿™é‡Œæœ‰ä¸¤ä¸ªæ ¸å¿ƒçš„å‚æ•°ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;context_str&lt;/code&gt;: ä»å‘é‡æ•°æ®åº“å¬å›æŸ¥è¯¢çš„çŸ¥è¯†åº“å¼•ç”¨æ–‡æœ¬æ•°æ®ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä»æ¨¡ç‰ˆçš„è®¾å®šä¹Ÿæ˜¯å‘Šè¯‰å¤§æ¨¡å‹åŸºäºçŸ¥è¯†ä¿¡æ¯è¿›è¡Œå›ç­”&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;query_str&lt;/code&gt;ï¼šç”¨æˆ·æé—®çš„é—®é¢˜&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è€Œæœ€ç»ˆçš„context_strä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114181236770.png&quot; alt=&quot;image-20240114181236770&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬çš„é—®é¢˜æ˜¯ï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ä½é™¢èµ·ä»˜çº¿å¤šå°‘é’±?&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ä»æœ€ç»ˆknnæ£€ç´¢å¬å›çš„æ–‡æ¡£ç‰‡æ®µæ¥çœ‹ï¼Œç²¾å‡†çš„æ‰¾åˆ°äº†çŸ¥è¯†åº“çš„å¼•ç”¨å†…å®¹ï¼Œæ­¤æ—¶ï¼Œäº¤ç»™å¤§æ¨¡å‹è¿›è¡Œå›ç­”ï¼Œè·å–æˆ‘ä»¬æƒ³è¦çš„ç­”æ¡ˆç»“æœã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-3/image-20240114181429648.png&quot; alt=&quot;image-20240114181429648&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;3æ€»ç»“&quot;&gt;3.æ€»ç»“&lt;/h2&gt;

&lt;p&gt;å¥½äº†ï¼Œæœ¬æ–‡ä»LlamaIndexç»™æˆ‘ä»¬æä¾›çš„åŸºç¡€çš„ç¤ºä¾‹ç¨‹åºï¼ŒåŸºäºBasic RAGçš„åŸºç¡€æ¶æ„æ¥åˆ†ææ•°æ®çš„å¤„ç†ã€å¬å›å“åº”ç­‰è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°LlamaIndexæ¡†æ¶ç»™äº†æˆ‘ä»¬ä¸€ä¸ªå¾ˆå¥½çš„å¤„ç†æµç¨‹ï¼Œä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å¯¹äºåŸºç¡€çš„RAGæ¶æ„ï¼Œæœ‰ä¸€ä¸ªå¾ˆå¥½çš„è®¤çŸ¥ï¼Œè®©å¼€å‘è€…çŸ¥é“RAGæ˜¯ä¸€ä¸ªæ€æ ·çš„å¤„ç†è¿‡ç¨‹&lt;/li&gt;
  &lt;li&gt;åº•å±‚çš„å‘é‡æ•°æ®åº“å­˜å‚¨ç»“æ„è®¾è®¡å’Œä¸­é—´ç¨‹åºçš„ç»“æ„è®¾è®¡ï¼Œèƒ½å¤Ÿç»™åšRAGåº”ç”¨çš„å¼€å‘äººå‘˜ä¸€äº›å¯å‘ï¼Œæµè¡Œçš„RAGæ¡†æ¶åœ¨æ•°æ®ç»“æ„è®¾è®¡ä¸Šæ˜¯å¦‚ä½•åšçš„ï¼Œè¿™å¯¹äºä¼ä¸šå¼€å‘äººå‘˜æ¥è¯´ï¼Œæ¶æ„&amp;amp;æ•°æ®ç»“æ„è®¾è®¡æ˜¯æœ‰å¾ˆé‡è¦çš„å‚è€ƒæ„ä¹‰ã€‚&lt;/li&gt;
&lt;/ul&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="å¤§æ¨¡å‹" /><category term="RAGå®è·µ" /><category term="TorchV" /><category term="RAGæ¦‚è¿°" /><category term="RAG" /><category term="å¤§æ¨¡å‹" /><category term="LLM" /><summary type="html">1.å‰è¨€</summary></entry><entry><title type="html">TorchVçš„RAGå®è·µåˆ†äº«(äºŒ)ï¼šåŸºäºElasticSearchçš„æ··åˆæ£€ç´¢å®æˆ˜&amp;amp;åŸç†åˆ†æ</title><link href="http://localhost:4000/2023/12/27/torchv-rag-2/" rel="alternate" type="text/html" title="TorchVçš„RAGå®è·µåˆ†äº«(äºŒ)ï¼šåŸºäºElasticSearchçš„æ··åˆæ£€ç´¢å®æˆ˜&amp;amp;åŸç†åˆ†æ" /><published>2023-12-27T00:00:00+08:00</published><updated>2023-12-27T00:00:00+08:00</updated><id>http://localhost:4000/2023/12/27/torchv-rag-2</id><content type="html" xml:base="http://localhost:4000/2023/12/27/torchv-rag-2/">&lt;h2 id=&quot;æ¦‚è¿°&quot;&gt;æ¦‚è¿°&lt;/h2&gt;

&lt;p&gt;åœ¨æ˜¨å¤©å‘˜å¤–åˆ†äº«çš„&lt;a href=&quot;https://mp.weixin.qq.com/s/62b8DMfbnqGDJsCx4MwXeg&quot;&gt;ã€ŠTorchVçš„RAGå®è·µåˆ†äº«ï¼ˆ1ï¼‰â€”â€”RAGçš„å®šä½ã€æŠ€æœ¯é€‰å‹å’ŒRAGæŠ€æœ¯æ–‡ç« ç›®å½•ã€‹&lt;/a&gt;ä¸€æ–‡ä¸­ä»‹ç»äº†&lt;strong&gt;TorchV&lt;/strong&gt;çš„ç”±æ¥ï¼Œä¹Ÿåˆ†äº«äº†æˆ‘ä»¬çš„å‡ ä¸ªåŸºçº¿äº§å“å’Œåº”ç”¨æ¶æ„çš„æ–¹å‘ï¼Œæˆ‘ä»¬æƒ³çš„æ˜¯åœ¨åˆ›ä¸šçš„è¿‡ç¨‹ä¸­ï¼Œå°†æˆ‘ä»¬è‡ªå·±çš„ä¸€äº›äº§å“ç†å¿µã€æŠ€æœ¯å¿ƒå¾—éƒ½é€šè¿‡å…¬ä¼—å·å‘æ–‡çš„æ–¹å¼åˆ†äº«å‡ºæ¥ï¼Œæ›´å¤šçš„å’Œè¡Œä¸šå†…çš„ä¸“å®¶ä»¬å…±åŒäº¤æµï¼Œè¿™å¯¹æˆ‘ä»¬è‡ªå·±ä¹Ÿæ˜¯ä¸€ç§æå‡å’Œé”»ç‚¼ï¼Œä¹ŸæœŸå¾…å’Œå®¢æˆ·ä¸€èµ·å…±åˆ›æˆé•¿ï¼Œé€æ­¥æŠŠäº§å“æ‰“ç£¨å¥½ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ç›®å‰å¤§æ¨¡å‹åº”ç”¨æŠ€æœ¯æ¶æ„ä¸­ï¼Œé€šè¿‡å¬å›ä¸Šä¸‹æ–‡æ¥å›ç­”ç”¨æˆ·çš„é—®é¢˜æ˜¯è§£å†³å¤§æ¨¡å‹å½“ä¸‹çš„å¹»è§‰é—®é¢˜æœ€é è°±/ç»æµå®æƒ çš„ä¸€ç§è§£å†³æ–¹æ¡ˆ,RAGæ£€ç´¢å¢å¼ºæŠ€æœ¯åœ¨æ•´ä¸ªLLMæŠ€æœ¯æ¶æ„ä½“ç³»ä¸­çš„ä½œç”¨è¶Šæ¥è¶Šæ˜æ˜¾ã€‚è€Œæ£€ç´¢å¬å›å’Œç”¨æˆ·çš„queryé—®å¥çš„è´¨é‡åˆ™ç›´æ¥å…³ç³»åˆ°æœ€ç»ˆå¤§æ¨¡å‹çš„ç”Ÿæˆç»“æœã€‚åœ¨å‘é‡æ•°æ®åº“åŸºç¡€è®¾æ–½æ™®åŠçš„ä»Šå¤©ï¼Œä»…ä»…é€šè¿‡è¯­ä¹‰æœç´¢å¬å›å·²ç»æ— æ³•æ»¡è¶³ä¼ä¸šçº§çš„éœ€æ±‚ï¼Œå¤§å®¶å‘ç°ä¼ ç»Ÿçš„æœç´¢æŠ€æœ¯(åŸºäºå…³é”®è¯ã€è¯é¢‘ç­‰ç›¸å…³æ€§çš„æœç´¢)çš„ä½œç”¨ä¹Ÿæ˜¾å¾—å°¤ä¸ºé‡è¦ï¼Œæ··åˆæ£€ç´¢ä¹Ÿæˆä¸ºäº†ç›®å‰åœ¨RAGçš„æŠ€æœ¯æ¶æ„ä¸­çš„ä¸»æµæ£€ç´¢æ–¹å¼ï¼Œæ··åˆæ£€ç´¢é€šè¿‡æ‰¬é•¿é¿çŸ­çš„æ–¹å¼ï¼Œåœ¨ä¸åŒçš„ä¸šåŠ¡åº”ç”¨åœºæ™¯ä¸­å½¢æˆäº†å¾ˆå¥½çš„äº’è¡¥ï¼Œå¯¹äºä¸åŒçš„ä¸šåŠ¡åœºæ™¯éœ€æ±‚ä¸­ï¼Œå¯ä»¥æ›´çµæ´»çš„è¿›è¡Œé…ç½®æ»¡è¶³ä¸šåŠ¡éœ€è¦ï¼Œæ˜¯RAGæŠ€æœ¯æ¶æ„ä½“ç³»ä¸­éå¸¸é‡è¦çš„é‡è¦ä¸€ç¯ã€‚&lt;/p&gt;

&lt;p&gt;æœ¬æ–‡ä¸­æ‰€æåˆ°çš„æ··åˆæ£€ç´¢ä¸»è¦æ˜¯ä¸¤ç§æœç´¢æŠ€æœ¯çš„ç»“åˆï¼Œä¸»è¦å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ç›¸å…³æ€§æœç´¢ï¼š&lt;/strong&gt; åŸºäºBM25ã€TF-IDFç®—æ³•ï¼Œä¸»è¦é€‚ç”¨äºæ–‡æœ¬ç²¾ç¡®åŒ¹é…çš„ç›¸å…³æ€§åŒ¹é…æœç´¢ï¼Œå®ƒåœ¨åŒ¹é…ç‰¹å®šæœ¯è¯­ï¼ˆå¦‚äº§å“åæˆ–ä¸“ä¸šæœ¯è¯­ï¼‰æ–¹é¢è¡¨ç°å‡ºè‰²ï¼Œä½†å¯¹æ‹¼å†™é”™è¯¯å’ŒåŒä¹‰è¯è¾ƒä¸ºæ•æ„Ÿï¼Œå¯èƒ½ä¼šå¿½ç•¥ä¸€äº›é‡è¦çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;è¯­ä¹‰æœç´¢ï¼š&lt;/strong&gt; åŸºäºå‘é‡çš„Knnç®—æ³•è¿›è¡Œçš„è¯­ä¹‰æ£€ç´¢ï¼Œå®ƒèƒ½å¤ŸåŸºäºç”¨æˆ·çš„queryè¯­ä¹‰å«ä¹‰è¿›è¡Œå¤šè¯­è¨€å’Œå¤šæ¨¡æ€æœç´¢ï¼Œå¯¹æ‹¼å†™é”™è¯¯å…·æœ‰è¾ƒå¥½çš„å®¹é”™æ€§ï¼Œä½†å¯èƒ½ä¼šå¿½è§†å…³é”®è¯ã€‚æ­¤å¤–ï¼Œå®ƒçš„æ•ˆæœä¾èµ–äºå‘é‡åµŒå…¥çš„è´¨é‡ï¼Œå¹¶å¯¹éä¸“ä¸šé¢†åŸŸçš„æœ¯è¯­è¾ƒä¸ºæ•æ„Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æœ¬æ–‡é’ˆå¯¹ElasticSearchä¸­é—´ä»¶æ¥å®ç°æ•´ä¸ªå¤–éƒ¨çŸ¥è¯†åº“å‘é‡çš„å­˜å‚¨å’Œè®¡ç®—ï¼Œåœ¨RAGæŠ€æœ¯æ¶æ„ä¸­çš„æ··åˆæ£€ç´¢è¿›è¡Œæ¢ç´¢å’Œåˆ†æï¼Œç»“åˆæˆ‘ä»¬è‡ªå·±çš„å®é™…ä¸šåŠ¡æƒ…å†µï¼Œå¦‚ä½•é€šè¿‡åº•å±‚çš„æŠ€æœ¯é©±åŠ¨ï¼Œå®Œå–„æˆ‘ä»¬çš„äº§å“è®¾è®¡ï¼Œæ”¹å–„æ•´ä¸ªäº§å“æµç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;æ•´ç¯‡æ–‡ç« ä¸»è¦åŒ…æ‹¬ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ç®€ä»‹ï¼šç®€è¦æ¦‚è¿°ElasticSearchä¸­é—´ä»¶ä»¥åŠåœ¨RAGæŠ€æœ¯æ¶æ„çš„é€‰å‹åŠå®ç°&lt;/li&gt;
  &lt;li&gt;ç®—æ³•ç†è®ºï¼šå‚æ•°åœ¨æ··åˆæ£€ç´¢è¿‡ç¨‹ä¸­æ¶‰åŠçš„ç®—æ³•ç†è®ºçŸ¥è¯†ï¼Œé¢å‘çš„ä¸šåŠ¡åœºæ™¯åŠé€‰æ‹©æ–¹å¼&lt;/li&gt;
  &lt;li&gt;å¬å›Scoreåˆ†å€¼è®¡ç®—ï¼šè®²è§£ElasticSearchç»„ä»¶åœ¨å¬å›è®¡ç®—è¿‡ç¨‹ä¸­çš„Scoreåˆ†å€¼è§„åˆ™åŠç®—æ³•ç»†èŠ‚&lt;/li&gt;
  &lt;li&gt;TorchVäº§å“é©±åŠ¨ï¼šæŠ€æœ¯æ¨åŠ¨æˆ‘ä»¬TorchVäº§å“çš„äº§å“æ¶æ„è®¾è®¡ï¼Œå¦‚ä½•å½±å“äº§å“æµç¨‹&lt;/li&gt;
  &lt;li&gt;ç»“è®ºï¼šæ•´ç¯‡çš„æ€»ç»“æ¦‚è¿°åŠå‚è€ƒæ–‡ç« &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;elasticsearchç®€ä»‹&quot;&gt;ElasticSearchç®€ä»‹&lt;/h2&gt;

&lt;p&gt;åœ¨ä»‹ç»ElasticSearchçš„æ··åˆæ£€ç´¢ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç®€å•å›é¡¾ElasticSearchè¿™ä¸ªä¸­é—´ä»¶å¦‚ä½•åœ¨ç›®å‰AIæŠ€æœ¯åœºæ™¯çš„è½åœ°æƒ…å†µ&lt;/p&gt;

&lt;p&gt;åœ¨ç›®å‰çš„RAGå¤§æ¨¡å‹æŠ€æœ¯æ¶æ„ä½“ç³»ä¸­ï¼Œå‘é‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Vector&lt;/code&gt;æŠ€æœ¯å·²ç»ä½œä¸ºå¤§æ¨¡å‹å¤–æŒ‚çŸ¥è¯†åº“çš„éå¸¸é‡è¦çš„æŠ€æœ¯æ ˆï¼Œå‘é‡çš„æ ¸å¿ƒå¯¹äºæ•°æ®çš„è¡¨å¾(Embedding)ç„¶åæ‰§è¡Œç›¸ä¼¼åº¦(Similarity)è®¡ç®—ã€‚2023å¹´éšç€å¤§æ¨¡å‹æŠ€æœ¯çš„å‘å¸ƒå¸¦ç«äº†éå¸¸å¤šçš„å‘é‡æ•°æ®åº“ï¼Œç‰¹åˆ«æ˜¯&lt;a href=&quot;https://python.langchain.com/docs/get_started/introduction&quot;&gt;LangChain&lt;/a&gt;ã€&lt;a href=&quot;https://docs.llamaindex.ai/en/stable/&quot;&gt;llama_index&lt;/a&gt;ç­‰LLMæ•°æ®åº”ç”¨æ¡†æ¶çš„å‘å¸ƒï¼ŒåŒ…æ‹¬:&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Milvus&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Qdrant&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Pinecone&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Chroma&lt;/code&gt;ç­‰ç­‰ä¸“ä¸šçš„å‘é‡æ•°æ®åº“ä¸­é—´ä»¶ã€‚å‘é‡æ•°æ®ç»“æ„çš„å­˜å‚¨ä¸è®¡ç®—å¯ä»¥è¯´æ˜¯å½“å‰åšå¤§æ¨¡å‹åº”ç”¨çš„åŸºå»ºäº§å“äº†ï¼Œå°±å¥½åƒä¼ ç»Ÿè½¯ä»¶å·¥ç¨‹ä¸­çš„æ•°æ®åº“ä¸€æ ·ã€‚&lt;/p&gt;

&lt;p&gt;è€Œå¯¹äºElasticSearchè€Œè¨€ä¹ŸåŒæ ·å¦‚æ­¤ï¼Œå¯¹äºä¹‹å‰ä½¿ç”¨ElasticSearchä¸­é—´ä»¶çš„å¼€å‘äººå‘˜è€Œè¨€ï¼Œå¯èƒ½å¯¹äºå‘é‡æ•°æ®çš„å­˜å‚¨å’Œè®¡ç®—æ˜¯æ¯”è¾ƒé™Œç”Ÿçš„ï¼Œåœ¨ä¼ ç»Ÿè½¯ä»¶å·¥ç¨‹ç”¨ESæ¥å‚¨å­˜æœç´¢ä¸»è¦è¿˜æ˜¯åŸºäºå…³é”®è¯æœç´¢æŠ€æœ¯(BM25ã€TF-IDF)ç­‰å®ç°ï¼Œæœ¬è´¨è¿˜æ˜¯åŸºäºæ–‡æœ¬çš„ç²¾ç¡®åŒ¹é…ã€‚è€Œåœ¨æœ€è¿‘ESç»„ä»¶å‘å¸ƒçš„ç‰ˆæœ¬æ¥çœ‹ï¼Œç‰¹åˆ«æ˜¯ES 8.0ç‰ˆæœ¬å‘å¸ƒå¯¹äºKNNç®—æ³•æœç´¢çš„ä¼˜åŒ–æ”¯æŒæ¥çœ‹ï¼ŒAIå¤§æ¨¡å‹è¿™åœºæŠ€æœ¯é©å‘½é£æš´ï¼Œä¼¼ä¹ä¹Ÿä¸æƒ³è¢–æ‰‹æ—è§‚ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬é€‰æ‹©ElasticSearchä½œä¸ºTorchVçš„åŸºç¡€RAGæ¶æ„ç»„ä»¶ä¹Ÿæ˜¯å‡ºäºä»¥ä¸‹å‡ ä¸ªæ–¹é¢è€ƒè™‘ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å¼€ç®±å³ç”¨çš„è¯­ä¹‰æœç´¢åŠŸèƒ½ä»¥åŠä¸€æµçš„ç›¸å…³æ€§æ£€ç´¢(BM25/TF-IDF)ç®—æ³•å®ç°&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åŒºåˆ«äºå…¶å®ƒå‘é‡æ•°æ®åº“æ‰€ä¸å…·å¤‡çš„ç‰¹æœ‰åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼šèšåˆã€è¿‡æ»¤ã€é›†ç¾¤ã€åˆ†å¸ƒå¼ç­‰ç­‰ç‰¹æ€§ã€‚&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¤šå¹´çš„æŠ€æœ¯æ²‰æ·€å’Œç¤¾åŒºå‘å±•ï¼Œä¸åŒç¼–ç¨‹è¯­è¨€çš„ç”Ÿæ€å®Œå–„æˆç†Ÿåº¦ç­‰&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨ElasticSearchçš„ç›®å‰çš„ç‰ˆæœ¬ä¸­ï¼Œè¦ä½¿ç”¨å‘é‡å®ç°å­˜å‚¨å’Œè®¡ç®—å¯¹äºå¼€å‘è€…ä½¿ç”¨ä¸Šéå¸¸ç®€å•ï¼Œå¼€å‘è€…åœ¨å®šä¹‰ESçš„ç´¢å¼•ç»“æ„æ—¶ï¼Œå®šä¹‰å‘é‡å­—æ®µç±»å‹&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dense_vector&lt;/code&gt;,å¹¶ä¸”è‡ªå®šä¹‰å‘é‡ç»´åº¦&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dims&lt;/code&gt;(æœ€å¤§ç»´åº¦ä¸è¶…è¿‡4096(è‡ª8.xç‰ˆæœ¬å¼€å§‹))ï¼Œå¦‚ä¸‹ç´¢å¼•ç»“æ„ï¼š&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;PUT&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;-001&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;mappings&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;properties&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;my_vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;dense_vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;dims&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;my_text&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyword&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åœ¨æ‰§è¡Œæœç´¢æ—¶åˆ™å¯ä»¥é€šè¿‡&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/8.0/knn-search.html&quot;&gt;k-æœ€è¿‘é‚»(KNN)æœç´¢&lt;/a&gt;æ‰¾åˆ°ä¸æŸ¥è¯¢å‘é‡æœ€è¿‘çš„Kä¸ªå‘é‡ç»“æœå€¼æ¥è·å–ç»“æœï¼Œé€šè¿‡ç›¸ä¼¼åº¦å€¼æ¥è¡¡é‡è·å–æ–‡æ¡£ç‰‡æ®µã€‚&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;GET&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;-001&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;/_knn_search&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;knn&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;field&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;my_vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;query_vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;k&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;num_candidates&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;_source&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;date&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è€Œæˆ‘ä»¬åœ¨å‰é¢æåˆ°ï¼Œ&lt;strong&gt;æ··åˆæ£€ç´¢&lt;/strong&gt;(è¯­ä¹‰æœç´¢+ç›¸å…³æ€§æœç´¢)æ˜¯ç›®å‰åšRAGçš„éå¸¸é‡è¦æ–‡æ¡£å¬å›æŠ€æœ¯æ‰‹æ®µï¼Œçº¯KNNæœç´¢å¹¶ä¸èƒ½å®Œå…¨æ»¡è¶³ä¸šåŠ¡çš„éœ€æ±‚ï¼Œå› æ­¤åœ¨å½“å‰çš„RAGæŠ€æœ¯æ¶æ„ä½“ç³»ä¸­ï¼ŒESåœ¨ä¿æŒä¼ ç»Ÿç›¸å…³æ€§æœç´¢çš„åŸºç¡€ä¸Šï¼Œå¢åŠ å¯¹è¯­ä¹‰æœç´¢çš„æŠ€æœ¯æ”¯æŒå°±æ˜¾å¾—å¾ˆæœ‰å†²å‡»åŠ›ï¼Œæ¯•ç«Ÿåœ¨å‘é‡æœç´¢ç«çˆ†ä¹‹å‰ï¼ŒESä½œä¸ºæœç´¢å¼•æ“çš„è€å¤§å“¥ï¼Œåœ¨ä¼ä¸šçº§çš„äº§å“åº”ç”¨ä½“ç³»ä¸­ï¼Œåº”ç”¨èŒƒå›´è¿˜æ˜¯éå¸¸å¹¿æ³›çš„ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ç®—æ³•ä¸šåŠ¡åœºæ™¯&quot;&gt;ç®—æ³•&amp;amp;ä¸šåŠ¡åœºæ™¯&lt;/h2&gt;

&lt;p&gt;åœ¨åšæ··åˆæ£€ç´¢æ—¶ï¼Œæˆ‘ä»¬ä¼šæ¥è§¦åˆ°ä¸¤ç±»ç®—æ³•ï¼Œéœ€è¦å¯¹ç®—æ³•æœ‰ä¸€ä¸ªåŸºç¡€äº†è§£ï¼Œè¿™æœ‰åŠ©äºæˆ‘ä»¬åœ¨åº”ç”¨äº§å“çš„æŠ€æœ¯ä½“ç³»ä¸­åšå†³ç­–ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;è¯­ä¹‰æ£€ç´¢ï¼šåŸºäºå‘é‡ç©ºé—´çš„KNNç®—æ³•&lt;/li&gt;
  &lt;li&gt;ç›¸å…³æ€§æ£€ç´¢ï¼šä¼ ç»Ÿçš„æ–‡æœ¬ç²¾ç¡®åŒ¹é…æ–¹æ³•ï¼ŒåŒ…æ‹¬BM25ã€TF-IDF&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;è¯­ä¹‰æ£€ç´¢knn&quot;&gt;è¯­ä¹‰æ£€ç´¢(knn)&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm&quot;&gt;KNNç®—æ³•&lt;/a&gt;&lt;/strong&gt;ï¼škè¿‘é‚»ç®—æ³•ï¼Œæ˜¯æœºå™¨å­¦ä¹ ç®—æ³•ä¸­ä¸€ç§&lt;strong&gt;åŸºæœ¬åˆ†ç±»å’Œå›å½’æ–¹æ³•&lt;/strong&gt;ã€‚åœ¨ç»™å®šçš„ä¸€ä¸ªæ•°æ®é›†ä¸­ï¼Œå¯¹äºæ–°çš„æ•°æ®å®ä¾‹ï¼Œæ‰¾åˆ°ä¸è¯¥å®ä¾‹æœ€é‚»è¿‘çš„kä¸ªå®ä¾‹ï¼Œè¿™kä¸ªå®ä¾‹çš„å¤šæ•°å±äºæŸä¸ªåˆ†ç±»ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;è¿™å°±åƒä½ åœ¨ä¸€ä¸ªé™Œç”Ÿçš„åŸå¸‚ï¼Œä½ å¯èƒ½ä¼šé—®å‘¨å›´çš„kä¸ªäººå“ªå®¶é¤é¦†æœ€å¥½ã€‚å¦‚æœå¤§å¤šæ•°äººéƒ½æ¨èåŒä¸€å®¶é¤é¦†ï¼Œé‚£ä¹ˆä½ å¯èƒ½ä¼šé€‰æ‹©å»é‚£å®¶é¤é¦†ã€‚&lt;/p&gt;

  &lt;p&gt;è€Œæˆ‘ä»¬åœ¨é€‰æ‹©é¤é¦†çš„è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€ä¸ªé¤é¦†ä¼šæœ‰éå¸¸å¤šçš„ç»´åº¦æ¥æè¿°è¿™ä¸ªé¤é¦†çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼šåœ°ç†ä½ç½®ã€èœç³»ã€ä»·æ ¼ã€ç¯å¢ƒã€å£å‘³ç­‰ç­‰ï¼Œè¿™ä¸€ç³»åˆ—å‚æ•°å±æ€§å°±æ˜¯ç‰¹å¾å·¥ç¨‹ï¼Œç›®å‰çš„å‘é‡Embeddingæ¨¡å‹ç”¨æ¥å¯¹ä¸€æ®µæ–‡æœ¬è¿›è¡ŒEmbeddingï¼Œå…¶å®å°±æ˜¯å¯¹äºè¯¥æ–‡æœ¬å†…å®¹çš„çš„ç‰¹å¾ä¿¡æ¯è¿›è¡Œæå–æè¿°ã€‚&lt;/p&gt;

  &lt;p&gt;è¿™ä¸ªæ—¶å€™ï¼Œä½ ä¼šæ ¹æ®ä½ è‡ªå·±çš„è¯‰æ±‚ï¼Œå¯¹äºé¤é¦†çš„ä¸åŒç‰¹å¾è¦æ±‚ï¼Œæœ€ç»ˆé€‰æ‹©ä½ è¦å»å“ªå®¶é¤é¦†åƒé¥­ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-2/KnnClassification.svg&quot; alt=&quot;å›¾1-KNNç®—æ³•å›¾ä¾‹&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨Elasticsearchä¸­ï¼ŒKNNæœç´¢ä¸»è¦é€šè¿‡ä½¿ç”¨å‘é‡ç›¸ä¼¼åº¦(ç‰¹å¾ç©ºé—´ä¸­çš„ä¸¤ä¸ªå®ä¾‹ç‚¹é—´çš„è·ç¦»å¯ä»¥åæ˜ å‡ºä¸¤ç‚¹é—´çš„ç›¸ä¼¼ç¨‹åº¦)è¿›è¡Œåº¦é‡ï¼Œæ–‡æ¡£æ ¹æ®å‘é‡æ•°æ®é›†ä¸æŸ¥è¯¢å‘é‡çš„ç›¸ä¼¼åº¦è¿›è¡Œæ’åã€‚æ¯ä¸ªæ–‡æ¡£çš„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_score&lt;/code&gt; å°†ä»ç›¸ä¼¼åº¦ä¸­å¾—å‡ºï¼Œä»¥ç¡®ä¿åˆ†æ•°ä¸ºæ­£å¹¶ä¸”åˆ†æ•°è¶Šé«˜å¯¹åº”äºè¶Šé«˜çš„æ’åã€‚&lt;/p&gt;

&lt;p&gt;ESç›®å‰ä¸»è¦æä¾›äº†ä¸‰ç§åº¦é‡çš„æ ‡å‡†ä¾›æˆ‘ä»¬é€‰æ‹©(è€ƒè™‘åˆ°æœ¬æ–‡æ˜¯åŸºäºesï¼Œå› æ­¤ä¹Ÿåªå¯¹è¯¥ä¸‰ç§åº¦é‡æ ‡å‡†åšä»‹ç»ï¼Œå¯¹äºå…¶å®ƒçš„å‘é‡è®¡ç®—è·ç¦»çš„æ–¹å¼ï¼Œå¼€å‘è€…å¯ä»¥è‡ªè¡Œæœç´¢äº†è§£)&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;L2_norm&lt;/strong&gt;(æ¬§å¼è·ç¦»)ï¼šè¿™æ˜¯æœ€å¸¸ç”¨çš„è·ç¦»åº¦é‡æ–¹å¼ï¼Œå®ƒè®¡ç®—çš„æ˜¯ä¸¤ä¸ªå‘é‡åœ¨ç¬›å¡å°”åæ ‡ç³»ä¸­çš„ç›´çº¿è·ç¦»ã€‚æ–‡æ¡£çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;score&lt;/code&gt;è®¡ç®—æ–¹å¼ä¸ºï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;1 / (1 + l2_norm(query, vector)^2)&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;dot_product&lt;/strong&gt;(ç‚¹ç§¯)ï¼šç‚¹ç§¯æ˜¯ä¸¤ä¸ªå‘é‡çš„å¯¹åº”å…ƒç´ ç›¸ä¹˜ç„¶åæ±‚å’Œï¼Œæ–‡æ¡£ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_score&lt;/code&gt; è®¡ç®—ä¸º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(1 + dot_product(query, vector)) / 2&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;cosine&lt;/strong&gt;(ä½™å¼¦ç›¸ä¼¼åº¦,&lt;strong&gt;default&lt;/strong&gt;)ï¼šè®¡ç®—ä¸¤ä¸ªå‘é‡ä½™å¼¦ç›¸ä¼¼åº¦ï¼Œä½™å¼¦ç›¸ä¼¼æ€§åº¦é‡çš„æ˜¯ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„è§’åº¦ï¼Œè€Œä¸æ˜¯è·ç¦»ã€‚å®ƒçš„å€¼èŒƒå›´æ˜¯ -1 åˆ° 1ï¼Œå€¼è¶Šæ¥è¿‘ 1ï¼Œè¡¨ç¤ºä¸¤ä¸ªå‘é‡è¶Šç›¸ä¼¼ï¼Œæ–‡æ¡£ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_score&lt;/code&gt; è®¡ç®—ä¸º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(1 + cosine(query, vector)) / 2&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æˆ‘ä»¬åœ¨å¼€å‘RAGçš„å¤§æ¨¡å‹åº”ç”¨äº§å“ä¸­ï¼Œé€šå¸¸ä¼šå°†å¤–éƒ¨çš„çŸ¥è¯†åº“é€šè¿‡chunkåˆ†æ®µå­˜å‚¨å¤„ç†ï¼Œå¯¹äºç”¨æˆ·çš„queryï¼Œé€šè¿‡Embeddingæ¨¡å‹è¿›è¡Œè¡¨å¾ä¸ºå‘é‡åï¼Œä¸chunkç‰‡æ®µçš„å‘é‡è¿›è¡Œè·ç¦»è®¡ç®—ï¼Œæ­¤æ—¶ä½œä¸ºè·ç¦»åº¦é‡çš„æ–¹å¼è€ƒè™‘ï¼Œé‚£ä¹ˆæ ¹æ®å®é™…çš„ä¸šåŠ¡åœºæ™¯ï¼Œå°±å¯ä»¥è€ƒè™‘ä¸Šé¢çš„ä¸‰ç§ç±»å‹ä¸­çš„ä¸€ç§ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€èˆ¬é»˜è®¤é€‰æ‹©&lt;strong&gt;cosineä½™å¼¦ç›¸ä¼¼åº¦&lt;/strong&gt;è¿›è¡Œè®¡ç®—å¬å›ï¼Œä¸»è¦è€ƒè™‘ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;é•¿åº¦ä¸æ•æ„Ÿ&lt;/strong&gt;ï¼šåœ¨æ–‡æœ¬æ•°æ®ä¸­ï¼Œæ–‡æ¡£çš„é•¿åº¦å¯èƒ½ä¼šæœ‰å¾ˆå¤§çš„å·®å¼‚ï¼Œè¿™ä¼šå½±å“åˆ°å‘é‡çš„é•¿åº¦ã€‚ä½™å¼¦ç›¸ä¼¼æ€§åªå…³æ³¨å‘é‡çš„æ–¹å‘ï¼Œè€Œä¸å…³æ³¨é•¿åº¦ï¼Œå› æ­¤å®ƒå¯¹å°ºåº¦ä¸æ•æ„Ÿï¼Œé€‚åˆå¤„ç†è¿™ç§æƒ…å†µ(è™½ç„¶æˆ‘ä»¬åœ¨ä½¿ç”¨å‘é‡Embeddingæ¨¡å‹è¿›è¡Œè¡¨å¾æ—¶ï¼Œå‘é‡çš„ç»´åº¦éƒ½æ˜¯å›ºå®šçš„)ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ–¹å‘æ•æ„Ÿ&lt;/strong&gt;ï¼šåœ¨é—®ç­”ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å…³å¿ƒçš„æ˜¯æ–‡æ¡£çš„ä¸»é¢˜æˆ–è€…å†…å®¹æ˜¯å¦ç›¸ä¼¼ï¼Œè€Œä¸æ˜¯æ–‡æ¡£çš„é•¿åº¦ã€‚ä½™å¼¦ç›¸ä¼¼æ€§åº¦é‡çš„æ˜¯ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„è§’åº¦ï¼Œå¯ä»¥å¾ˆå¥½åœ°åæ˜ å‡ºæ–‡æ¡£çš„ä¸»é¢˜æˆ–è€…å†…å®¹æ˜¯å¦ç›¸ä¼¼ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;é«˜ç»´æ•°æ®&lt;/strong&gt;ï¼šå‘é‡Embeddingæ¨¡å‹è¡¨å¾çš„é«˜ç»´åº¦(768/1024/1536â€¦ç­‰ç­‰)å‘é‡ï¼Œé€‚åˆä½™å¼¦ç›¸ä¼¼æ€§é€‚åˆå¤„ç†è¿™ç§é«˜ç»´ç¨€ç–çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è€ŒESè‡ª8.0ç‰ˆæœ¬å‘å¸ƒåï¼ŒåŒæ ·ä¹Ÿæä¾›äº†å¯¹&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/knn-search.html&quot;&gt;KNNæœç´¢&lt;/a&gt;çš„ä¼˜åŒ–ï¼Œä¸»è¦æä¾›äº†ä¸¤ç§ç­–ç•¥ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;è¿‘é‚»KNNæœç´¢ç®—æ³•(&lt;strong&gt;ANN&lt;/strong&gt;)ï¼šæ•°æ®ç»“æ„åŸºäº&lt;a href=&quot;https://www.luxiangdong.com/2023/11/06/hnsw/&quot;&gt;HNSWç®—æ³•&lt;/a&gt;ç´¢å¼•å®ç°ï¼Œè¿‘ä¼¼ kNN æä¾›è¾ƒä½çš„å»¶è¿Ÿï¼Œä½†ä»£ä»·æ˜¯ç´¢å¼•é€Ÿåº¦è¾ƒæ…¢ä¸”å‡†ç¡®æ€§ä¸å®Œå–„(è¿™ä¹Ÿä¸ºåæ¥RAGæ¶æ„ä¸­çš„æ–‡æ¡£æ£€ç´¢ç»“æœåšReRanké‡æ’åŸ‹ä¸‹ä¼ç¬”ï¼Œå¯ä»¥å…³æ³¨å‘˜å¤–çš„è¿™ç¯‡&lt;a href=&quot;https://mp.weixin.qq.com/s/4UoRi8VhQjfE7zcpFnre4A&quot;&gt;ã€ŠRerankâ€”â€”RAGä¸­ç™¾å°ºç«¿å¤´æ›´è¿›ä¸€æ­¥çš„ç¥å™¨ï¼Œä»åŸç†åˆ°è§£å†³æ–¹æ¡ˆã€‹&lt;/a&gt;)ã€‚&lt;/li&gt;
  &lt;li&gt;ç²¾ç¡®ã€å¼ºåŠ›çš„ kNNæœç´¢(&lt;strong&gt;æš´åŠ›æœç´¢&lt;/strong&gt;)ï¼šåŸºäºå‡½æ•°å®ç°ï¼Œè¿™ç§æ–¹å¼èƒ½å¤Ÿä¿è¯ç»“æœçš„å‡†ç¡®æ€§ï¼Œé€šè¿‡è®¡ç®—&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;script_score&lt;/code&gt; å‡½æ•°æ‰«ææ¯ä¸ªåŒ¹é…æ–‡æ¡£è®¡ç®—å‘é‡è·ç¦»è·å–æ–‡æ¡£ç»“æœé›†ï¼Œè¿™ä¼šå¯¼è‡´æœç´¢é€Ÿåº¦ç¼“æ…¢(å¤§æ•°æ®é›†çš„åº”ç”¨åœºæ™¯ä¸‹)ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¼€å‘è€…åœ¨é€‰æ‹©KNNæœç´¢çš„ç®—æ³•ç­–ç•¥æ—¶ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…ä¸šåŠ¡éœ€è¦è¿›è¡ŒæŠ‰æ‹©ã€‚&lt;/p&gt;

&lt;h3 id=&quot;ç›¸å…³æ€§æ£€ç´¢bm25tf-idf&quot;&gt;ç›¸å…³æ€§æ£€ç´¢(BM25/TF-IDF)&lt;/h3&gt;

&lt;p&gt;ESè‡ª5.0ç‰ˆæœ¬ä¹‹åï¼Œé’ˆå¯¹æ–‡æ¡£çš„ç›¸å…³æ€§è¯„åˆ†æœºåˆ¶é»˜è®¤é‡‡ç”¨äº†BM25ç›¸ä¼¼åº¦ç®—æ³•(ä¹‹å‰æ˜¯åŸºäºTF-IDF)ï¼ŒBM25å…¨ç§°&lt;a href=&quot;https://en.wikipedia.org/wiki/Okapi_BM25&quot;&gt;Okapi BM25&lt;/a&gt;ã€‚Okapi æ˜¯ä½¿ç”¨å®ƒçš„ç¬¬ä¸€ä¸ªç³»ç»Ÿçš„åç§°ï¼Œå³Okapiä¿¡æ¯æ£€ç´¢ç³»ç»Ÿ,äº 20 ä¸–çºª 80 å¹´ä»£å’Œ 1990 å¹´ä»£åœ¨ä¼¦æ•¦åŸå¸‚å¤§å­¦å®æ–½ã€‚ BMåˆ™æ˜¯best matchingçš„ç¼©å†™ã€‚&lt;/p&gt;

&lt;p&gt;å› æ­¤å¯¹äºè¯çš„ç›¸å…³æ€§æ£€ç´¢æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯¹äºTF-IDFå’ŒBM25ä¹Ÿéœ€è¦æœ‰ä¸€ä¸ªåŸºç¡€çš„äº†è§£ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;TF-IDF(Term Frequency-Inverse Document Frequency)&lt;/strong&gt;:è¯é¢‘-é€†æ–‡æ¡£é¢‘ç‡æ˜¯ä¸€ä¸ªå¸¸ç”¨äºä¿¡æ¯æ£€ç´¢å’Œæ–‡æœ¬æŒ–æ˜çš„æƒé‡è®¡ç®—æ–¹æ³•ï¼Œå‡½æ•°å…¬å¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-2/tf_idf.png&quot; alt=&quot;tf-idf&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸»è¦ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;TFï¼ˆTerm Frequencyï¼Œè¯é¢‘ï¼‰&lt;/strong&gt;ï¼šè¡¡é‡ä¸€ä¸ªè¯åœ¨æ–‡æ¡£ä¸­å‡ºç°çš„é¢‘ç‡ã€‚å‡è®¾æŸä¸€è¯æ¡åœ¨æ–‡æœ¬ä¸­å‡ºç°çš„æ¬¡æ•°ä¸º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;n&lt;/code&gt;ï¼Œæ–‡æœ¬çš„æ€»è¯æ¡æ•°ä¸º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m&lt;/code&gt;ï¼Œåˆ™è¯é¢‘TFä¸ºn/m,ä¹Ÿå°±æ˜¯è¯é¢‘ï¼Œæ¯”å¦‚ä¸€ä¸ªå•è¯:&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;æ—…æ¸¸&lt;/code&gt;åœ¨æˆ‘ä»¬çš„ä¸€ç¯‡æ–‡æ¡£ä¸­å‡ºç°äº†4æ¬¡ï¼Œè€Œæˆ‘ä»¬çš„æ–‡æ¡£æ€»å…±åŒ…å«çš„è¯æ¡æ•°é‡æ˜¯100ï¼Œé‚£ä¹ˆè¯é¢‘çš„å€¼å°±æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;4/100&lt;/code&gt;ã€‚è¯é¢‘è¶Šé«˜ï¼Œè¯´æ˜è¿™ä¸ªè¯åœ¨æ–‡æ¡£ä¸­è¶Šé‡è¦ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;IDFï¼ˆInverse Document Frequencyï¼Œé€†æ–‡æ¡£é¢‘ç‡ï¼‰&lt;/strong&gt;ï¼šè¡¡é‡ä¸€ä¸ªè¯æ˜¯å¦å¸¸è§çš„åº¦é‡ã€‚å¦‚æœæŸä¸ªè¯åœ¨å¾ˆå¤šæ–‡æ¡£ä¸­éƒ½å‡ºç°ï¼Œé‚£ä¹ˆå®ƒå¯èƒ½å°±ä¸å…·æœ‰åŒºåˆ†èƒ½åŠ›(æ¯”å¦‚å¸¸ç”¨è¯ç­‰)ã€‚å®ƒçš„è®¡ç®—å…¬å¼æ˜¯ï¼šlog(æ–‡æ¡£æ€»æ•°(N) / åŒ…å«è¯¥è¯çš„æ–‡æ¡£æ•°(df))ã€‚é€†æ–‡æ¡£é¢‘ç‡è¶Šå¤§ï¼Œè¯´æ˜è¿™ä¸ªè¯è¶Šä¸å¸¸è§ï¼Œå¯èƒ½å°±è¶Šé‡è¦ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;TF-IDFå°±æ˜¯å°†è¿™ä¸¤ä¸ªå€¼ç›¸ä¹˜ï¼Œå¾—åˆ°çš„ç»“æœå°±æ˜¯ä¸€ä¸ªè¯çš„æƒé‡ï¼Œè¿™ä¸ªæƒé‡å¯ä»¥ç”¨æ¥è¡¨ç¤ºè¿™ä¸ªè¯å¯¹äºæ–‡æ¡£çš„é‡è¦æ€§ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥æ¯”è¾ƒä¸åŒæ–‡æ¡£çš„ç›¸ä¼¼æ€§ã€‚&lt;/p&gt;

&lt;p&gt;TF-IDFåœ¨å®è·µçš„å‘å±•ä¸­ä¼šå­˜åœ¨ä¸€äº›é—®é¢˜:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ–‡æ¡£é•¿åº¦é—®é¢˜ï¼šåœ¨é•¿æ–‡æ¡£ä¸­ï¼ŒæŸä¸ªè¯å¯èƒ½ä¼šå› ä¸ºæ–‡æ¡£æœ¬èº«çš„é•¿åº¦å°±æœ‰æ›´é«˜çš„å‡ºç°æ¬¡æ•°ï¼Œè€Œä¸æ˜¯å› ä¸ºè¿™ä¸ªè¯å¯¹äºæ–‡æ¡£çš„ä¸»é¢˜æ›´é‡è¦ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´TF-IDFå¯¹é•¿æ–‡æ¡£ä¸­çš„è¯ç»™äºˆè¿‡é«˜çš„æƒé‡ï¼Œè€Œå¿½è§†äº†çŸ­æ–‡æ¡£ä¸­çš„é‡è¦è¯&lt;/li&gt;
  &lt;li&gt;è¯é¢‘ä¸é¥±å’Œï¼šåœ¨å®é™…çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œè¯çš„é‡è¦æ€§å¹¶ä¸æ€»æ˜¯éšç€å®ƒçš„å‡ºç°æ¬¡æ•°çº¿æ€§å¢åŠ çš„ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªè¯åœ¨æ–‡æ¡£ä¸­å‡ºç°100æ¬¡å¯èƒ½å¹¶ä¸æ„å‘³ç€å®ƒæ¯”å‡ºç°10æ¬¡çš„è¯10å€é‡è¦ï¼Œç›¸åï¼Œå¯¹äºIDFè€Œè¨€ï¼Œå¦‚æœä¸€ä¸ªè¯åœ¨æ–‡æ¡£é›†ä¸­å‡ºç°çš„æ¬¡æ•°è¶Šå°‘ï¼Œé‚£ä¹ˆå®ƒçš„IDFå€¼å°±è¶Šé«˜ï¼Œè¢«è®¤ä¸ºè¶Šé‡è¦,ä¹Ÿå¹¶éä¸€å®šç¬¦åˆå®é™…ä¸šåŠ¡åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿™äº›é—®é¢˜éƒ½åœ¨BM25ä¸­å¾—åˆ°äº†æ”¹è¿›ï¼ŒBM25çš„è¯é¢‘éƒ¨åˆ†ä½¿ç”¨äº†ä¸€ä¸ªé¥±å’Œå‡½æ•°ï¼Œä½¿å¾—è¯é¢‘è¾¾åˆ°ä¸€å®šå€¼åï¼Œå¢åŠ è¯é¢‘å¯¹äºæœ€ç»ˆå¾—åˆ†çš„å½±å“ä¼šå˜å°ã€‚åŒæ—¶ï¼ŒBM25è¿˜è€ƒè™‘äº†æ–‡æ¡£é•¿åº¦çš„å½±å“ï¼Œé€šè¿‡ä¸€ä¸ªå½’ä¸€åŒ–å› å­æ¥è°ƒæ•´ä¸åŒé•¿åº¦æ–‡æ¡£ä¸­çš„è¯é¢‘ã€‚è¿™ä½¿å¾—BM25åœ¨å¤„ç†è¯é¢‘æœªé¥±å’Œå’Œæ–‡æ¡£é•¿åº¦é—®é¢˜æ—¶ï¼Œæ¯”TF-IDFæœ‰æ›´å¥½çš„æ€§èƒ½ã€‚&lt;/p&gt;

&lt;p&gt;BM25 çš„è®¡ç®—å…¬å¼ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-2/bm25.png&quot; alt=&quot;BM25&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å’ŒTF-IDFçš„è®¡ç®—å…¬å¼ç›¸æ¯”ï¼ŒBM25çš„å…¬å¼ç€å®æœ‰ç‚¹å“äººï¼Œä¸è¿‡å…¶å®æˆ‘ä»¬å…³æ³¨å‡ ä¸ªæ ¸å¿ƒçš„å‚æ•°å³å¯ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;å¯¹äºBM25ç®—æ³•åœ¨ElasticSearchä¸­çš„åº”ç”¨å…¬å¼å’Œå‚æ•°å˜é‡è¯´æ˜ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« &lt;a href=&quot;https://www.elastic.co/cn/blog/practical-bm25-part-2-the-bm25-algorithm-and-its-variables&quot;&gt;ã€ŠBM25 ç®—æ³•åŠå…¶å˜é‡ã€‹&lt;/a&gt;ï¼Œè¿™é‡Œæˆ‘ä»¬åªå…³å¿ƒå‡ ä¸ªæ ¸å¿ƒçš„å‚æ•°&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;k1&lt;/strong&gt;:æ§åˆ¶éçº¿æ€§é¡¹é¢‘ç‡å½’ä¸€åŒ–ï¼ˆè¯é¢‘é¥±å’Œåº¦ï¼‰ã€‚é»˜è®¤å€¼ä¸º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;1.2&lt;/code&gt; ã€‚è¾ƒä½çš„å€¼å¯¼è‡´è¾ƒå¿«çš„é¥±å’Œï¼Œè¾ƒé«˜çš„å€¼å¯¼è‡´è¾ƒæ…¢çš„é¥±å’Œã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-2/elas_1706.png&quot; alt=&quot;Term frequency saturation for TF/IDF and BM25&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;b&lt;/strong&gt;ï¼šè¯¥å‚æ•°æ§åˆ¶å­—æ®µé•¿åº¦å½’ä¸€åŒ–çš„å½±å“ç¨‹åº¦ã€‚bçš„å€¼åœ¨0åˆ°1ä¹‹é—´ï¼Œå½“bä¸º0æ—¶ï¼Œè¡¨ç¤ºå®Œå…¨ä¸è€ƒè™‘å­—æ®µé•¿åº¦çš„å½±å“ï¼›å½“bä¸º1æ—¶ï¼Œè¡¨ç¤ºå®Œå…¨è€ƒè™‘å­—æ®µé•¿åº¦çš„å½±å“ã€‚é»˜è®¤ä¸º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0.75&lt;/code&gt; ã€‚è¿™ä¸ªå‚æ•°å€¼ä¹Ÿæ˜¯é’ˆå¯¹ä¸Šé¢æˆ‘ä»¬æåˆ°TF-IDFåœ¨æ–‡æ¡£é•¿åº¦æœªè€ƒè™‘çš„æƒ…å†µä¸‹ä¸€ä¸ªåŠ æƒè®¡ç®—ï¼Œå½“ç„¶é»˜è®¤å€¼&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0.75&lt;/code&gt;æ˜¯å®˜æ–¹åŸºäºå¤§é‡çš„æ•°æ®å®éªŒå¾—åˆ°çš„ä¸€ä¸ªå€¼ï¼Œåœ¨é»˜è®¤åœºæ™¯ä¸‹éƒ½ä¼šæœ‰è¾ƒå¥½çš„æ•ˆæœï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨è°ƒæ•´ã€‚å¦‚æœæˆ‘ä»¬çš„é»˜è®¤æ£€ç´¢æ•ˆæœä¸ä½³ï¼Œåº”è¯¥ä»å…¶å®ƒæ–¹é¢æ¥è€ƒè™‘ä¼˜åŒ–ï¼Œè¿™ä¸ªåé¢æˆ‘ä»¬å†è¯´&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;scoreåˆ†å€¼è®¡ç®—æ³¨æ„äº‹é¡¹&quot;&gt;Scoreåˆ†å€¼è®¡ç®—&amp;amp;æ³¨æ„äº‹é¡¹&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;åœ¨ç†è§£äº†ç®—æ³•ã€esä¸­é—´ä»¶ä¹‹åï¼Œç»“åˆå®æˆ˜+Scoreåˆ†å€¼çš„è®¡ç®—ä½¿ç”¨è¿‡ç¨‹ï¼ŒåŒ…æ‹¬é…åˆESçš„Explainæ¥å£ï¼Œè®²æ¸…æ¥šScoreçš„è®¡ç®—è§„åˆ™ï¼ŒåŸç†&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;åœ¨å‰é¢äº†è§£äº†ESçš„æ•´ä¸ªæ£€ç´¢Scoreç®—æ³•ä»‹ç»ä¹‹åï¼Œå…¶å®å¯¹äºæ–‡æœ¬å†…å®¹çš„æ£€ç´¢å¬å›Scoreåˆ†å€¼è®¡ç®—ï¼Œå°±æ¯”è¾ƒæ¸…æ™°äº†ï¼Œå…ˆè¯´ç»“è®ºï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ElasticSearchåœ¨ä½¿ç”¨KNN+BM25æ£€ç´¢çš„æ··åˆæ£€ç´¢åˆ†å€¼Scoreè®¡ç®—å…¬å¼æ˜¯ï¼šknn_score+bm25_score&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨ESæ··åˆæ£€ç´¢çš„è¯­æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;POST&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;image-index/_search&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;query&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;match&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;query&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;mountain lake&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;boost&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;knn&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;å­—æ®µ&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;field&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;image-vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;è¾“å…¥å‘é‡&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;query_vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;54&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;-2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;kå€¼&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;k&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;æ¯ä¸ªåˆ†ç‰‡è¦è€ƒè™‘çš„æœ€è¿‘é‚»å±…å€™é€‰æ•°ã€‚ä¸èƒ½è¶…è¿‡&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;000&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;num_candidates&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;åŠ æƒå‚æ•°å€¼&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;boost&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;æ¡£è¢«è§†ä¸ºåŒ¹é…æ‰€éœ€çš„æœ€å°ç›¸ä¼¼åº¦&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;é…åˆfilterä½¿ç”¨ï¼Œæé«˜æ£€ç´¢æ•ˆç‡&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;similarity&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;è¿‡æ»¤æ¡ä»¶&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;filter&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;term&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;file-type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;png&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;size&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;query&lt;/code&gt;éƒ¨åˆ†çš„æ£€ç´¢æ‰€ä»£è¡¨çš„æ˜¯BM25ç®—æ³•çš„Scoreè®¡ç®—åˆ†å€¼å¬å›ï¼Œè€Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;knn&lt;/code&gt;éƒ¨åˆ†çš„æ£€ç´¢æ‰€ä»£è¡¨çš„åˆ™æ˜¯è¯­ä¹‰å‘é‡ç©ºé—´çš„è·ç¦»Scoreåˆ†å€¼ï¼Œæœ€ç»ˆçš„ç»“æœå€¼ç›¸åŠ åå€’æ’çš„ä¸€ä¸ªæ–‡æ¡£åˆ—è¡¨ç»“æœé›†&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;score=&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;match_score*0.9 + knn_score*0.1&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;bm25çš„score&quot;&gt;BM25çš„Score&lt;/h3&gt;

&lt;p&gt;å¯¹äºBM25ç®—æ³•çš„æ£€ç´¢åˆ†å€¼è®¡ç®—ï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/8.11/search-explain.html&quot;&gt;Explain API&lt;/a&gt;æ¥æŸ¥çœ‹æ•´ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Score&lt;/code&gt;çš„è®¡ç®—è¿‡ç¨‹ï¼Œæ•´ä¸ªè®¡ç®—è¿‡ç¨‹å°±å’ŒBM25ç®—æ³•å…¬å¼é‚£æ ·,å¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rag/torchv/rag-2/image-20231227182031006.png&quot; alt=&quot;å›¾2-BM25ç®—æ³•scoreè§£é‡Šæ¥å£&quot; /&gt;&lt;/p&gt;

&lt;p&gt;BM25ç®—æ³•ä¼šå°†ç”¨æˆ·è¾“å…¥çš„matchå‚æ•°ï¼Œè®¡ç®—æ¯ä¸€ä¸ªåˆ†è¯çš„scoreåˆ†å€¼ï¼Œæœ€ç»ˆåŠ èµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªæ€»çš„åˆ†å€¼scoreæ•°æ®ï¼Œå¯¹äºæ¯ä¸€ä¸ªåˆ†è¯ï¼Œéƒ½å¯ä»¥é€šè¿‡è¯¥æ¥å£æŸ¥çœ‹åˆ°å®Œæ•´çš„è®¡ç®—è¿‡ç¨‹ï¼Œæ˜¯éå¸¸æ–¹ä¾¿çš„å¼€å‘è€…è¿›è¡Œç†è§£çš„ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨è¿™é‡Œè¿›è¡ŒBM25è®¡ç®—æ—¶ï¼Œæˆ‘å‰é¢æåˆ°BM25ç®—æ³•å¯èƒ½å­˜åœ¨æ£€ç´¢ä¸åˆ°æœ€ç»ˆæˆ‘ä»¬è¯´æœŸæœ›çš„æ–‡æœ¬ï¼Œä¼šæœ‰ä¸€äº›å…¶å®ƒå‚æ•°å½±å“æœ€ç»ˆæ•ˆæœï¼Œå¹¶ééœ€è¦æ›´æ”¹ç®—æ³•ä¸­çš„k1å’Œbè¿™ä¸¤ä¸ªå‚æ•°ï¼Œä¸»è¦è€ƒè™‘å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ESæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æœç´¢å’Œåˆ†æå¼•æ“ï¼Œæ•°æ®è¢«åˆ†ä¸ºå¤šä¸ªåˆ†ç‰‡ï¼ˆshardsï¼‰ï¼Œæ¯ä¸ªåˆ†ç‰‡å¯ä»¥åœ¨ä»»ä½•èŠ‚ç‚¹ä¸Šå­˜å‚¨ã€‚è¿™ä½¿å¾—æ•°æ®å¯ä»¥åœ¨å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´è¿›è¡Œåˆ†å¸ƒï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å®¹é‡å’Œæ€§èƒ½ï¼Œæœ€ç»ˆæ•°æ®åœ¨å­˜å‚¨æ„å»ºç´¢å¼•çš„æ—¶å€™ï¼Œesä¼šå‡è¡¡çš„è¿›è¡Œåˆ†å¸ƒå­˜å‚¨ï¼Œè€Œåœ¨å¬å›è®¡ç®—çš„è¿‡ç¨‹ä¸­ï¼Œæ•°æ®ä¹Ÿä¼šä»å„ä¸ªshardsåˆ†ç‰‡è¿›è¡Œå¬å›è®¡ç®—ã€‚å¼€å‘è€…åœ¨åˆ›å»ºç´¢å¼•(index)çš„æ—¶å€™ï¼Œå¯ä»¥è®¾ç½®shardsçš„åˆ†ç‰‡ä¸º1æˆ–è€…3ï¼Œæ¥æŸ¥çœ‹åŒºåˆ«ã€‚&lt;/li&gt;
  &lt;li&gt;esé»˜è®¤æä¾›äº†éå¸¸å¤šçš„tokenizeråˆ†è¯å™¨ï¼Œè€Œå¯¹äºä¸­æ–‡ç”¨æˆ·çš„ä½¿ç”¨è€…æ¥è¯´ï¼Œå“ªäº›è¯è¯¥åˆ†ï¼Œå“ªäº›è¯ä¸è¯¥åˆ†ï¼ŒåŒ…æ‹¬åŒä¹‰è¯çš„å½±å“ç­‰ç­‰ï¼Œéƒ½ä¼šå½±å“æ•´ä¸ªScoreåˆ†å€¼çš„è®¡ç®—ï¼Œåœ¨ç›®å‰esçš„ç”Ÿæ€ä¸­ï¼Œ&lt;a href=&quot;https://github.com/medcl/elasticsearch-analysis-ik&quot;&gt;ikåˆ†è¯å™¨&lt;/a&gt;å¯èƒ½æ˜¯å½“ä¸‹æœ€æˆç†Ÿçš„ä¸€ä¸ªpluginæ’ä»¶ï¼Œikæä¾›äº†ä¸€ä¸ªåŸºç¡€çš„è¯åº“ï¼ŒåŒæ—¶æ”¯æŒçƒ­æ›´æ–°ï¼Œå¯¹äºä¸Šå±‚åº”ç”¨äº§å“çš„è®¾è®¡èåˆï¼Œéå¸¸åˆšéœ€ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;knnçš„score&quot;&gt;KNNçš„Score&lt;/h3&gt;

&lt;p&gt;å¯¹äºKNNçš„æ£€ç´¢åˆ†å€¼è®¡ç®—ï¼Œå°±éå¸¸çš„ç®€å•äº†ï¼Œå¼€å‘è€…åœ¨æ„å»ºç”¨æˆ·ç´¢å¼•çš„æ—¶å€™ï¼Œé€‰æ‹©å…·ä½“çš„å‘é‡è·ç¦»ç±»å‹ï¼Œesåœ¨è®¡ç®—knnçš„æ—¶å€™ï¼Œå°±ä¼šæ ¹æ®å…¶ç®—æ³•è¿›è¡Œè®¡ç®—&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;PUT&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;my-index&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;-2&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;mappings&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;properties&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;my_vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;dense_vector&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;dims&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;é€‰æ‹©ç±»å‹ï¼Œcosineã€dot_productã€l&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;_norm&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;similarity&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;cosine&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€‰æ‹©ä¸åŒçš„ç±»å‹ï¼Œ å°±æ˜¯å•çº¯çš„å‘é‡è·ç¦»è®¡ç®—äº†ï¼ŒæŒ‰å…¬å¼å¥—ç”¨å°±å¯ä»¥äº†ã€‚&lt;/p&gt;

&lt;p&gt;ä¸è¿‡å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºä½¿ç”¨æœ€å¤šçš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cosine&lt;/code&gt;çš„æ–‡æ¡£ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_score&lt;/code&gt; è®¡ç®—ä¸º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(1 + cosine(query, vector)) / 2&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&quot;ï¸æ³¨æ„äº‹é¡¹&quot;&gt;âš ï¸æ³¨æ„äº‹é¡¹&lt;/h3&gt;

&lt;p&gt;å½“æˆ‘ä»¬ä½¿ç”¨æ··åˆæ£€ç´¢çš„æ—¶å€™ï¼Œæœ‰ä¸€äº›æ³¨æ„äº‹é¡¹å€¼å¾—æˆ‘ä»¬å…³æ³¨ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å¼€å‘è€…åœ¨ä½¿ç”¨Explain APIæ¥å£è¿›è¡Œè°ƒè¯•çš„æ—¶å€™ï¼Œç”±äºKNNçš„åˆ†å€¼æ˜¯å•ç‹¬è®¡ç®—ï¼Œæ‰€ä»¥åœ¨åˆ†æçš„æ—¶å€™ï¼Œä¸èƒ½æœ‰KNNçš„éƒ¨åˆ†&lt;/li&gt;
  &lt;li&gt;KNNæ£€ç´¢çš„å‚æ•°ï¼Œå¯ä»¥é…ç½®å¤šä¸ªknnçš„å‘é‡æŸ¥è¯¢å€¼ï¼Œå¦å¤–&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;filter&lt;/code&gt;è¿‡æ»¤å‚æ•°ä¼šæé«˜æ£€ç´¢çš„æ•ˆç‡ï¼Œä½†æ˜¯æé«˜æ£€ç´¢æ•ˆç‡çš„åŒæ—¶ï¼Œç”±äºæ€»æ˜¯ä¼šè®¡ç®—å¬å›æ–‡æ¡£è¿›è¡Œç›¸ä¼¼åº¦è®¡ç®—ï¼Œæ‰€ä»¥å¯ä»¥é…åˆ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;similarity&lt;/code&gt;æ¥ä¸€èµ·ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;torchväº§å“é©±åŠ¨æ€»ç»“&quot;&gt;TorchVäº§å“é©±åŠ¨&amp;amp;æ€»ç»“&lt;/h2&gt;

&lt;p&gt;å¯¹äºæ··åˆæ£€ç´¢ï¼Œæˆ‘ä»¬åœ¨ç®—æ³•å±‚é¢æœ‰äº†ç›´æ¥çš„äº†è§£åï¼Œæœ€ç»ˆåœ¨äº§å“å±‚é¢ä¼šå½±å“ä¸€äº›è®¾è®¡ã€‚&lt;/p&gt;

&lt;p&gt;1ã€æ··åˆæ£€ç´¢çš„æƒé‡è®¾ç½®ï¼šåœ¨ä¸Šé¢çš„scoreåˆ†å€¼è®¡ç®—å…¬å¼ä¸­ï¼Œæˆ‘ä»¬å…¶å®çŸ¥é“esæœ€ç»ˆæ˜¯é€šè¿‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bm25*boost&lt;/code&gt;+&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;knn*boost&lt;/code&gt;,é‚£ä¹ˆè¿™ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;boost&lt;/code&gt;åˆ™å¯ä»¥å½±å“æˆ‘ä»¬æœ€ç»ˆçš„å†…å®¹ï¼Œå› ä¸ºå¹¶ä¸æ˜¯æ‰€æœ‰çš„å®¢æˆ·å’Œä¸šåŠ¡åœºæ™¯éƒ½é€‚åˆknnæ£€ç´¢ï¼Œå¯èƒ½åœ¨å…¶ä»–å…³é”®çš„åœºæ™¯ä¸­ï¼Œå…³é”®è¯æ£€ç´¢ä¼šæ›´é€‚åˆ(æ¯”å¦‚ä¸€äº›åˆ©ç”¨å¤§æ¨¡å‹åšä¸€äº›å¼‚æ­¥çš„ä»»åŠ¡æå–ï¼ŒæŠ¥å‘Šè¾“å‡ºç­‰ç­‰ä¸šåŠ¡åœºæ™¯)ï¼Œæˆ‘ä»¬åœ¨äº§å“è®¾è®¡ä¸­åˆ™å¯ä»¥æ ¹æ®ä¸åŒçš„å®¢æˆ·è¯‰æ±‚ä»¥åŠä¸šåŠ¡è¯‰æ±‚ï¼Œå°±å¯ä»¥è®¾ç½®è¿™ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;boost&lt;/code&gt;æ¥å½±å“æœ€ç»ˆçš„å¬å›ç»“æœå¤©å¹³ï¼Œä»è€Œæ”¹å–„æˆ‘ä»¬çš„äº§å“æ•ˆæœã€‚&lt;/p&gt;

&lt;p&gt;åœ¨æˆ‘ä»¬çš„TorchVçš„äº§å“è®¾è®¡ä¸­ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;alpha&lt;/code&gt;å‚æ•°å€¼ï¼Œå–å€¼èŒƒå›´åœ¨0-1ä¹‹é—´ï¼Œå…·ä½“æ¥è¯´ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;alpha = 1&lt;/code&gt;ï¼šå®Œå…¨åŸºäºå‘é‡çš„æœç´¢,ä¹Ÿå°±æ˜¯KNNè¿‘é‚»æœç´¢&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;alpha = 0&lt;/code&gt;ï¼šå®Œå…¨åŸºäºå…³é”®è¯çš„æœç´¢ï¼ŒåŸºäºESçš„BM25ç®—æ³•æ£€ç´¢&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;2ã€åœ¨BM25ç®—æ³•çš„åœºæ™¯ä¸­ï¼Œåˆ†è¯æ˜¯éå¸¸é‡è¦çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå¯¹äºä¸åŒçš„è¡Œä¸šå®¢æˆ·ï¼Œè¯åº“çš„æ”¶é›†å»ºç«‹å¯¹äºäº§å“åº”ç”¨çš„æå‡è‚¯å®šæ˜¯ä¼šæœ‰è´¨çš„æå‡ï¼Œä¹Ÿæ˜¯æ¯ä¸ªå…¬å¸åšRAGäº§å“çš„æ ¸å¿ƒç«äº‰åŠ›ã€‚&lt;/p&gt;

&lt;p&gt;3ã€æŒç»­è¿è¥èƒ½åŠ›çš„é‡è¦æ€§ï¼ŒRAGé—®ç­”æ£€ç´¢åŠŸèƒ½åœ¨æŠ€æœ¯æ¶æ„è¿­ä»£ä¼˜åŒ–ä¸Šæ˜¯ä¸€ä¸ªæ–¹é¢ï¼Œä½†æ˜¯è¿è¥èƒ½åŠ›åŒæ ·é‡è¦ï¼Œå“ªæ€•æ˜¯ChatGPT4ï¼Œåœ¨é’ˆå¯¹ç‰¹æ®Šçš„æ•°æ®æ–‡ä»¶ï¼Œå¦‚æœæ•°æ®æ··ä¹±ï¼ŒçŸ¥è¯†åº“è´¨é‡ä¸é«˜ï¼Œé‚£ä¹ˆåŒæ ·å›ç­”å‡†ç¡®ç‡ä¸ä¼šå¾ˆå¥½çš„ï¼Œè¿™åœ¨æˆ‘ä»¬å’Œå®¢æˆ·è¿›è¡Œæ²Ÿé€šäº¤æµçš„åŒæ—¶ï¼Œè™½ç„¶RAGå¯èƒ½ä¼šç»™å®¢æˆ·çœ¼å‰ä¸€äº®çš„æ„Ÿè§‰ï¼Œä½†æ˜¯æŒç»­çš„æå‡ä»–çš„èƒ½åŠ›ï¼Œå‘æŒ¥æ›´å¤§çš„ä½œç”¨ï¼Œäº§å“çš„æŒç»­è¿è¥èƒ½åŠ›æ˜¯å¿…ä¸å¯å°‘çš„ã€‚&lt;/p&gt;

&lt;h2 id=&quot;å‚è€ƒ&quot;&gt;å‚è€ƒ&lt;/h2&gt;

&lt;p&gt;å¥½äº†ï¼Œå…¨æ–‡å®Œ.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://weaviate.io/blog/hybrid-search-explained&quot;&gt;https://weaviate.io/blog/hybrid-search-explained&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Okapi_BM25&quot;&gt;https://en.wikipedia.org/wiki/Okapi_BM25&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://arxiv.org/abs/1603.09320&quot;&gt;https://arxiv.org/abs/1603.09320&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/7.17/query-dsl-script-score-query.html#vector-functions&quot;&gt;https://www.elastic.co/guide/en/elasticsearch/reference/7.17/query-dsl-script-score-query.html#vector-functions&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://towardsdatascience.com/improving-retrieval-performance-in-rag-pipelines-with-hybrid-search-c75203c2f2f5&quot;&gt;https://towardsdatascience.com/improving-retrieval-performance-in-rag-pipelines-with-hybrid-search-c75203c2f2f5&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.luxiangdong.com/2023/11/06/hnsw/&quot;&gt;https://www.luxiangdong.com/2023/11/06/hnsw/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="å¤§æ¨¡å‹" /><category term="RAGå®è·µ" /><category term="TorchV" /><category term="RAGæ¦‚è¿°" /><category term="RAG" /><category term="å¤§æ¨¡å‹" /><category term="LLM" /><summary type="html">æ¦‚è¿°</summary></entry><entry><title type="html">RAGçš„æ¦‚è¿°</title><link href="http://localhost:4000/2023/12/23/rag-survey/" rel="alternate" type="text/html" title="RAGçš„æ¦‚è¿°" /><published>2023-12-23T00:00:00+08:00</published><updated>2023-12-23T00:00:00+08:00</updated><id>http://localhost:4000/2023/12/23/rag-survey</id><content type="html" xml:base="http://localhost:4000/2023/12/23/rag-survey/">&lt;p&gt;å¾…ç»­â€¦&lt;/p&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="å¤§æ¨¡å‹" /><category term="RAGæ¦‚è¿°" /><category term="RAG" /><category term="å¤§æ¨¡å‹" /><category term="LLM" /><summary type="html">å¾…ç»­â€¦</summary></entry><entry><title type="html">åŸºäºApple MLXæ¡†æ¶çš„M1è®¾å¤‡ä¸Šå¤§æ¨¡å‹å¾®è°ƒå®è·µ</title><link href="http://localhost:4000/2023/12/17/apple-mlx-lora-action/" rel="alternate" type="text/html" title="åŸºäºApple MLXæ¡†æ¶çš„M1è®¾å¤‡ä¸Šå¤§æ¨¡å‹å¾®è°ƒå®è·µ" /><published>2023-12-17T00:00:00+08:00</published><updated>2023-12-17T00:00:00+08:00</updated><id>http://localhost:4000/2023/12/17/apple-mlx-lora-action</id><content type="html" xml:base="http://localhost:4000/2023/12/17/apple-mlx-lora-action/">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h2&gt;

&lt;p&gt;åœ¨ä¸ä¹…å‰è‹¹æœå®˜æ–¹å¼€æºå‘å¸ƒäº†é’ˆå¯¹Apple Silicon èŠ¯ç‰‡ä¼˜åŒ–çš„ MLX æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œè¯¥æ¡†æ¶å¯ä»¥ç®€åŒ–ç ”ç©¶äººå‘˜åœ¨ Macã€iPadã€iPhone å¹³å°è®¾è®¡å’Œéƒ¨ç½²æ¨¡å‹çš„è¿‡ç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;MLXçš„ä¸»è¦ç‰¹æ€§åŒ…æ‹¬ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ç†Ÿæ‚‰çš„API&lt;/strong&gt;ï¼š&lt;strong&gt;MLX&lt;/strong&gt; å…·æœ‰ç´§éš NumPy çš„ Python APIã€‚ MLX è¿˜æ‹¥æœ‰åŠŸèƒ½é½å…¨çš„ C++ APIï¼Œå®ƒä¸ Python API éå¸¸ç›¸ä¼¼ã€‚ MLX å…·æœ‰ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mlx.nn&lt;/code&gt; å’Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mlx.optimizers&lt;/code&gt; ç­‰æ›´é«˜çº§åˆ«çš„åŒ…ï¼Œå…¶ API ç´§å¯†éµå¾ª PyTorchï¼Œä»¥ç®€åŒ–æ„å»ºæ›´å¤æ‚çš„æ¨¡å‹ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¯ç»„åˆå‡½æ•°è½¬æ¢&lt;/strong&gt;ï¼šMLX å…·æœ‰ç”¨äºè‡ªåŠ¨å¾®åˆ†ã€è‡ªåŠ¨çŸ¢é‡åŒ–å’Œè®¡ç®—å›¾ä¼˜åŒ–çš„å¯ç»„åˆå‡½æ•°è½¬æ¢&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æƒ°æ€§è®¡ç®— (Lazy computation)&lt;/strong&gt;ï¼šMLX ä¸­çš„è®¡ç®—æ˜¯æƒ°æ€§è®¡ç®—ã€‚æ•°ç»„ä»…åœ¨éœ€è¦æ—¶æ‰ä¼šå…·ä½“åŒ–&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åŠ¨æ€å›¾æ„å»º&lt;/strong&gt;ï¼šMLX ä¸­çš„è®¡ç®—å›¾é‡‡ç”¨åŠ¨æ€æ„å»ºï¼Œæ›´æ”¹å‡½æ•°å‚æ•°çš„å½¢çŠ¶ä¸ä¼šè§¦å‘ç¼“æ…¢çš„ç¼–è¯‘ï¼Œå¹¶ä¸”è°ƒè¯•ç®€å•ç›´è§‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¤šè®¾å¤‡ï¼š&lt;/strong&gt;å¯ä»¥åœ¨ä»»ä½•æ”¯æŒçš„è®¾å¤‡ä¸Šè¿è¡Œï¼ˆå½“å‰ä¸º CPU å’Œ GPUï¼‰ï¼Œç¡®ä¿ç”¨æˆ·èƒ½å¤Ÿå……åˆ†åˆ©ç”¨ç¡¬ä»¶&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å…·å¤‡ç»Ÿä¸€å†…å­˜ä¼˜åŠ¿&lt;/strong&gt;ï¼šMLX å’Œå…¶ä»–æ¡†æ¶çš„æ˜¾ç€åŒºåˆ«æ˜¯é‡‡ç”¨ç»Ÿä¸€å†…å­˜æ¨¡å‹ã€‚ MLX ä¸­çš„æ•°ç»„ä½äºå…±äº«å†…å­˜ä¸­ï¼Œå¯ä»¥åœ¨ä»»ä½•æ”¯æŒçš„è®¾å¤‡ç±»å‹ä¸Šæ‰§è¡Œ MLX é˜µåˆ—ä¸Šçš„æ“ä½œï¼Œè€Œæ— éœ€ç§»åŠ¨æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é¡¹ç›®åœ°å€ï¼š&lt;a href=&quot;https://github.com/ml-explore/mlx&quot;&gt;https://github.com/ml-explore/mlx&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;è€Œåœ¨ä»Šå¤©çš„Xä¸Šçœ‹åˆ°Appleå¼€å‘è€…åˆ†äº«è¯´å¯ä»¥åœ¨32GBçš„M1è®¾å¤‡ä¸Šä½¿ç”¨MLXæ¡†æ¶å¯¹Mistral 7B(æˆ–è€…llamA)ç­‰æ¨¡å‹è¿›è¡Œå¾®è°ƒ(Fine-tune)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/apple-mlx-lora-action/image-20231216193342777.png&quot; alt=&quot;image-20231216193342777&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;å‡†å¤‡&quot;&gt;å‡†å¤‡&lt;/h2&gt;

&lt;p&gt;çœ‹åˆ°å®˜æ–¹çš„ä¾‹å­ï¼Œæˆ‘çš„ç”µè„‘æ­£å¥½æ˜¯M1 32GBçš„é…ç½®ï¼Œå°±æŠŠä»£ç è·‘æ¥è¯•è¯•çœ‹&lt;/p&gt;

&lt;p&gt;é¦–å…ˆä»£ç ä¸‹è½½ä¸‹æ¥ï¼Œåœ°å€ï¼š&lt;a href=&quot;https://github.com/ml-explore/mlx-examples/tree/main/lora&quot;&gt;https://github.com/ml-explore/mlx-examples/tree/main/lora&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å®‰è£…ä¾èµ–ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pip &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; requirements.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¸‹è½½Mistral-7B(14.48GBå¤§å°)çš„æ¨¡å‹å¹¶è§£å‹&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;curl &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; https://files.mistral-7b-v0-1.mistral.ai/mistral-7B-v0.1.tar
&lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-xf&lt;/span&gt; mistral-7B-v0.1.tar
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å°†ä¸‹è½½ä¸‹æ¥çš„æ¨¡å‹æ–‡ä»¶è¿›è¡Œè½¬æ¢ï¼Œæ‰§è¡Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;convert.py&lt;/code&gt;æ–‡ä»¶, å‘½ä»¤å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# è½¬æ¢å‘½ä»¤&lt;/span&gt;
python convert.py &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;--torch-model&lt;/span&gt; &amp;lt;path_to_torch_model&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;--mlx-model&lt;/span&gt; &amp;lt;path_to_mlx_model&amp;gt;
&lt;span class=&quot;c&quot;&gt;# è½¬æ¢&lt;/span&gt;
python convert.py &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;--torch-model&lt;/span&gt; mistral-7B-v0.1 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;--mlx-model&lt;/span&gt; mistral-7b-v0.1-mlx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¸¤ä¸ªä¸»è¦çš„å‚æ•°:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;torch-model: Mistralæ¨¡å‹çš„ç›®å½•ï¼Œè§£å‹åä¸ºå½“å‰çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mistral-7B-v0.1&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;mlx-model: è¾“å‡ºç›®å½•åç§°ï¼Œè¿™é‡Œå–å&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mistral-7b-v0.1-mlx&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é€šè¿‡å‘½ä»¤è½¬æ¢åï¼Œè½¬æ¢çš„ç›®å½•æ–‡ä»¶ä¼šæœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/apple-mlx-lora-action/image-20231216201202978.png&quot; alt=&quot;image-20231216201202978&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;å¾®è°ƒfine-tune&quot;&gt;å¾®è°ƒ(Fine-tune)&lt;/h2&gt;

&lt;p&gt;å°†æ¨¡å‹ä¸‹è½½è½¬æ¢å®Œæˆåï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥ä½¿ç”¨å®˜æ–¹æä¾›çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lora.py&lt;/code&gt;è¿›è¡Œå¾®è°ƒ(&lt;strong&gt;Fine-tune&lt;/strong&gt;)äº†ï¼Œå…ˆæ¥çœ‹æ•°æ®é›†ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/apple-mlx-lora-action/image-20231216194706972.png&quot; alt=&quot;image-20231216194706972&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è®­ç»ƒçš„æ•°æ®é›†æ˜¯1000è¡Œï¼Œä¸»è¦çš„æ ¼å¼ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;å¾®è°ƒç›®æ ‡æ˜¯å¾—åˆ°ä¸€ä¸ªèƒ½å¤Ÿå°†è‡ªç„¶è¯­è¨€å¥å­è½¬æ¢ä¸ºSQL&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;table: 1-1000181-1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;columns: State/territory, Text/background colour, Format, Current slogan, Current series, Notes&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Q: Tell me what the notes are for South Australia &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;A: SELECT Notes FROM 1-1000181-1 WHERE Current slogan = 'SOUTH AUSTRALIA'&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ•°æ®é›†çš„æ ¼å¼å¾ˆæ¸…æ™°ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;table: è¡¨åç§°
columns: åˆ—åç§°
Q: ç”¨æˆ·é—®é¢˜
A: SQLè¯­å¥
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;è®­ç»ƒ&quot;&gt;è®­ç»ƒ&lt;/h2&gt;

&lt;p&gt;åœ¨ç¬¬ä¸€æ¬¡trainçš„è¿‡ç¨‹ä¸­ï¼Œç›´æ¥ä½¿ç”¨demoä¸­çš„å‘½ä»¤ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python lora.py &lt;span class=&quot;nt&quot;&gt;--model&lt;/span&gt; &amp;lt;path_to_model&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nt&quot;&gt;--train&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nt&quot;&gt;--iters&lt;/span&gt; 600
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¿è¡Œäº†å¤§æ¦‚10åˆ†é’Ÿåï¼Œç¨‹åºå°±å¼‚å¸¸é€€å‡ºäº†ï¼Œæç¤ºå†…å­˜ä¸è¶³ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/apple-mlx-lora-action/image-20231216195734079.png&quot; alt=&quot;image-20231216195734079&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨å£°æ˜å†…å­˜çš„è¿‡ç¨‹ä¸­ï¼Œå‡ºç°äº†å¼‚å¸¸ï¼Œæ— æ³•å¼€è¾Ÿæ–°å†…å­˜ç©ºé—´ï¼Œå¹¶ä¸”æ¯ç§’çš„Tokensæ•°é‡ä¹Ÿå¾ˆæ„ŸäººğŸ˜­&lt;/p&gt;

&lt;p&gt;åœ¨çœ‹äº†å®˜æ–¹çš„é’ˆå¯¹å†…å­˜çš„issueså»ºè®®åï¼Œå‘ç°æœ‰å‡ ä¸ªå‚æ•°æ˜¯å½±å“ç€å†…å­˜ä½¿ç”¨çš„ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;â€“batch-size&lt;/strong&gt;ï¼šå°è¯•é€šè¿‡ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--batch-size&lt;/code&gt; ä½¿ç”¨è¾ƒå°çš„æ‰¹é‡å¤§å°ã€‚ é»˜è®¤å€¼ä¸º 4ï¼Œå› æ­¤å°†å…¶è®¾ç½®ä¸º 2 æˆ– 1 å°†å‡å°‘å†…å­˜æ¶ˆè€—ã€‚ è¿™å¯èƒ½ä¼šå‡æ…¢é€Ÿåº¦ï¼Œä½†ä¹Ÿä¼šå‡å°‘å†…å­˜ä½¿ç”¨ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;â€“lora-layers&lt;/strong&gt;:å°‘å±‚æ•°ä»¥ä½¿ç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--lora-layers&lt;/code&gt; è¿›è¡Œå¾®è°ƒã€‚ é»˜è®¤å€¼ä¸º 16ï¼Œå› æ­¤æ‚¨å¯ä»¥å°è¯• 8 æˆ– 4ã€‚è¿™ä¼šå‡å°‘åå‘ä¼ æ’­æ‰€éœ€çš„å†…å­˜é‡ã€‚ å¦‚æœæ‚¨ä½¿ç”¨å¤§é‡æ•°æ®è¿›è¡Œå¾®è°ƒï¼Œå®ƒè¿˜å¯èƒ½ä¼šé™ä½å¾®è°ƒæ¨¡å‹çš„è´¨é‡ã€‚&lt;/li&gt;
  &lt;li&gt;æ•°æ®é›†ï¼šè¾ƒé•¿çš„ç¤ºä¾‹éœ€è¦æ›´å¤šçš„å†…å­˜ã€‚ å¦‚æœè¿™å¯¹æ‚¨çš„æ•°æ®æœ‰æ„ä¹‰ï¼Œæ‚¨å¯ä»¥åšçš„ä¸€ä»¶äº‹æ˜¯åœ¨åˆ¶ä½œ {train, valid, test}.jsonl æ–‡ä»¶æ—¶å°†ç¤ºä¾‹åˆ†è§£ä¸ºæ›´å°çš„åºåˆ—ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ ¹æ®å®˜æ–¹çš„å»ºè®®ï¼Œé‚£ä¹ˆä¿®æ”¹trainå‚æ•°ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python lora.py &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--model&lt;/span&gt; mistral-7b-v0.1-mlx &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--train&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--batch-size&lt;/span&gt; 1 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--lora-layers&lt;/span&gt; 4
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æŒ‰è¿™ä¸ªå‘½ä»¤æ‰§è¡Œåï¼Œåœ¨æˆ‘çš„M1è®¾å¤‡ä¸Šæ‰§è¡Œçš„è¿˜æ¯”è¾ƒå¿«ï¼Œæ¯ç§’çš„Tokensæ•°é‡å¹³å‡ä¸Š110å·¦å³&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/apple-mlx-lora-action/image-20231216200532260.png&quot; alt=&quot;image-20231216200532260&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è€ŒLossçš„å€¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Iter&lt;/th&gt;
      &lt;th&gt;Loss&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2.265&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;200&lt;/td&gt;
      &lt;td&gt;1.516&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;400&lt;/td&gt;
      &lt;td&gt;1.380&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;600&lt;/td&gt;
      &lt;td&gt;1.350&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;800&lt;/td&gt;
      &lt;td&gt;1.325&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;trainå®Œæˆåï¼Œä¼šåœ¨æœ¬åœ°é»˜è®¤ç”Ÿæˆä¸€ä¸ªæƒé‡æ–‡ä»¶&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;adapters.npz&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;æµ‹è¯•ç»“æœï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python lora.py &lt;span class=&quot;nt&quot;&gt;--model&lt;/span&gt; mistral-7b-v0.1-mlx &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nt&quot;&gt;--adapter-file&lt;/span&gt; adapters.npz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nt&quot;&gt;--num-tokens&lt;/span&gt; 50 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nt&quot;&gt;--prompt&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;table: 1-10015132-16
columns: Player, No., Nationality, Position, Years in Toronto, School/Club Team
Q: What is terrence ross' nationality
A: &quot;&lt;/span&gt;
Loading pretrained model
Total parameters 7243.436M
Trainable parameters 1.704M
Loading datasets
Generating
table: 1-10015132-16
columns: Player, No., Nationality, Position, Years &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;Toronto, School/Club Team
Q: What is terrence ross&lt;span class=&quot;s1&quot;&gt;' nationality
# å¤§æ¨¡å‹è¾“å‡º
A:  SELECT Nationality FROM 1-10015132-16 WHERE Player = '&lt;/span&gt;Terrence Ross&lt;span class=&quot;s1&quot;&gt;' blowing off the rosshill. SELECT Nationality FROM 1-10015
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä»ç»“æœçœ‹ï¼ŒSQLçš„å‰åŠéƒ¨åˆ†å†™å¯¹äº†ï¼Œå¹¶ä¸”ä¹Ÿè¯†åˆ«å‡ºäº†å­—æ®µã€whereæ¡ä»¶ï¼Œä½†æ˜¯åé¢çš„å¥å­å¥½åƒå°±ä¸å¤ªå¯¹äº†&lt;/p&gt;

&lt;p&gt;æˆ‘æ€€ç–‘æ˜¯åœ¨trainæ—¶ï¼Œå‚æ•°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--lora-layers 4&lt;/code&gt;çš„é—®é¢˜ï¼Œè¿™æ—¶ï¼Œæˆ‘å°†æ”¹å‚æ•°æ”¹ä¸º8ï¼Œåœ¨trainä¸€æ¬¡&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python lora.py &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--model&lt;/span&gt; mistral-7b-v0.1-mlx &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--train&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--adapter-file&lt;/span&gt; adapters_2_8_1.npz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--batch-size&lt;/span&gt; 2 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--lora-layers&lt;/span&gt; 8
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è€ŒLossçš„å€¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Iter&lt;/th&gt;
      &lt;th&gt;loss&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2.348&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;200&lt;/td&gt;
      &lt;td&gt;1.392&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;400&lt;/td&gt;
      &lt;td&gt;1.293&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;800&lt;/td&gt;
      &lt;td&gt;1.213&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1000&lt;/td&gt;
      &lt;td&gt;1.233&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ä¹‹åï¼ŒåŒæ ·çš„å‘½ä»¤ï¼Œå†æ¥çœ‹æ•ˆæœï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python lora.py &lt;span class=&quot;nt&quot;&gt;--model&lt;/span&gt; mistral-7b-v0.1-mlx &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nt&quot;&gt;--adapter-file&lt;/span&gt; adapters_2_8.npz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nt&quot;&gt;--num-tokens&lt;/span&gt; 50 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nt&quot;&gt;--prompt&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;table: 1-10015132-16
columns: Player, No., Nationality, Position, Years in Toronto, School/Club Team
Q: What is terrence ross' nationality
A: &quot;&lt;/span&gt;
Loading pretrained model
Total parameters 7243.436M
Trainable parameters 1.704M
Loading datasets
Generating
table: 1-10015132-16
columns: Player, No., Nationality, Position, Years &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;Toronto, School/Club Team
Q: What is terrence ross&lt;span class=&quot;s1&quot;&gt;' nationality
A:  SELECT Nationality FROM 1-10015132-16 WHERE Player = '&lt;/span&gt;Terrence Ross&lt;span class=&quot;s1&quot;&gt;' SELECT Nationality FROM 1-10015132-16 WHERE
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;çœ‹æ•ˆæœå¥½åƒåœ¨SQLè¯­å¥ä¸­ï¼Œæ¯”ä¸Šé¢çš„æ•ˆæœç¨å¾®è¦å¥½ä¸€ç‚¹äº†?ä½†æ˜¯ç»“æœè¿˜æ˜¯ä¸å¯¹ã€‚&lt;/p&gt;

&lt;p&gt;æ•ˆæœå¹¶æ²¡æœ‰è¾¾åˆ°é¢„æœŸï¼Œæˆ‘è§‰å¾—ä¸»è¦æ˜¯å¯èƒ½æœ‰å‡ ä¸ªæ–¹é¢çš„åŸå› ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;è®­ç»ƒæ•°æ®é›†å¤ªå°‘ï¼Œå¯¼è‡´å¤§æ¨¡å‹å¯èƒ½æ— æ³•,train.jsonlä¸­çš„æ•°æ®é›†æ˜¯1000&lt;/li&gt;
  &lt;li&gt;å‚æ•°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--lora-layers &lt;/code&gt;çš„é—®é¢˜ï¼Œé»˜è®¤æ˜¯16ï¼Œè™½ç„¶æˆ‘æœ€åæ”¹æˆäº†8ï¼Œä½†æ˜¯ä»å®˜æ–¹ç»™å‡ºçš„è¯´æ˜æ¥çœ‹ï¼Œè¯¥å‚æ•°ä¼šå½±å“è´¨é‡&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æˆ‘å°†å‚æ•°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--lora-layers &lt;/code&gt;ä¿®æ”¹ä¸º16è¿›è¡Œäº†å°è¯•ï¼Œè·‘ä¸äº†ï¼Œå¯èƒ½è¿˜æ˜¯æˆ‘çš„å†…å­˜å¤ªä½äº†ğŸ˜­ï¼Œé‚£æˆ‘åªèƒ½åŠ æ•°æ®é›†äº†&lt;/p&gt;

&lt;p&gt;ä¿®æ”¹äº†dataç›®å½•ä¸‹çš„wikisql.pyæ–‡ä»¶ï¼Œå°†æ•°æ®é›†ä¸‹è½½æ•´ç†çš„æ€»ä½“æ•°é‡ä¸Šå‡åˆ°10000ï¼Œä»£ç ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;__main__&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;datanames&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;train&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;dev&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sizes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;56355&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8421&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15878&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;datanames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sizes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;WikiSQL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Wrong &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataname&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; set size.&quot;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# Write the sets to jsonl
&lt;/span&gt;    &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;json&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# æ­¤å¤„åŸtrainå‚æ•°æ˜¯1000ï¼Œæˆ‘æ”¹æˆ5000
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;datasets&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;train&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;valid&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datasets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;data/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;.jsonl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;w&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;# Strip the &amp;lt;s&amp;gt;, &amp;lt;/s&amp;gt; since the tokenizer adds them
&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]},&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;fid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¿®æ”¹æ•°æ®é›†åï¼Œåœ¨trainè¿‡åï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„æƒé‡æ–‡ä»¶ï¼Œå‘½ä»¤ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python lora.py &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--model&lt;/span&gt; mistral-7b-v0.1-mlx &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--train&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--adapter-file&lt;/span&gt; adapters_2_8_1.npz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--batch-size&lt;/span&gt; 2 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;--lora-layers&lt;/span&gt; 8
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;lossçš„trainè¿‡ç¨‹åˆ†å€¼å˜åŒ–ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Iter&lt;/th&gt;
      &lt;th&gt;loss&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2.348&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;200&lt;/td&gt;
      &lt;td&gt;1.472&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;400&lt;/td&gt;
      &lt;td&gt;1.410&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;600&lt;/td&gt;
      &lt;td&gt;1.387&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;800&lt;/td&gt;
      &lt;td&gt;1.360&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1000&lt;/td&gt;
      &lt;td&gt;1.349&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;å†æ¥çœ‹çœ‹æˆ‘ä»¬çš„promtå¾—åˆ°çš„ç»“æœï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/apple-mlx-lora-action/image-20231217105402278.png&quot; alt=&quot;image-20231217105402278&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä»ç»“æœæ¥çœ‹ï¼ŒSQLè¯­å¥çš„è¯­æ³•å¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆå¤§çš„é—®é¢˜ï¼Œåªæ˜¯ç»“æœæ²¡æœ‰è¾¾åˆ°é¢„æœŸï¼Œå¯èƒ½è¿˜æ˜¯å¾—ä»æ•°æ®é›†åŠç›¸å…³å‚æ•°æ‰¾ä¸€ä¸‹åŸå› ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ç»“è®º&quot;&gt;ç»“è®º&lt;/h2&gt;

&lt;p&gt;è™½ç„¶è¿è¡Œçš„ç»“æœè¿˜æ²¡æœ‰å®Œå…¨è¾¾åˆ°é¢„æœŸï¼Œä½†æ˜¯åœ¨MACä¸Šé€šè¿‡Appleæ¨å‡ºçš„MLXæ·±åº¦å­¦ä¹ æ¡†æ¶è¿›è¡ŒFine-tureçš„æŠ€æœ¯æ–¹æ¡ˆæ˜¯å¯è¡Œçš„ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¹Ÿä¸ºä»¥åå¤§æ¨¡å‹çš„è®­ç»ƒã€ç”Ÿæ€å‘å±•æä¾›äº†å¦å¤–ä¸€ç§å¯èƒ½æ€§ã€‚&lt;/p&gt;

&lt;p&gt;åŒ…æ‹¬æˆ‘ä»¬åº”ç”¨å¼€å‘è€…åœ¨åšRAGçš„è¿‡ç¨‹ä¸­ï¼Œå’Œæ•°æ®è¿›è¡Œå¯¹è¯çš„åœºæ™¯éšç€ä¸šåŠ¡çš„æ·±å…¥è‚¯å®šä¼šè§¦åŠï¼Œè€Œå¯¹æ¨¡å‹è¿›è¡Œå¾®è°ƒæ˜¯ä¸å¯é¿å…çš„ã€‚&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/ml-explore/mlx-examples/tree/main/lora&quot;&gt;https://github.com/ml-explore/mlx-examples/tree/main/lora&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/ml-explore/mlx&quot;&gt;https://github.com/ml-explore/mlx&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://twitter.com/awnihannun/status/1735782998623261071&quot;&gt;https://twitter.com/awnihannun/status/1735782998623261071&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="å¤§æ¨¡å‹" /><summary type="html">å‰è¨€</summary></entry><entry><title type="html">Python3.11åœ¨CentOS7ç¯å¢ƒä¸‹çš„å®‰è£…æŒ‡å®šOpenSSL</title><link href="http://localhost:4000/2023/11/07/centos-python311-install/" rel="alternate" type="text/html" title="Python3.11åœ¨CentOS7ç¯å¢ƒä¸‹çš„å®‰è£…æŒ‡å®šOpenSSL" /><published>2023-11-07T00:00:00+08:00</published><updated>2023-11-07T00:00:00+08:00</updated><id>http://localhost:4000/2023/11/07/centos-python311-install</id><content type="html" xml:base="http://localhost:4000/2023/11/07/centos-python311-install/">&lt;p&gt;å¦‚æœä½ æ˜¯åœ¨CentOS7 ä¸Šé¢æºç å®‰è£…Python3.11ç‰ˆæœ¬ï¼Œä½ å¯èƒ½ä¼šç¢°åˆ°å’Œæˆ‘ä¸€æ ·çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯OpenSSLæ¨¡å—å¤ªä½äº†ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨æºç ç¼–è¯‘å®‰è£…æ—¶ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šOpenSSLé‚£ä¹ˆåœ¨ä½¿ç”¨æ—¶ä¼šå‡ºç°ä¸€äº›å¼‚å¸¸ï¼Œè§£å†³æ–¹æ¡ˆï¼š&lt;/p&gt;

&lt;p&gt;1ã€æ›´æ–°yumè½¯ä»¶åŒ…&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;yum update
yum &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;openssl-devel bzip2-devel libffi-devel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2ã€ä¸‹è½½æœ€æ–°çš„OpenSSLæºç ï¼Œè§£å‹å¹¶ç¼–è¯‘&lt;/p&gt;

&lt;div class=&quot;language-py highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;usr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;src&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;wget&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ftp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;openssl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;org&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;openssl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gz&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;no&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;check&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;certificate&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è§£å‹OpenSSLåŒ…å¹¶å®‰è£…&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# è§£å‹&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-xzvf&lt;/span&gt; openssl-1.1.1q.tar.gz
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;openssl-1.1.1q
&lt;span class=&quot;c&quot;&gt;# ç¼–è¯‘&lt;/span&gt;
./config &lt;span class=&quot;nt&quot;&gt;--prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr &lt;span class=&quot;nt&quot;&gt;--openssldir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/ssl &lt;span class=&quot;nt&quot;&gt;--libdir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lib no-shared zlib-dynamic
make
&lt;span class=&quot;c&quot;&gt;# å®‰è£…&lt;/span&gt;
make &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3ã€éªŒè¯ç‰ˆæœ¬&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; openssl version
OpenSSL 1.1.1q  5 Jul 2022
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; which openssl
/usr/bin/openssl
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;4ã€ä¸‹è½½Pythonçš„æºç åŒ…ï¼Œè§£å‹å¹¶å®‰è£…&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;## è§£å‹&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-xzf&lt;/span&gt; Python-3.11.6.tgz
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;Python-3.11.6
&lt;span class=&quot;c&quot;&gt;# ç¼–è¯‘ï¼ˆæŒ‡å®špython3çš„ç›®å½•å’Œopensslæ¨¡å—ï¼‰&lt;/span&gt;
./configure &lt;span class=&quot;nt&quot;&gt;--prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/mnt/python/python3 &lt;span class=&quot;nt&quot;&gt;--with-openssl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr
&lt;span class=&quot;c&quot;&gt;# å®‰è£…&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;make
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;make &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;5ã€ç”Ÿæˆè½¯é“¾&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ç³»ç»Ÿä¸­å¯èƒ½å·²ç»å­˜åœ¨python3çš„å‘½ä»¤ï¼Œåˆ é™¤é‡æ–°å‘½åå³å¯&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;åœ¨ä¸Šé¢æˆ‘ä»¬æŒ‡å®šå®‰è£…ç›®å½•åœ¨&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/mnt/python/python3&lt;/code&gt;ä¸‹,æ‰€ä»¥å¯ä»¥ç›´æ¥åˆ›å»ºè½¯é“¾&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo ln&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; /mnt/python/python3/bin/python3.11 /usr/bin/python3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;references&quot;&gt;References&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/73407527/installing-ssl-package-with-pip-requires-ssl-package-to-be-already-installed&quot;&gt;Installing SSL package with PIP requires SSL package to be already installed&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="Blog" /><category term="Python" /><summary type="html">å¦‚æœä½ æ˜¯åœ¨CentOS7 ä¸Šé¢æºç å®‰è£…Python3.11ç‰ˆæœ¬ï¼Œä½ å¯èƒ½ä¼šç¢°åˆ°å’Œæˆ‘ä¸€æ ·çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯OpenSSLæ¨¡å—å¤ªä½äº†ã€‚</summary></entry><entry><title type="html">è¶…èµçš„åšå®¢ä¸»é¢˜åˆ†äº«ï¼Œå€¼å¾—ä¸€çœ‹</title><link href="http://localhost:4000/2023/10/16/jekyll-theme-chirpy-share/" rel="alternate" type="text/html" title="è¶…èµçš„åšå®¢ä¸»é¢˜åˆ†äº«ï¼Œå€¼å¾—ä¸€çœ‹" /><published>2023-10-16T00:00:00+08:00</published><updated>2023-10-16T00:00:00+08:00</updated><id>http://localhost:4000/2023/10/16/jekyll-theme-chirpy-share</id><content type="html" xml:base="http://localhost:4000/2023/10/16/jekyll-theme-chirpy-share/">&lt;p&gt;æœ€è¿‘åœ¨å­¦ä¹ RAGã€&lt;a href=&quot;/categories/å¤§æ¨¡å‹/&quot;&gt;å¤§æ¨¡å‹&lt;/a&gt;ç­‰é¢†åŸŸæ–¹é¢çš„æŠ€æœ¯ï¼Œæƒ³åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­åšæ€»ç»“æ€§çš„è¾“å‡ºï¼Œå› æ­¤å°±æƒ³æŠŠè‡ªå·±ä¹‹å‰å¼„çš„åšå®¢é‡æ–°æ•´ç†ä¸€ç•ª,ä¸»è¦æœ‰å‡ ä¸ªåŸå› :&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;åšå®¢ç½‘é¡µæ— æ³•é€‚é…ç§»åŠ¨ç«¯(éå¸¸é‡è¦çš„ä¸€ä¸ªç‰¹æ€§)&lt;/li&gt;
  &lt;li&gt;ä¸»é¢˜æœ‰äº›è…»äº†,æƒ³æ¢ä¸ªæ–°ä¸»é¢˜&lt;/li&gt;
  &lt;li&gt;GitHub Pages &amp;lt;-&amp;gt; åšå®¢ &amp;lt;-&amp;gt; å¾®ä¿¡å…¬ä¼—å· æ•´ä½“é“¾è·¯çš„æ–‡ç« ç¼–å†™å‘å¸ƒé¡ºç•…çš„è¯‰æ±‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åæ¥ï¼Œå°±åŸºäºè‡ªå·±çš„æƒ³æ³•ï¼Œæ•´ç†çš„äº†è¦é‡æ–°æ•´ç†åšå®¢çš„éœ€æ±‚ï¼Œåˆ—äº†ä¸€ä¸ªæ€ç»´å¯¼å›¾ï¼Œå¦‚ä¸‹å›¾:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_build.png&quot; alt=&quot;å›¾1-åšå®¢éœ€æ±‚æ•´ç†&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸»è¦ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢è€ƒè™‘ï¼š&lt;/p&gt;

&lt;h2 id=&quot;1åŸºç¡€æ¡†æ¶&quot;&gt;1.åŸºç¡€æ¡†æ¶&lt;/h2&gt;

&lt;p&gt;è‚¯å®šæ˜¯åŸºäºç›®å‰å·²ç»å¼€æ”¾æµè¡Œçš„åšå®¢æ¡†æ¶è¿›è¡Œæ”¹é€ ,è¿™æ ·èƒ½å¤Ÿå¿«é€Ÿçš„æ­å»ºå®Œæˆ,è€Œä¸”æ— éœ€è€ƒè™‘é¡µé¢å¸ƒå±€çš„æƒ…å†µ&lt;/p&gt;

&lt;p&gt;è¿™é‡Œåˆ—çš„å¤§éƒ¨åˆ†æˆ‘éƒ½æ˜¯ç”¨è¿‡&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://vuepress.vuejs.org/zh/guide/&quot;&gt;VuePress&lt;/a&gt;: Vue é©±åŠ¨çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨,åœ¨å¾ˆæ—©ç»™&lt;a href=&quot;https://doc.xiaominfo.com/v2/&quot;&gt;Knife4j&lt;/a&gt;å†™å¼€æºçš„æŠ€æœ¯æ–‡æ¡£æ—¶å°±ä½¿ç”¨çš„è¿™ä¸ª&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://vitepress.dev/&quot;&gt;VitePress&lt;/a&gt;: åœ¨Viteæ¡†æ¶å‡ºæ¥å,åŸºäºViteç”Ÿæ€ä¸‹çš„é™æ€ç½‘é¡µç”Ÿæˆå™¨ï¼Œæ˜¯ä¸€ä¸ªéå¸¸æ£’çš„ç»„ä»¶ï¼Œé€Ÿåº¦é£å¿«ï¼Œå½“è¿™æ¬¡æˆ‘å¹¶æ²¡æœ‰é€‰æ‹©è¿™ä¸ªã€‚åŸå› åé¢ä¼šè¯´æ˜&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://hexo.io/zh-cn/&quot;&gt;Hexo&lt;/a&gt; :å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶,ä¹Ÿæ˜¯å¾ˆæ—©çš„ä¸€ä¸ªæ¡†æ¶ï¼Œä¸»é¢˜æ ·å¼éå¸¸çš„å¤šï¼Œ&lt;a href=&quot;https://www.luxiangdong.com/&quot;&gt;å‘˜å¤–çš„ç½‘ç«™&lt;/a&gt;å°±ä½¿ç”¨äº†è¿™ä¸ªæ¡†æ¶&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docusaurus.io/&quot;&gt;Docusaurus&lt;/a&gt;: åŸºäºReactæŠ€æœ¯æ ˆçš„ä¸€ä¸ªé™æ€ç½‘ç«™ç”Ÿæˆå™¨ï¼ŒåŒæ ·éå¸¸çš„ä¼˜ç§€ï¼Œç›®å‰&lt;a href=&quot;https://doc.xiaominfo.com/&quot;&gt;Knife4j&lt;/a&gt;çš„å¼€æºæŠ€æœ¯æ–‡æ¡£ç”¨è¿™ä¸ªç¼–å†™&lt;/li&gt;
  &lt;li&gt;ğŸ‘‰ &lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt; : åŸºäºRubyè¯­è¨€ç¼–å†™çš„è€ç‰Œåšå®¢æ¡†æ¶ï¼Œæœ¬æœŸçš„ä¸»è§’&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿™é‡Œé€‰æ‹©&lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt; ä¸»è¦åŸå› æœ‰å‡ ä¸ªï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ä¹‹å‰çš„åšå®¢å°±æ˜¯ç”¨&lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt; æ¥å†™çš„ï¼Œè€Œè¿ç§»åšå®¢æ˜¯ä¸€é¡¹æ¯”è¾ƒç¹æ‚çš„ä»»åŠ¡ï¼Œä¸æƒ³æµªè´¹å¤ªå¤šçš„æ—¶é—´&lt;/li&gt;
  &lt;li&gt;åšå®¢ç½‘ç«™æˆ‘è§‰å¾—&lt;strong&gt;æœ€é‡è¦çš„æ˜¯åœ¨äºä½œè€…çš„åšæŒè¾“å‡º&lt;/strong&gt;ï¼Œä¸»é¢˜åªè¦åŠŸèƒ½æ»¡è¶³è¦æ±‚å³å¯ï¼Œä¸å¿…è¿½æ±‚å¤ªèŠ±å“¨çš„åŠŸèƒ½&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;2é¦–é¡µå†…å®¹&quot;&gt;2.é¦–é¡µå†…å®¹&lt;/h2&gt;

&lt;p&gt;ç¬¬äºŒä¸ªæ–¹é¢è€ƒè™‘çš„å› ç´ æ˜¯é¦–é¡µçš„å†…å®¹ï¼Œåƒ&lt;a href=&quot;https://vuepress.vuejs.org/zh/guide/&quot;&gt;VuePress&lt;/a&gt;å’Œ&lt;a href=&quot;https://vitepress.dev/&quot;&gt;VitePress&lt;/a&gt;é»˜è®¤çš„é¦–é¡µå†…å®¹å…¶å®æ˜¯éå¸¸ç®€æ´çš„ï¼Œæˆ‘è§‰å¾—æ›´é€‚åˆäº§å“çš„å±•ç¤ºï¼Œä¸é€‚åˆåšå®¢ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥èŠ±æ—¶é—´æ”¹é€ ï¼Œæˆ–è€…é€‰æ‹©ä¸€ä¸ªå¾ˆæ£’çš„ä¸»é¢˜è¿›è¡Œæ›¿æ¢ï¼Œè¿™é‡Œä¸»è¦æ˜¯æ—¶é—´ä¸å¤Ÿï¼Œå°±æ²¡æœ‰é€‰æ‹©è¿™ä¸ªï¼Œå¹¶éæ‰€ä»–ä»¬ä¸å¥½ã€‚è€Œæˆ‘æ‰€è€ƒè™‘çš„æ˜¯ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;é¦–é¡µçš„å†…å®¹è¦ä¸»é¢˜é²œæ˜ï¼Œè¯¦ç»†é˜è¿°æ•´ä¸ªç«™ç‚¹å†…å®¹&lt;/li&gt;
  &lt;li&gt;å¤šç¯‡æ–‡ç« åˆ™åˆ†é¡µï¼Œåšå®¢å¿…é¡»å…¨éƒ¨åœ¨é¦–é¡µå±•ç¤ºï¼Œä¸è·³è½¬åˆ°äºŒçº§é¡µé¢&lt;/li&gt;
  &lt;li&gt;å°½å¯èƒ½å¤šçš„å±•ç¤ºå†…å®¹ï¼Œ&lt;strong&gt;é¦–é¡µçš„èµ„æºæ˜¯éå¸¸å®è´µçš„&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä»¥ä¸‹å°±æ˜¯è¯¥åšå®¢çš„é¦–é¡µï¼Œéå¸¸ç¬¦åˆæˆ‘çš„è¯‰æ±‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_index.png&quot; alt=&quot;å›¾2-åšå®¢é¦–é¡µ&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;3åŸºæœ¬åŠŸèƒ½&quot;&gt;3.åŸºæœ¬åŠŸèƒ½&lt;/h2&gt;

&lt;p&gt;æ¥ä¸‹æ¥å°±æ˜¯è€ƒè™‘åšå®¢æ¡†æ¶ä¸€ä¸ªåŸºç¡€çš„åŠŸèƒ½ï¼Œè¿™é‡Œä»ä¸ªäººçš„è¯‰æ±‚ï¼Œåˆ—äº†ä»¥ä¸‹çš„è¦æ±‚ï¼š&lt;/p&gt;

&lt;h3 id=&quot;31-é€‚é…ç§»åŠ¨ç«¯&quot;&gt;3.1 &lt;strong&gt;é€‚é…ç§»åŠ¨ç«¯&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;ç§»åŠ¨ç«¯æ—¶ä»£ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç‰¹æ€§&lt;/strong&gt;ï¼Œæœ‰æ—¶å€™åœ¨å‘å…¬ä¼—å·æ–‡ç« æ—¶å¯ä»¥åœ¨åº•éƒ¨é…ç½®åŸæ–‡é“¾æ¥ï¼Œå¯¹äºè¯»è€…æ¥è¯´å¯ä»¥æ— å·®åˆ«é˜…è¯»&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_mobile.png&quot; alt=&quot;å›¾3-ç§»åŠ¨ç«¯é€‚é…&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;32-ç«™å†…æœç´¢&quot;&gt;3.2 &lt;strong&gt;ç«™å†…æœç´¢&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;å¯ä»¥æä¾›ç«™å†…æœç´¢çš„åŠŸèƒ½ï¼Œä¸ç®¡æ˜¯æ„å»ºæœ¬åœ°åšå®¢ç´¢å¼•è¿˜æ˜¯ä½¿ç”¨å¤–éƒ¨çš„å®ç°ï¼Œä¾‹å¦‚ã€Š&lt;a href=&quot;/posts/knife4j-document-active-search/&quot;&gt;Final.æ¿€æ´»Knife4jå®˜ç½‘çš„æ–‡æ¡£æœç´¢åŠŸèƒ½&lt;/a&gt;ã€‹æåˆ°çš„&lt;a href=&quot;https://www.algolia.com/&quot;&gt;algolia&lt;/a&gt;éƒ½æ˜¯å¯ä»¥çš„&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_search.png&quot; alt=&quot;å›¾4-ç«™å†…æœç´¢&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;33-å½’æ¡£åŠŸèƒ½&quot;&gt;3.3 &lt;strong&gt;å½’æ¡£åŠŸèƒ½&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;ä¸ç®¡æ˜¯åˆ†ç±»è¿˜æ˜¯æ—¥æœŸå½’æ¡£ï¼Œéƒ½æ˜¯å¿…é¡»çš„åŠŸèƒ½&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;åˆ†ç±»å½’æ¡£ï¼šèƒ½å¤Ÿç»™è¯»è€…ä¸€ä¸ªå¿«é€Ÿç´¢å¼•ï¼ŒæŸ¥çœ‹æ„Ÿå…´è¶£çš„å†…å®¹&lt;/li&gt;
  &lt;li&gt;æ—¥æœŸå½’æ¡£: æ ¹æ®æœ€æ–°æ—¥æœŸæŸ¥çœ‹æ›´æ–°çš„ç¯‡å¹…,åŒæ—¶ä¹Ÿæ˜¯å¯¹ä½œè€…çš„ä¸€ä¸ªé­ç­–ï¼Œéå¸¸å®ç”¨&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_arch.png&quot; alt=&quot;å›¾5-å½’æ¡£&quot; /&gt;
&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_arch1.png&quot; alt=&quot;å›¾6-å½’æ¡£1&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;34-è¯„è®ºåŠŸèƒ½&quot;&gt;3.4 &lt;strong&gt;è¯„è®ºåŠŸèƒ½&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;è¯„è®ºç®—æ˜¯ä¸€ä¸ªä¸ªäººè¯‰æ±‚å§,å¹¶éå¼ºåˆ¶ï¼Œå½“ç„¶å¦‚æœæœ‰é»˜è®¤æä¾›é‚£æ›´å¥½ï¼Œæœ¬ç«™ç‚¹åŸºäº&lt;a href=&quot;https://giscus.app/zh-CN&quot;&gt;giscus&lt;/a&gt;å®ç°
&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_comment.png&quot; alt=&quot;å›¾7-è¯„è®º&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;35-æ–‡ç« åˆ†äº«&quot;&gt;3.5 &lt;strong&gt;æ–‡ç« åˆ†äº«&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;å¿«é€Ÿåˆ†äº«åˆ°å„å¤§ç¤¾äº¤å¹³å°ï¼Œéå¸¸å®ç”¨çš„åŠŸèƒ½&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_share.jpg&quot; alt=&quot;å›¾7-åˆ†äº«&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;36-ç«™ç‚¹ç»Ÿè®¡&quot;&gt;3.6 &lt;strong&gt;ç«™ç‚¹ç»Ÿè®¡&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;è¯¥åŠŸèƒ½æˆ‘æƒ³ç›®å‰å„ä¸ªæ¡†æ¶éƒ½æ”¯æŒï¼Œä½¿ç”¨ç™¾åº¦ç»Ÿè®¡æˆ–è€…Google Analyticsåº”è¯¥éƒ½éå¸¸æ–¹ä¾¿&lt;/p&gt;

&lt;h3 id=&quot;37-rss&quot;&gt;3.7 &lt;strong&gt;RSS&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;æ ¹æ®ä¸ªäººå–œå¥½æä¾›&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/blog2/jekyll-theme-share/blog_feed.jpg&quot; alt=&quot;å›¾8-è¯„è®º&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;4-åšå®¢å¤§çº²&quot;&gt;4. åšå®¢å¤§çº²&lt;/h2&gt;

&lt;p&gt;ä¸ªäººçš„åšå®¢ï¼Œæˆ‘è§‰å¾—æ•´ä½“çš„å¤§çº²å†…å®¹ä¸å¿…å¤ªå¤šï¼Œåªéœ€è¦å…³æ³¨å†™ä½œå†…å®¹å³å¯ï¼Œèƒ½å¤Ÿå°†å†™ä½œå†…å®¹èƒ½å¤Ÿå¿«é€Ÿçš„ç´¢å¼•åˆ°å¹¶ä¸”ç»™è¯»è€…ä¸€ä¸ªæ¸…æ™°çš„ç»“æ„ï¼Œå°±å¯ä»¥äº†&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥æˆ‘çš„åšå®¢å¤§çº²ä¸»è¦æ˜¯å››ä¸ªï¼š &lt;strong&gt;ä¸»é¡µ&lt;/strong&gt;ã€&lt;strong&gt;æ ‡ç­¾&lt;/strong&gt;ã€&lt;strong&gt;å½’æ¡£&lt;/strong&gt;ã€&lt;strong&gt;å…³äº&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;5æ€»ç»“&quot;&gt;5.æ€»ç»“&lt;/h2&gt;

&lt;p&gt;æœ¬ç«™çš„åšå®¢åŸºäº&lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt;çš„&lt;a href=&quot;https://github.com/cotes2020/jekyll-theme-chirpy&quot;&gt;chirpy&lt;/a&gt;ä¸»é¢˜å®ç°ï¼Œè¯¥ä¸»é¢˜æ»¡è¶³äº†åšä¸»çš„æ‰€æœ‰è¯‰æ±‚ï¼Œéå¸¸æ£’ï¼Œå¸Œæœ›ä½ ä¹Ÿèƒ½å¤Ÿå–œæ¬¢!!!&lt;/p&gt;

&lt;p&gt;æœ¬ç«™æºç ï¼š&lt;a href=&quot;https://github.com/xiaoymin/xiaoymin.github.io&quot;&gt;https://github.com/xiaoymin/xiaoymin.github.io&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;åšå®¢é¦–é¡µï¼š&lt;a href=&quot;https://www.xiaominfo.com/&quot;&gt;https://www.xiaominfo.com/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä¸»é¢˜åœ°å€: &lt;a href=&quot;https://github.com/cotes2020/jekyll-theme-chirpy&quot;&gt;https://github.com/cotes2020/jekyll-theme-chirpy&lt;/a&gt;&lt;/p&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="Blog" /><summary type="html">æœ€è¿‘åœ¨å­¦ä¹ RAGã€å¤§æ¨¡å‹ç­‰é¢†åŸŸæ–¹é¢çš„æŠ€æœ¯ï¼Œæƒ³åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­åšæ€»ç»“æ€§çš„è¾“å‡ºï¼Œå› æ­¤å°±æƒ³æŠŠè‡ªå·±ä¹‹å‰å¼„çš„åšå®¢é‡æ–°æ•´ç†ä¸€ç•ª,ä¸»è¦æœ‰å‡ ä¸ªåŸå› :</summary></entry><entry><title type="html">ç”¨å¥½å¤§æ¨¡å‹?è¿™5ç§å®ç”¨çš„Promptæ¡†æ¶ä½ ä¸€å®šè¦çœ‹çœ‹!</title><link href="http://localhost:4000/2023/10/15/use-prompt-framework/" rel="alternate" type="text/html" title="ç”¨å¥½å¤§æ¨¡å‹?è¿™5ç§å®ç”¨çš„Promptæ¡†æ¶ä½ ä¸€å®šè¦çœ‹çœ‹!" /><published>2023-10-15T00:00:00+08:00</published><updated>2023-10-15T00:00:00+08:00</updated><id>http://localhost:4000/2023/10/15/use-prompt-framework</id><content type="html" xml:base="http://localhost:4000/2023/10/15/use-prompt-framework/">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h2&gt;

&lt;p&gt;å¤§æ¨¡å‹æ­£ä¸ºæˆ‘ä»¬å¸¦æ¥å‰æ‰€æœªæœ‰çš„æŠ€æœ¯é©æ–°ï¼Œè€Œç”¨å¥½å¤§æ¨¡å‹ä¹Ÿæ˜¯æœ‰ä¸€å®šæŠ€å·§çš„ã€‚&lt;/p&gt;

&lt;p&gt;æœ¬æ–‡ä¸»è¦åˆ†äº«&lt;strong&gt;5ç§&lt;/strong&gt;å®ç”¨çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Prompt&lt;/code&gt;å¯¹è¯æç¤ºæ¡†æ¶ï¼Œç»“åˆè‡ªå·±çš„å®é™…éœ€æ±‚ï¼Œè®©ä½ èƒ½å¤Ÿçµæ´»ä½¿ç”¨å¤§æ¨¡å‹!&lt;/p&gt;

&lt;h2 id=&quot;1rtfæ¡†æ¶&quot;&gt;1.RTFæ¡†æ¶&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;RTF(Role-Task-Format)æ¡†æ¶&lt;/strong&gt;æ˜¯ä¸€ä¸ªéå¸¸ç®€å•é€šç”¨çš„Promptæç¤ºæ¡†æ¶ï¼Œæˆ‘ä»¬å’Œä»»æ„å¤§æ¨¡å‹å¯¹è¯åœºæ™¯ä¸‹éƒ½å¯ä»¥ä½¿ç”¨è¯¥è§„èŒƒè¿›è¡Œæ”¹è¿›è¾“å‡º&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;R-Role(è§’è‰²)&lt;/strong&gt;ï¼šæŒ‡å®šå¤§æ¨¡å‹æ‹…å½“å›ºå®šè§’è‰²(ç¨‹åºå‘˜ã€æ•°æ®åˆ†æå¸ˆã€è®²è§£å‘˜ã€è®°è€…ç­‰ç­‰)&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;T-Task(ä»»åŠ¡)&lt;/strong&gt;: ä»»åŠ¡ï¼Œå‘Šè¯‰å¤§æ¨¡å‹éœ€è¦ä¸ºæˆ‘ä»¬åšçš„äº‹æƒ…&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;F-Format(æ ¼å¼)&lt;/strong&gt;ï¼šå¤§æ¨¡å‹æœ€ç»ˆç»“æœçš„è¿”å›æ ¼å¼(æ¯”å¦‚ï¼šè¡¨æ ¼ã€Markdownã€è‹±æ–‡ç­‰ç­‰)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä¸»è¦ä¼˜ç‚¹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ç®€å•ã€æ–¹ä¾¿&lt;/li&gt;
  &lt;li&gt;æŒ‡å®šRoleè§’è‰²ï¼Œå¯ä»¥è®©å¤§æ¨¡å‹åœ¨å½“å‰çš„è§’è‰²èŒƒå›´å†…å›ç­”çŸ¥è¯†ï¼Œè¿™åœ¨ä¸€äº›ç‰¹å®šçš„é¢†åŸŸä¸­éå¸¸æœ‰æ•ˆ&lt;/li&gt;
  &lt;li&gt;æŒ‡å®šRoleè§’è‰²ä¹Ÿèƒ½è®©å·¥ç¨‹ä¸Šæ£€ç´¢çŸ¥è¯†èƒ½å¤Ÿç¡®å®šè¾¹ç•ŒèŒƒå›´ï¼Œé…åˆå…ƒæ•°æ®æ‰€å‘æŒ¥çš„å¨åŠ›ä¼šæ›´å¼º&lt;/li&gt;
  &lt;li&gt;å¦‚æœç»“åˆRAGçŸ¥è¯†å†…å®¹æ£€ç´¢ï¼Œé‚£ä¹ˆä¸Šä¸‹æ–‡å›ç­”çš„å†…å®¹ä¼šè®©ç”¨æˆ·æ„Ÿè§‰æ›´åŠ æ˜¯é¡ºç•…&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹1&lt;/strong&gt;: &lt;strong&gt;ç»™å‡ºä¸€ä»½Pythonè¯­è¨€çš„å­¦ä¹ æ¸…å•&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Roleï¼šæŒ‡å®šå¤§æ¨¡å‹è§’è‰²ä¸ºPythonå¸ƒé“å¸ˆ&lt;/p&gt;

  &lt;p&gt;Taskï¼šPythonè¯­è¨€çš„å­¦ä¹ ä»åŸºç¡€åˆ°è¿›é˜¶æ¸…å•åˆ—è¡¨&lt;/p&gt;

  &lt;p&gt;Formatï¼š ä»¥è¡¨æ ¼çš„å½¢å¼è¿”å›&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/use-prompt-framework/prompt-usecase1.png&quot; alt=&quot;å›¾1-å®ç”¨RTFæ¡†æ¶&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨å®é™…å·¥ä½œçš„ä»»åŠ¡ä¸­ï¼Œæˆ‘é€šè¿‡ä¼˜åŒ–Promptå·¥ç¨‹ï¼Œå¯¹äºæˆ‘ä»¬çš„äº§å“æ”¹å–„ï¼Œå¯¹äºå›ç­”çš„å†…å®¹æ”¹å–„ä¹Ÿéå¸¸æ˜æ˜¾ï¼&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;åœ¨æˆ‘å¸ç»™å®æ³¢å¤©ä¸€é˜å¼€å‘çš„AIè®²è§£äº§å“ä¸­ï¼Œæˆ‘ä»¬æä¾›å’Œå¤§æ¨¡å‹å¯¹è¯çš„RAGäº§å“ï¼Œå°†å¤©ä¸€é˜çš„ç›¸å…³çŸ¥è¯†å¯¼å…¥åˆ°ç³»ç»Ÿï¼Œå€ŸåŠ©å¤§æ¨¡å‹è¿›è¡Œè®²è§£å›ç­”&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;å¯¹æ¯”ä»¥ä¸‹ä¸¤ä¸ªPromptçš„åŒºåˆ«ï¼š&lt;/p&gt;

&lt;p&gt;åŸPromptï¼š&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;åŸºäºä»¥ä¸‹å·²çŸ¥ä¿¡æ¯ï¼Œç®€æ´å’Œä¸“ä¸šçš„æ¥å›ç­”å¤©ä¸€é˜ç›¸å…³çš„çš„é—®é¢˜ã€‚
å¦‚æœæ— æ³•ä»ä¸­å¾—åˆ°ç­”æ¡ˆï¼Œè¯·è¯´ &quot;æ ¹æ®å·²çŸ¥ä¿¡æ¯æ— æ³•å›ç­”è¯¥é—®é¢˜&quot; æˆ– &quot;æ²¡æœ‰æä¾›è¶³å¤Ÿçš„ç›¸å…³ä¿¡æ¯&quot;ï¼Œä¸å…è®¸åœ¨ç­”æ¡ˆä¸­æ·»åŠ ç¼–é€ æˆåˆ†ï¼Œç­”æ¡ˆè¯·ä½¿ç”¨ä¸­æ–‡ã€‚
é—®é¢˜:
{}
å·²çŸ¥å†…å®¹:
{}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ”¹è¿›åçš„Promptï¼š&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ä½ æ˜¯å®æ³¢å¤©ä¸€é˜çš„å†å²ç ”ç©¶å‘˜ï¼ŒåŸºäºä»¥ä¸‹å·²çŸ¥ä¿¡æ¯ï¼Œç®€æ´å’Œä¸“ä¸šçš„æ¥å›ç­”å¤©ä¸€é˜ç›¸å…³çš„çš„é—®é¢˜ã€‚
å¦‚æœæ— æ³•ä»ä¸­å¾—åˆ°ç­”æ¡ˆï¼Œè¯·æ ¹æ®æ ¹æ®å®é™…å›ç­”ï¼Œä¸è¦è‡†æµ‹å†…å®¹ï¼Œå¦åˆ™è¯·è¯´ &quot;æ ¹æ®å·²çŸ¥ä¿¡æ¯æ— æ³•å›ç­”è¯¥é—®é¢˜&quot; æˆ– &quot;æ²¡æœ‰æä¾›è¶³å¤Ÿçš„ç›¸å…³ä¿¡æ¯&quot;ï¼Œä¸å…è®¸åœ¨ç­”æ¡ˆä¸­æ·»åŠ ç¼–é€ æˆåˆ†ï¼Œç­”æ¡ˆè¯·ä½¿ç”¨ä¸­æ–‡ã€‚
é—®é¢˜:
{}
å·²çŸ¥å†…å®¹:
{}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ”¹è¿›åï¼Œå¤§æ¨¡å‹å›ç­”æ›´åŠ æ‹ŸäººåŒ–ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/use-prompt-framework/image.png&quot; alt=&quot;å›¾2-ä¼˜åŒ–åçš„å¤§æ¨¡å‹Prompt&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;2æ€è€ƒé“¾æ¨¡å¼&quot;&gt;2.æ€è€ƒé“¾æ¨¡å¼&lt;/h2&gt;

&lt;p&gt;é€šè¿‡è¿™ç§æ¨¡å¼æ¥é€æ­¥æ”¹å–„å¤§æ¨¡å‹çš„æ¨ç†èƒ½åŠ›ï¼Œéå¸¸&lt;strong&gt;é€‚åˆä¸€äº›å¤æ‚çš„ä»»åŠ¡å¤„ç†&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ä¾‹å¦‚ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;åˆ†æå‹æˆ–è€…é€»è¾‘æ¨ç†å‹çš„ä»»åŠ¡&lt;/li&gt;
  &lt;li&gt;å†³ç­–&lt;/li&gt;
  &lt;li&gt;è§£å†³é—®é¢˜(æ¯”å¦‚ç¨‹åºå‘˜æ ¹æ®é”™è¯¯æ—¥å¿—æ‰¾Bug)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è€Œè¦ä½¿ç”¨è¿™ç§æ¨¡å¼ï¼Œ&lt;strong&gt;åªéœ€è¦åœ¨æœ«å°¾æ·»åŠ â€è®©æˆ‘ä»¬é€æ­¥æ€è€ƒâ€å³å¯&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/use-prompt-framework/prompt-step.png&quot; alt=&quot;å›¾3-é€æ­¥æ¨ç†æ¨¡å¼åº”ç”¨&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;3-risenæ¡†æ¶&quot;&gt;3. RISENæ¡†æ¶&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;R-Role&lt;/strong&gt;:å¤§æ¨¡å‹æ‰®æ¼”çš„è§’è‰²&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;I-Instructions&lt;/strong&gt;: æŒ‡ç¤ºå‘½ä»¤ï¼Œå’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Task-ä»»åŠ¡&lt;/code&gt;å·®ä¸å¤š&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;S-Steps&lt;/strong&gt;: æ­¥éª¤&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;E-End Goal&lt;/strong&gt;: æœ€ç»ˆç›®æ ‡&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;N-Narrowing(Constraints)&lt;/strong&gt;: ç¼©å°èŒƒå›´(çº¦æŸæ¡ä»¶)ï¼Œå’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RTF&lt;/code&gt;æ¡†æ¶ä¸­çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Format&lt;/code&gt;æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œä¸€ä¸ªæ˜¯æ ¼å¼çš„çº¦æŸï¼Œè€Œè¿™é‡Œçš„çº¦æŸå¯ä»¥æ˜¯ä»»æ„æ–¹é¢ï¼Œæ¯”å¦‚å›ç­”çš„å†…å®¹(ç‰¹å®šé¢†åŸŸ)ã€å­—æ•°é™åˆ¶ç­‰ç­‰æ–¹é¢&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¯¥æ¡†æ¶ä¸»è¦é€‚åˆï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ’°å†™å…·æœ‰ç‰¹å®šçº¦æŸçš„ä»»åŠ¡(ä¾‹å¦‚åšå®¢æ–‡ç« )&lt;/li&gt;
  &lt;li&gt;æœ‰æ˜ç¡®æŒ‡å¯¼æ–¹é’ˆçš„ä»»åŠ¡ï¼ˆä¾‹å¦‚å•†ä¸šè®¡åˆ’ï¼‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç¤ºä¾‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/use-prompt-framework/use-prompt-risen.png&quot; alt=&quot;å›¾4-RISENæ¡†æ¶ç¤ºä¾‹&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;4rodesæ¡†æ¶&quot;&gt;4.RODESæ¡†æ¶&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;R-Role: è§’è‰²&lt;/li&gt;
  &lt;li&gt;O - Objective: ç›®æ ‡&lt;/li&gt;
  &lt;li&gt;D - Details: è¯¦ç»†çš„ç»†èŠ‚&lt;/li&gt;
  &lt;li&gt;E - Examples: ç¤ºä¾‹&lt;/li&gt;
  &lt;li&gt;S - Sense Check: æ„Ÿå®˜æ£€æŸ¥&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç¤ºä¾‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/use-prompt-framework/use-prompt-rodes.png&quot; alt=&quot;å›¾5-RODESæ¡†æ¶ç¤ºä¾‹&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;5å¯†åº¦é“¾æ¨¡å¼&quot;&gt;5.å¯†åº¦é“¾æ¨¡å¼&lt;/h2&gt;

&lt;p&gt;å¯†åº¦é“¾æ¨¡å¼&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Prompt&lt;/code&gt;æ˜¯Salesforceã€éº»çœç†å·¥å­¦é™¢å’Œå“¥ä¼¦æ¯”äºšå¤§å­¦çš„ç ”ç©¶äººå‘˜æ¨å‡ºçš„ä¸€ç§æ–°æç¤ºï¼Œå®ƒéå¸¸çš„é«˜æ•ˆ,ä½¿ç”¨é€’å½’æ¥åˆ›å»ºè¶Šæ¥è¶Šå¥½çš„è¾“å‡ºçš„æç¤ºï¼Œä¸æ™®é€šæç¤ºç”Ÿæˆçš„ GPT-4 æ‘˜è¦ç›¸æ¯”ï¼Œå®ƒç”Ÿæˆçš„æ‘˜è¦æ›´åŠ å¯†é›†ä¸”æ›´é€‚åˆäººä»¬ç†è§£ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;è¿™ç§æ¨¡å¼åœ¨RAGå·¥ç¨‹ä¸­éå¸¸å®ç”¨ï¼Œæƒ³æƒ³çœ‹ä½ çš„å®¢æˆ·ä¸Šä¼ çš„æ–‡æ¡£çŸ¥è¯†åº“(PDF/WORD)éƒ½æ˜¯é•¿ç¯‡çš„æ­¥éª¤æ€§çš„æ–‡æ¡£,è€Œåœ¨RAGå¬å›é€ç»™å¤§æ¨¡å‹çš„Contextä¸Šä¸‹æ–‡åˆå—é™äºå¤§æ¨¡å‹çš„Tokené™åˆ¶,ä¸ºäº†æ›´å¥½çš„å›ç­”ç”¨æˆ·æé—®çš„é—®é¢˜ï¼Œå¯¹äºä¸Šä¼ çš„çŸ¥è¯†åº“åšå¯†åº¦é“¾æ¨¡å¼çš„æ‘˜è¦æ€»ç»“ï¼Œç„¶åç´¢å¼•æ•´ä¸ªæ–‡ç« å†…å®¹å¬å›æ˜¯éå¸¸æœ‰å¿…è¦çš„ï¼Œæœ€ç»ˆèƒ½å¤Ÿéå¸¸ç²¾å‡†çš„å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;é€‚åˆï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ€»ç»“&lt;/li&gt;
  &lt;li&gt;æ”¹è¿›æ‚¨æœ€å–œæ¬¢çš„æç¤º&lt;/li&gt;
  &lt;li&gt;é€šè¿‡é€’å½’ç”Ÿæˆå¯ç”¨çš„é•¿æ ¼å¼å†…å®¹&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¯†åº¦é“¾æ¨¡å¼çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Prompt&lt;/code&gt;å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/use-prompt-framework/prompt-chain-density.png&quot; alt=&quot;å›¾6-Chain of Density(Cod)prompt&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
æ–‡ç« : {ARTICLE}

æ‚¨å°†ä¸ºä¸Šè¿°æ–‡ç« ç”Ÿæˆè¶Šæ¥è¶Šç®€æ´ã€å®ä½“å¯†é›†çš„æ‘˜è¦ã€‚


é‡å¤ä»¥ä¸‹2ä¸ªæ­¥éª¤5æ¬¡ï¼š

- æ­¥éª¤1:ä»æ–‡ç« ä¸­è¯†åˆ«å‡ºå…ˆå‰ç”Ÿæˆçš„æ‘˜è¦ä¸­ç¼ºå°‘çš„ 1-3 ä¸ªä¿¡æ¯å®ä½“ï¼ˆä»¥â€œ;â€åˆ†éš”ï¼‰ã€‚
- æ­¥éª¤2:å†™ä¸€ä¸ªæ–°çš„ã€é•¿åº¦ç›¸åŒçš„ã€æ›´å¯†é›†çš„æ‘˜è¦ï¼Œå…¶ä¸­æ¶µç›–å…ˆå‰æ‘˜è¦ä¸­çš„æ¯ä¸ªå®ä½“å’Œç»†èŠ‚ä»¥åŠç¼ºå¤±çš„å†…å®¹å®ä½“ã€‚

ç¼ºå°‘çš„å®ä½“æ˜¯:

- **ç›¸å…³çš„:**ä¸ä¸»è¦æ•…äº‹ç›¸å…³ï¼Œ
- **å…·ä½“çš„:**æè¿°å…·ä½“è€Œç®€æ´ï¼ˆ5ä¸ªå­—æˆ–æ›´å°‘ï¼‰ï¼Œ
- **æ–°é¢–çš„:**ä¸åœ¨ä¹‹å‰çš„æ‘˜è¦ä¸­
- **åŠ¡å®çš„:**å­˜åœ¨äºæ–‡ç« ä¸­
- **ä»»ä½•åœ°æ–¹:** ä½äºæ–‡ç« ä¸­çš„ä»»ä½•ä½ç½®

**æŒ‡å—:**

- ç¬¬ä¸€ä¸ªæ‘˜è¦åº”è¯¥è¾ƒé•¿ï¼ˆ4-5å¥ï¼Œçº¦80ä¸ªè¯ï¼‰ï¼Œä½†éå¸¸ä¸å…·ä½“ï¼Œé™¤äº†æ ‡è®°ä¸ºç¼ºå¤±çš„å®ä½“å¤–ï¼Œå‡ ä¹æ²¡æœ‰åŒ…å«å…¶ä»–ä¿¡æ¯ã€‚ä½¿ç”¨è¿‡åº¦å†—é•¿çš„è¯­è¨€å’Œå¡«å……è¯ï¼ˆä¾‹å¦‚ï¼Œâ€œæœ¬æ–‡è®¨è®ºâ€ï¼‰ä»¥è¾¾åˆ°çº¦80ä¸ªè¯ã€‚
- è®©æ¯ä¸ªè¯éƒ½æœ‰æ„ä¹‰ï¼šé‡æ–°æ’°å†™å‰ä¸€ä¸ªæ‘˜è¦ä»¥æ”¹å–„æµç•…æ€§ï¼Œå¹¶ä¸ºé¢å¤–çš„å®ä½“è…¾å‡ºç©ºé—´ã€‚
- åˆ©ç”¨èåˆã€å‹ç¼©å’Œåˆ é™¤è¯¸å¦‚â€œæ–‡ç« è®¨è®ºâ€çš„æ— ä¿¡æ¯çŸ­è¯­ï¼Œè…¾å‡ºç©ºé—´ã€‚
- æ‘˜è¦åº”å˜å¾—éå¸¸å¯†é›†è€Œç®€æ´ï¼Œä½†åˆæ˜¯è‡ªåŒ…å«çš„ï¼Œä¾‹å¦‚ï¼Œä¸éœ€è¦é˜…è¯»æ–‡ç« å°±èƒ½å®¹æ˜“ç†è§£ã€‚
- ç¼ºå¤±çš„å®ä½“å¯ä»¥å‡ºç°åœ¨æ–°æ‘˜è¦çš„ä»»ä½•ä½ç½®ã€‚
- æ°¸è¿œä¸è¦åˆ é™¤å‰ä¸€ä¸ªæ‘˜è¦ä¸­çš„å®ä½“ã€‚å¦‚æœæ— æ³•è…¾å‡ºç©ºé—´ï¼Œå°±æ·»åŠ æ›´å°‘çš„æ–°å®ä½“ã€‚

è¯·è®°ä½ï¼Œå¯¹äºæ¯ä¸ªæ‘˜è¦éƒ½ä½¿ç”¨ç›¸åŒæ•°é‡çš„è¯ã€‚

ä»¥JSONæ ¼å¼å›ç­”ã€‚JSONåº”è¯¥æ˜¯ä¸€ä¸ªå­—å…¸åˆ—è¡¨ï¼ˆé•¿åº¦ä¸º5ï¼‰ï¼Œå…¶ä¸­é”®æ˜¯â€œMissing_Entitiesâ€å’Œâ€œDenser_Summaryâ€ã€‚

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å…³äºå¯†åº¦é“¾æ¨¡å¼çš„Promptè®ºæ–‡å¯ä»¥å‚è€ƒï¼š&lt;a href=&quot;https://arxiv.org/pdf/2309.04269.pdf&quot;&gt;https://arxiv.org/pdf/2309.04269.pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æˆ–è€…å¾®ä¿¡å…¬ä¼—å·å›å¤â€codâ€è·å–æ–‡ä»¶&lt;/p&gt;

&lt;h2 id=&quot;æ€»ç»“&quot;&gt;æ€»ç»“&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Prompt&lt;/code&gt;å¯¹è¯æç¤ºæ¡†æ¶åœ¨å¤§æ¨¡å‹é¢†åŸŸä¸­æ˜¯éå¸¸é‡è¦çš„ä¸€ç¯,ä¸ç®¡ä½ æ˜¯åœ¨ç›´æ¥ä½¿ç”¨å¤§æ¨¡å‹ï¼Œè¿˜æ˜¯åœ¨åšRAGé¢†åŸŸçš„äº§å“å¼€å‘,&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Prompt&lt;/code&gt;çš„é‡è¦ç¨‹åº¦éƒ½æ˜¯æ— å¯æ›¿ä»£çš„ã€‚&lt;/p&gt;

&lt;p&gt;å¸Œæœ›å¤§å®¶èƒ½æ ¹æ®æœ¬æ–‡åˆ—å‡ºçš„è¿™5ç§&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Prompt&lt;/code&gt;æ¡†æ¶è¿›è¡Œä¸¾ä¸€åä¸‰ï¼Œå¤šå¤šå®è·µï½&lt;/p&gt;

&lt;p&gt;å¯¹äº&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Prompt&lt;/code&gt;å·¥ç¨‹æŠ€æœ¯ç»†èŠ‚ï¼Œå¯ä»¥é˜…è¯»å‘˜å¤–çš„è¿™ä¸¤ç¯‡æ–‡ç« :&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.luxiangdong.com/2023/08/08/prompt/&quot;&gt;ä¸€æ–‡è®²æ¸…æ¥šå®ç”¨Promptå·¥ç¨‹&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.luxiangdong.com/2023/08/08/advprompt/&quot;&gt;é«˜çº§promptå·¥ç¨‹è®²è§£&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="å¤§æ¨¡å‹" /><summary type="html">å‰è¨€</summary></entry><entry><title type="html">å®æˆ˜0-1,Javaå¼€å‘è€…ä¹Ÿèƒ½çœ‹æ‡‚çš„å¤§æ¨¡å‹åº”ç”¨RAGå¼€å‘å®è·µ</title><link href="http://localhost:4000/2023/10/12/rag-inaction-java/" rel="alternate" type="text/html" title="å®æˆ˜0-1,Javaå¼€å‘è€…ä¹Ÿèƒ½çœ‹æ‡‚çš„å¤§æ¨¡å‹åº”ç”¨RAGå¼€å‘å®è·µ" /><published>2023-10-12T00:00:00+08:00</published><updated>2023-10-12T00:00:00+08:00</updated><id>http://localhost:4000/2023/10/12/rag-inaction-java</id><content type="html" xml:base="http://localhost:4000/2023/10/12/rag-inaction-java/">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h2&gt;

&lt;p&gt;åœ¨å‰å‡ å¤©çš„æ–‡ç« ä¸­ï¼Œæˆ‘åˆ†äº«è¯´åœ¨RAGé¢†åŸŸï¼Œå¾ˆå¤šéƒ½æ˜¯å·¥ç¨‹ä¸Šçš„å®è·µï¼ŒåšAIå¤§æ¨¡å‹åº”ç”¨çš„å¼€å‘å…¶å®Javaä¹Ÿèƒ½å†™ï¼Œé‚£ä¹ˆæœ¬æ–‡å°±ä¸€ä¸ªJavaå¼€å‘è€…çš„ç«‹åœºï¼Œæ„å»ºå®ç°ä¸€ä¸ªæœ€åŸºç¡€çš„å¤§æ¨¡å‹åº”ç”¨ç³»ç»Ÿã€‚&lt;/p&gt;

&lt;p&gt;è€Œå¤§æ¨¡å‹åº”ç”¨ç³»ç»Ÿå…¶å®åœ¨ç›®å‰é˜¶æ®µï¼Œå¯èƒ½åº”ç”¨æœ€å¹¿çš„è¿˜æ˜¯RAGé¢†åŸŸï¼Œå› æ­¤ï¼Œæœ¬æ–‡ä¹Ÿæ˜¯é€šè¿‡åœ¨RAGé¢†åŸŸçš„åŸºç¡€æ¶æ„ä¸‹ï¼Œæ¥å®ç°åº”ç”¨çš„å¼€å‘ï¼Œä¸»è¦éœ€æ±‚ç‚¹ï¼š&lt;strong&gt;è®©å¤§æ¨¡å‹ç†è§£æ–‡æœ¬(çŸ¥è¯†åº“)å†…å®¹ï¼ŒåŸºäºçŸ¥è¯†åº“èŒƒå›´å†…çš„å†…å®¹è¿›è¡Œå›ç­”å¯¹è¯&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;è€ŒåŸºäºçŸ¥è¯†åº“çš„å›ç­”ä¼šå¸®åŠ©æˆ‘ä»¬è§£å†³å“ªäº›é—®é¢˜å‘¢ï¼Ÿ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;âœ… &lt;strong&gt;èŠ‚çœå¤§æ¨¡å‹è®­ç»ƒæˆæœ¬ï¼š&lt;/strong&gt;æˆ‘ä»¬çŸ¥é“ChatGPTçš„çŸ¥è¯†å†…å®¹åœç•™åœ¨2021å¹´ï¼Œæœ€æ–°çš„çŸ¥è¯†å®ƒå¹¶ä¸çŸ¥é“ï¼Œè€Œæ£€ç´¢å¢å¼ºç”Ÿæˆåˆ™å¯ä»¥è§£å†³å¤§æ¨¡å‹æ— æ³•å¿«é€Ÿå­¦ä¹ çš„é—®é¢˜ï¼Œè®­ç»ƒå¤§æ¨¡å‹ä»£ä»·æ˜¯éå¸¸æ˜‚è´µçš„ï¼Œä¸ä»…ä»…åªæ˜¯é‡‘é’±ï¼Œè¿˜åŒ…æ‹¬æ—¶é—´ï¼Œéšç€æ¨¡å‹çš„å‚æ•°å¤§å°æˆæœ¬æˆæ­£ç›¸å…³ã€‚&lt;/li&gt;
  &lt;li&gt;âœ… &lt;strong&gt;è®©å¤§æ¨¡å‹æ›´èªæ˜ï¼š&lt;/strong&gt;å¾ˆå¤šä¼ä¸šå†…éƒ¨çš„ç§æœ‰æ•°æ®å¤§æ¨¡å‹å¹¶æ²¡æœ‰å­¦ä¹ ï¼Œè€Œé€šè¿‡RAGçš„æ–¹å¼å¯ä»¥è®©å¤§æ¨¡å‹åœ¨çŸ¥è¯†åº“èŒƒå›´çš„é¢†åŸŸè¿›è¡Œå›ç­”ï¼Œé¿å…èƒ¡è¯´å…«é“ï¼ŒåŸºäºåº•å±‚å¤§æ¨¡å‹çš„åŸºåº§ï¼Œå¯ä»¥è®©æˆ‘ä»¬çš„åº”ç”¨ç³»ç»Ÿçœ‹ä¸Šå»æ›´åŠ çš„èªæ˜ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨æœ¬æ–‡ä¸­ï¼Œä½ å°†å­¦ä¹ åˆ°ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;âœ… RAGå·¥ç¨‹çš„åŸºæœ¬å¤„ç†æ¡†æ¶æµç¨‹(åŸºäºJava)&lt;/li&gt;
  &lt;li&gt;âœ… å‘é‡æ•°æ®åº“çš„åŸºç¡€ä½¿ç”¨åŠäº†è§£&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;æŠ€æœ¯æ ˆ&quot;&gt;æŠ€æœ¯æ ˆ&lt;/h2&gt;

&lt;p&gt;è€ƒè™‘åˆ°ä½œè€…ä¹Ÿæ˜¯Javaå¼€å‘è€…ï¼Œå› æ­¤æœ¬æ–‡æ‰€é€‰æ‹©çš„æŠ€æœ¯æ ˆä»¥åŠä¸­é—´ä»¶ä¹Ÿæ˜¯Javaäººå‘˜éƒ½è€³ç†Ÿèƒ½è¯¦çš„ï¼Œä¸»è¦æŠ€æœ¯æ ˆå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ã€å¼€å‘æ¡†æ¶ï¼š&lt;/strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Spring Boot&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Spring Shell&lt;/code&gt;(å‘½ä»¤è¡Œå¯¹è¯)&lt;/p&gt;

&lt;p&gt;Javaå¼€å‘è€…å¯¹äº&lt;strong&gt;Spring Boot&lt;/strong&gt;çš„ç”Ÿæ€åº”è¯¥æ˜¯éå¸¸ç†Ÿæ‚‰çš„ï¼Œè€Œé€‰æ‹©&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Spring Shell&lt;/code&gt;å·¥å…·åŒ…ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºå‘½ä»¤è¡Œçš„äº¤äº’é—®ç­”æ•ˆæœï¼Œå’Œæœ¬æ¬¡çš„æŠ€æœ¯æ— å¤ªå¤§å…³ç³»ï¼Œç®—æ˜¯ä¸€ä¸ªæœ€å°é›å½¢çš„äº§å“äº¤äº’ä½“éªŒã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ã€HTTPç»„ä»¶ï¼š&lt;/strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;OkHTTP&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;OkHTTP-SSE&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;æ­¤æ¬¡æˆ‘ä»¬é€‰æ‹©çš„å¤§æ¨¡å‹æ˜¯ä»¥æ™ºè°±AIå¼€æ”¾çš„ChatGLMç³»åˆ—ä¸ºä¸»ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦HTTPç»„ä»¶å’Œå•†ä¸šå¤§æ¨¡å‹çš„APIè¿›è¡Œæ¥å£çš„å¯¹æ¥ï¼Œå½“ç„¶å¼€å‘è€…å¦‚æœæœ‰è¶³å¤Ÿçš„æ¡ä»¶ï¼Œä¹Ÿæ˜¯å¯ä»¥åœ¨æœ¬åœ°éƒ¨ç½²å¼€æºå¤§æ¨¡å‹å¹¶ä¸”å¼€æ”¾APIæ¥å£è¿›è¡Œè°ƒè¯•çš„ï¼Œè¿™ä¸ªå¹¶ä¸å†²çªï¼Œæœ¬æ–‡åªæ˜¯ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºæ•ˆæœï¼Œæ‰€ä»¥ä½¿ç”¨äº†æ™ºè°±çš„å¤§æ¨¡å‹APIæ¥å£ï¼Œè€Œæ™ºè°±AIæ³¨å†Œåï¼Œé»˜è®¤æä¾›äº†ä¸€ä¸ª18å…ƒçš„å…è´¹Tokenæ¶ˆè´¹é¢åº¦ï¼Œå› æ­¤æ¥å£çš„API-Keyåªéœ€è¦æ³¨å†Œä¸€ä¸ªå³å¯å¿«é€Ÿè·å–ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3ã€å·¥å…·åŒ…ï¼š&lt;/strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Hutool&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;éå¸¸å¥½ç”¨çš„ä¸€ä¸ªåŸºç¡€å·¥å…·åŒ…ç»„ä»¶ï¼Œå°è£…äº†å¾ˆå¤šå·¥å…·ç±»æ–¹æ³•ï¼ŒåŒ…å«å­—ç¬¦ã€æ–‡ä»¶ã€æ—¶é—´ã€é›†åˆç­‰ç­‰&lt;/p&gt;

&lt;p&gt;æœ¬æ–‡ä¼šä½¿ç”¨åˆ°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Hutool&lt;/code&gt;åŒ…çš„æ–‡æœ¬è¯»å–å’Œåˆ‡å‰²æ–¹æ³•ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4ã€å‘é‡æ•°æ®åº“ï¼š&lt;/strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ElasticSearch&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;å‘é‡æ•°æ®åº“æ˜¯RAGåº”ç”¨ç¨‹åºçš„åŸºç¡€ä¸­é—´ä»¶ï¼Œæ‰€æœ‰çš„æ–‡æœ¬Embeddingå‘é‡éƒ½éœ€è¦å­˜å‚¨åœ¨å‘é‡æ•°æ®åº“ä¸­é—´ä»¶ä¸­è¿›è¡Œå¬å›è®¡ç®—ï¼Œå½“ç„¶åœ¨Javaé¢†åŸŸå¹¶æ²¡æœ‰ç±»ä¼¼Pythonä¸­&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;numpy&lt;/code&gt;è¿™ç±»æœ¬åœ°åŒ–å·¥å…·ç»„ä»¶åŒ…ï¼Œå³å¯å¿«é€Ÿå®ç°çŸ©é˜µè®¡ç®—ç­‰éœ€æ±‚(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PS:æœ€è¿‘Java21çš„å‘å¸ƒä¸­ï¼Œä¸ä»…ä»…åªæ˜¯è™šæ‹Ÿçº¿ç¨‹ç­‰æ–°ç‰¹æ€§ï¼Œæä¾›çš„å‘é‡APIç›¸ä¿¡åœ¨æœªæ¥AIé¢†åŸŸï¼ŒJavaä¹Ÿä¼šæœ‰ä¸€å¸­ä¹‹åœ°çš„&lt;/code&gt;)ï¼Œæ‰€ä»¥é€‰æ‹©äº†ç‹¬ç«‹éƒ¨ç½²çš„ä¸­é—´ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;æœ¬æ–‡é€‰æ‹©&lt;strong&gt;ElasticSearch&lt;/strong&gt;å¯èƒ½å¯¹äºJavaå¼€å‘äººå‘˜ä¹Ÿæ˜¯æ¯”è¾ƒç†Ÿæ‚‰çš„ä¸€ä¸ªç»„ä»¶ï¼Œæ¯•ç«ŸESåœ¨Javaé¢†åŸŸç”¨é€”è¿˜æ˜¯éå¸¸å¹¿çš„ï¼Œåªæ˜¯å¯èƒ½å¾ˆå¤šå¼€å‘è€…å¹¶ä¸çŸ¥é“ElasticSearchå±…ç„¶è¿˜æœ‰å­˜å‚¨å‘é‡æ•°æ®çš„åŠŸèƒ½ï¼Ÿ&lt;/p&gt;

&lt;p&gt;å¯¹äºå‘é‡æ•°æ®åº“ä¸­é—´ä»¶çš„é€‰æ‹©ï¼Œç›®å‰å¸‚é¢ä¸Šæœ‰éå¸¸å¤šçš„å‘é‡æ•°æ®åº“ï¼ŒåŒ…æ‹¬ï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Milvus&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Qdrant&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Postgres(pgvector)&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Chroma&lt;/code&gt; ç­‰ç­‰ï¼ŒJavaå¼€å‘è€…å¯ä»¥åœ¨ç†Ÿæ‚‰å½“å‰æµç¨‹åï¼Œæ ¹æ®è‡ªå·±çš„å®é™…éœ€æ±‚ï¼Œé€‰æ‹©ç¬¦åˆä¼ä¸šç”Ÿäº§ç¯å¢ƒçš„å‘é‡æ•°æ®åº“ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;5ã€LLMå¤§æ¨¡å‹&lt;/strong&gt;ï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ChatGLM-Std&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ï¼Œæœ¬æ–‡ç›´æ¥ä½¿ç”¨å¼€æ”¾APIæ¥å£çš„å•†ä¸šå¤§æ¨¡å‹ï¼Œæ™ºè°±AIæä¾›çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ChatGLM-Std&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;ragå·¥ç¨‹çš„åŸºæœ¬å¤„ç†æµç¨‹&quot;&gt;RAGå·¥ç¨‹çš„åŸºæœ¬å¤„ç†æµç¨‹&lt;/h2&gt;

&lt;p&gt;åœ¨RAGæ£€ç´¢å¢å¼ºç”Ÿæˆé¢†åŸŸä¸­ï¼Œæœ€ç®€å•çš„æ ¸å¿ƒå¤„ç†æµç¨‹æ¶æ„å›¾å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;è¯¥æ¶æ„å›¾å›¾æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æµç¨‹å›¾ï¼Œåœ¨RAGé¢†åŸŸä¸­å…¶å®æœ‰éå¸¸å¤šçš„å¤„ç†ç»†èŠ‚ï¼Œå½“æˆ‘ä»¬æ·±å…¥äº†è§£åå°±ä¼šçŸ¥é“&lt;/p&gt;

  &lt;p&gt;æˆ‘ä»¬åç»­æ ¹æ®è¯¥å›¾æ¥è¿›è¡ŒJavaç¼–ç å®ç°ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/rag-java-action/001.png&quot; alt=&quot;å›¾1-RAGé€šç”¨æ¡†æ¶æµç¨‹æ¶æ„ç¤ºæ„å›¾&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨RAGåº”ç”¨å·¥ç¨‹é¢†åŸŸï¼Œå…¶å®æ•´ä¸ªç¨‹åºçš„å¤„ç†åŒ…å«ä¸¤éƒ¨åˆ†ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;é—®ç­”ï¼š&lt;/strong&gt;å¯¹ç”¨æˆ·æé—®çš„é—®é¢˜é€šè¿‡å‘é‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Embedding&lt;/code&gt;æ¨¡å‹å¤„ç†ï¼Œç„¶åé€šè¿‡æŸ¥è¯¢å‘é‡æ•°æ®åº“(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ElasticSearch&lt;/code&gt;)è¿›è¡Œç›¸ä¼¼åº¦è®¡ç®—è·å–å’Œç”¨æˆ·é—®é¢˜æœ€ç›¸ä¼¼çš„çŸ¥è¯†åº“æ®µè½å†…å®¹ï¼Œè·å–æˆåŠŸåï¼Œæ„å»º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Prompt&lt;/code&gt;ï¼Œæœ€ç»ˆå‘é€ç»™å¤§æ¨¡å‹è·å–æœ€ç»ˆçš„ç­”æ¡ˆã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ•°æ®å¤„ç†ï¼š&lt;/strong&gt;æ•°æ®çš„å¤„ç†æ˜¯å°†ç”¨æˆ·ç§æœ‰çš„æ•°æ®è¿›è¡Œæå–ï¼ŒåŒ…æ‹¬å„ç§ç»“æ„åŒ–åŠéç»“æ„åŒ–æ•°æ®(ä¾‹å¦‚&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PDF&lt;/code&gt;/&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Word&lt;/code&gt;/&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Text&lt;/code&gt;ç­‰ç­‰)ï¼Œæå–æ–‡æœ¬æ•°æ®åè¿›è¡Œåˆ†å‰²å¤„ç†ï¼Œæœ€ç»ˆé€šè¿‡å‘é‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Embedding&lt;/code&gt;æ¨¡å‹å°†è¿™äº›åˆ†å‰²åçš„æ®µè½è¿›è¡Œå‘é‡åŒ–ï¼Œæœ€ç»ˆå‘é‡æ•°æ®å­˜å‚¨åœ¨åŸºç¡€è®¾æ–½å‘é‡æ•°æ®åº“ç»„ä»¶ä¸­ï¼Œä»¥ä¾›åç»­çš„é—®ç­”æµç¨‹ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåœ¨æˆ‘ä»¬æ‰€éœ€è¦çš„å¤§æ¨¡å‹å¤„äºä»€ä¹ˆä½ç½®ï¼Œä»¥åŠå®ƒçš„ä½œç”¨ï¼Œä¸»è¦æ˜¯&lt;strong&gt;ä¸¤ä¸ªæ¨¡å‹&lt;/strong&gt;çš„åº”ç”¨ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å‘é‡Embeddingæ¨¡å‹ï¼š&lt;/strong&gt;å¯¹æˆ‘ä»¬æœ¬åœ°çŸ¥è¯†çš„å‘é‡è¡¨å¾å¤„ç†ï¼Œå°†æ–‡æœ¬å†…å®¹è½¬åŒ–ä¸ºä¾¿äºè®¡ç®—æœºç†è§£çš„å‘é‡è¡¨ç¤º&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;LLMé—®ç­”å¤§æ¨¡å‹ï¼š&lt;/strong&gt;å¤§æ¨¡å‹è´Ÿè´£å°†æˆ‘ä»¬é€šè¿‡è¯­ä¹‰å¬å›çš„æ®µè½+ç”¨æˆ·çš„é—®é¢˜ç»“åˆï¼Œæ„å»ºçš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Prompt&lt;/code&gt;é€ç»™å¤§æ¨¡å‹ä»¥è·å–æœ€ç»ˆçš„ç­”æ¡ˆï¼Œé—®ç­”å¤§æ¨¡å‹åœ¨è¿™é‡Œå……å½“çš„è§’è‰²æ˜¯ç†è§£æˆ‘ä»¬é€ç»™ä»–çš„å†…å®¹ï¼Œç„¶åè¿›è¡Œç²¾å‡†å›ç­”&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;javaç¼–ç å®è·µ&quot;&gt;Javaç¼–ç å®è·µ&lt;/h2&gt;

&lt;p&gt;æˆ‘ä»¬ç†è§£äº†åŸºç¡€çš„æ¶æ„æµç¨‹ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç¼–ç å®ç°äº†&lt;/p&gt;

&lt;h3 id=&quot;ç¯å¢ƒå‡†å¤‡&quot;&gt;ç¯å¢ƒå‡†å¤‡&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Javaï¼š&lt;/strong&gt;JDK 1.8&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ElasticSearchï¼š&lt;/strong&gt;7.16.1&lt;/p&gt;

&lt;p&gt;å¯¹äº&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ElasticSearch&lt;/code&gt;çš„å®‰è£…ï¼Œå¯ä»¥é€šè¿‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker-compose&lt;/code&gt;åœ¨æœ¬åœ°å¿«é€Ÿéƒ¨ç½²ä¸€ä¸ª&lt;/p&gt;

&lt;p&gt;ç¼–å†™&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker-compose.yml&lt;/code&gt;é…ç½®æ–‡ä»¶ï¼Œå½“å‰éƒ¨ç½²ç›®å½•å»º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;data&lt;/code&gt;æ–‡ä»¶å¤¹æŒ‚è½½æ•°æ®ç›®å½•&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;3&quot;&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;services&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;elasticsearch&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;elasticsearch:7.16.1&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;ports&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;9200:9200&quot;&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;9300:9300&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;environment&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;s&quot;&gt;node.name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;es&lt;/span&gt;
      &lt;span class=&quot;s&quot;&gt;cluster.name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;elasticsearch&lt;/span&gt;
      &lt;span class=&quot;s&quot;&gt;discovery.type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;single-node&lt;/span&gt;  
      &lt;span class=&quot;na&quot;&gt;ES_JAVA_OPTS&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;-Xms4096m -Xmx4096m&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;volumes&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;./data:/usr/share/elasticsearch/data&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;deploy&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;resources&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;limits&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;cpus&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;4&quot;&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;memory&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;5G&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;reservations&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;cpus&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;1&quot;&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;memory&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;2G&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;restart&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;always&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¯åŠ¨Esï¼š&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker-compose up -d&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;åº”ç”¨åˆä½“éªŒ&quot;&gt;åº”ç”¨åˆä½“éªŒ&lt;/h2&gt;

&lt;p&gt;å…ˆæ¥çœ‹æ•´ä¸ªç¨‹åºçš„åº”ç”¨æ•ˆæœï¼Œé€šè¿‡Spring Shellç¯å¢ƒä¸‹ï¼Œç¨‹åºå¯åŠ¨åï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/rag-java-action/image-20231011223529653.png&quot; alt=&quot;å›¾3-ç¨‹åºå¯åŠ¨æ•ˆæœ&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ç¨‹åºå¯åŠ¨åï¼Œåœ¨å‘½ä»¤è¡Œç»ˆç«¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¯äº¤äº’çš„å‘½ä»¤è¡Œï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;add&lt;/code&gt;å’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chat&lt;/code&gt;ä¸¤ä¸ªå‘½ä»¤å®Œæˆå›¾1ä¸­çš„æ•´ä¸ªæµç¨‹&lt;/p&gt;

&lt;p&gt;å…ˆä½¿ç”¨&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;add&lt;/code&gt;å‘½ä»¤åŠ è½½æ–‡æ¡£ï¼Œåœ¨&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;data&lt;/code&gt;ç›®å½•ä¸‹åˆ†åˆ«å­˜å‚¨äº†&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;001.txt&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;002.txt&lt;/code&gt;ä¸¤ä¸ªæ–‡ä»¶ï¼Œé€šè¿‡å‘½ä»¤åŠ è½½å‘é‡å¤„ç†ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/rag-java-action/image-20231011223800438.png&quot; alt=&quot;å›¾4-ADDå‘½ä»¤åŠ è½½æ–‡ä»¶&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å½“æ—¥å¿—æ˜¾ç¤ºä¿å­˜å‘é‡æˆåŠŸåï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬å³å¯ä»¥é€šè¿‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chat&lt;/code&gt;å‘½ä»¤è¿›è¡Œå¯¹è¯äº†ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;002.txt&lt;/code&gt;çš„æ–‡æœ¬ä¸»è¦è¯´äº†ä»€ä¹ˆå†…å®¹ï¼Ÿ&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;dataç›®å½•ä¸‹çš„æ–‡æœ¬ï¼Œå¼€å‘è€…åœ¨è°ƒè¯•æ—¶å¯ä»¥è‡ªå·±éšæ„æ·»åŠ ,ç½‘ä¸Šéšä¾¿æ‰¾çš„æ–‡ç« éƒ½å¯ä»¥&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/image-20231011223914297.png&quot; alt=&quot;å›¾5-çŸ¥è¯†æ–‡æœ¬å†…å®¹&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æ–‡ç« å†…å®¹æ˜¯ä¸€ç¯‡éå¸¸å…·æœ‰ä»£è¡¨æ€§çš„æ—¶æ”¿äººç‰©ä»‹ç»æ–°é—»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ ¹æ®è¯¥æ–‡ç« çš„å†…å®¹è¿›è¡Œé—®ç­”ï¼&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;é—®é¢˜1:è‹å·2022å¹´å…¨å¸‚çš„GDPæ˜¯å¤šå°‘?&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/rag-java-action/image-20231011224157706.png&quot; alt=&quot;å›¾6-é—®ç­”è°ƒè¯•&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;é—®é¢˜2:å‰æ—çœå®£ä¼ éƒ¨éƒ¨é•¿ç°åœ¨æ˜¯è°ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/rag-java-action/image-20231011224356744.png&quot; alt=&quot;å›¾7-é—®ç­”è°ƒè¯•1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;é€šè¿‡ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œä½ æ˜¯å¦å¯ä»¥å‘ç°é—®é¢˜å‘¢ï¼Ÿï¼Œå¦‚æœä½ é—®ChatGPTä¸€æ ·çš„é—®é¢˜ï¼Œå®ƒèƒ½å‡†ç¡®å›ç­”å—ï¼Ÿ&lt;/p&gt;

&lt;p&gt;ä»¥ä¸‹æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ChatGPT&lt;/code&gt;çš„å›ç­”&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/rag-java-action/image-20231012074115652.png&quot; alt=&quot;å›¾8-ChatGPTå›ç­”å†…å®¹&quot; /&gt;&lt;/p&gt;

&lt;p&gt;é€šè¿‡å¯¹æ¯”&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ChatGPT&lt;/code&gt;ï¼Œå¼€å‘è€…åº”è¯¥èƒ½çœ‹åˆ°ä¸€ä¸ªåŸºç¡€çš„å¯¹æ¯”æ•ˆæœï¼Œä¸»è¦ä½“ç°ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æˆ‘ä»¬éƒ½çŸ¥é“ChatGPTå¤§æ¨¡å‹çš„å†…å®¹æ—¥æœŸæˆªæ­¢åˆ°2021å¹´ï¼Œä¹‹åä¸–ç•Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Œå®ƒå¹¶ä¸çŸ¥é“ï¼ŒåŒç±»çš„GPTå¤§æ¨¡å‹ä¹Ÿä¼šå‡ºç°ä¸€æ ·çš„é—®é¢˜ï¼Œå› ä¸ºè®­ç»ƒå¤§æ¨¡å‹çš„ä»£ä»·æ˜¯éå¸¸æ˜‚è´µçš„ï¼Œä¸å¯èƒ½æŒ‰å‘¨ã€æœˆï¼Œç”šè‡³æ˜¯å¹´çš„é¢‘ç‡å»æ›´æ–°å¤§æ¨¡å‹ã€‚&lt;/li&gt;
  &lt;li&gt;åŸºäºç°æœ‰çš„çŸ¥è¯†å›ç­”å†…å®¹(RAG)ï¼Œèƒ½å¤Ÿæœ‰æ•ˆçš„&lt;strong&gt;é¿å…å¤§æ¨¡å‹èƒ¡è¯´å…«é“&lt;/strong&gt;,è€Œä¸”&lt;strong&gt;å›ç­”çš„æ›´ç²¾å‡†&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;æŠ€æœ¯å®ç°&quot;&gt;æŠ€æœ¯å®ç°&lt;/h2&gt;

&lt;p&gt;è¿›è¡Œé—®ç­”ä½“éªŒåï¼Œæˆ‘ä»¬æ¥çœ‹å…·ä½“çš„Javaä»£ç å®ç°ã€‚&lt;/p&gt;

&lt;p&gt;æ–°å»º&lt;strong&gt;Spring Boot&lt;/strong&gt;é¡¹ç›®ï¼Œå·¥ç¨‹ç›®å½•å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;GitHub&lt;/strong&gt;ï¼š&lt;a href=&quot;https://github.com/xiaoymin/LlmInAction/tree/master/llm_chat_java_hello&quot;&gt;https://github.com/xiaoymin/LlmInAction/tree/master/llm_chat_java_hello&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/rag-java-action/image-20231011222852231.png&quot; alt=&quot;å›¾2-Javaä»£ç ç›®å½•ç»“æ„&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä»ä¸Šæ–‡çš„RAGæµç¨‹å›¾ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“äº†ä¸»è¦åˆ†ä¸¤ä¸ªæ­¥éª¤æ¥å®ç°ï¼Œåˆ†åˆ«æ˜¯&lt;strong&gt;æ•°æ®çš„å‘é‡å¤„ç†&lt;/strong&gt;å’Œ&lt;strong&gt;é—®ç­”&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ç”±äºæ˜¯é€šè¿‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Spring Shell&lt;/code&gt;è¿›è¡Œå®ç°ï¼Œå› æ­¤è¿™é‡Œæˆ‘ä¹Ÿåˆ†å¼€ï¼Œä¸»è¦å®ç°äº†ä¸¤ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Command&lt;/code&gt;å‘½ä»¤ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;add&lt;/strong&gt;ï¼šåœ¨dataç›®å½•ä¸‹ï¼Œä¸ºäº†æ¼”ç¤ºéœ€è¦ï¼Œå­˜æ”¾äº†ä¸¤ä¸ªtxtå†…å®¹ï¼Œå¯ä»¥é€šè¿‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;add fileåç§°&lt;/code&gt;æ¥å®ç°æ–‡æ¡£çš„å‘é‡åŒ–æµç¨‹åŠ è½½å¤„ç†ï¼Œæ•°æ®çš„å¤„ç†å¼€å‘è€…åœ¨å®é™…çš„ç”Ÿäº§è¿‡ç¨‹ä¸­å¯ä»¥é€šè¿‡å®šæ—¶ä»»åŠ¡ã€MQæ¶ˆæ¯ç­‰æ–¹å¼è¿›è¡Œå¼‚æ­¥å¤„ç†ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;chatï¼š&lt;/strong&gt;é€šè¿‡å‘½ä»¤&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chat é—®é¢˜&lt;/code&gt;å³å¯åœ¨Spring Shellçš„å‘½ä»¤è¡Œç»ˆç«¯è¿›è¡Œå¯¹è¯ï¼Œå¯ä»¥é—®&lt;strong&gt;data&lt;/strong&gt;ç›®å½•ä¸‹ç›¸å…³çš„é—®é¢˜&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä¸ºäº†æ–¹ä¾¿åç»­çš„å¤„ç†ï¼Œç¨‹åºå¯åŠ¨æ—¶å³ä¼šè‡ªåŠ¨æ„å»ºå‘é‡æ•°æ®åº“çš„ç´¢å¼•é›†åˆï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/**
     * åˆå§‹åŒ–å‘é‡æ•°æ®åº“index
     * @param collectionName åç§°
     * @param dim ç»´åº¦
     */&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initCollection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collectionName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;collection:{}&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collectionName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// æŸ¥çœ‹å‘é‡ç´¢å¼•æ˜¯å¦å­˜åœ¨ï¼Œæ­¤æ–¹æ³•ä¸ºå›ºå®šé»˜è®¤ç´¢å¼•å­—æ®µ&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;IndexOperations&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;indexOperations&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;elasticsearchRestTemplate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;indexOps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;IndexCoordinates&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;collectionName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;indexOperations&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;exists&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// ç´¢å¼•ä¸å­˜åœ¨ï¼Œç›´æ¥åˆ›å»º&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;index not exists,create&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;//åˆ›å»ºesçš„ç»“æ„ï¼Œç®€åŒ–å¤„ç†&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;Document&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;document&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Document&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;elasticMapping&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// åˆ›å»º&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;indexOperations&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Esä¸­çš„Indexçš„Mappingç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/rag-java-action/image-20231011230453855.png&quot; alt=&quot;å›¾9-ESå‘é‡Index-Mappingç»“æ„&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;å¼€å‘è€…éœ€è¦æ³¨æ„vectorå­—æ®µï¼Œå­—æ®µç±»å‹æ—¶&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dense_vector&lt;/code&gt;,å¹¶ä¸”æŒ‡å®šå‘é‡ç»´åº¦ä¸º1024&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;å‘é‡ç»´åº¦çš„é•¿åº¦æŒ‡å®šæ˜¯å’Œæœ€ç»ˆå‘é‡Embeddingæ¨¡å‹æ¯æ¯ç›¸å…³çš„ï¼Œä¸åŒçš„æ¨¡å‹æœ‰ä¸åŒçš„ç»´åº¦ï¼Œæ¯”å¦‚ChatGPTçš„å‘é‡æ¨¡å‹ç»´åº¦æ˜¯1536ï¼Œç™¾åº¦æ–‡å¿ƒä¸€è¨€ä¹Ÿæœ‰368çš„ï¼Œå› æ­¤æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œé€‰æ‹©ã€‚&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;è€Œè¿™é‡Œå› ä¸ºæˆ‘ä»¬é€‰æ‹©çš„æ˜¯æ™ºè°±AIçš„å‘é‡æ¨¡å‹ï¼Œè¯¥æ¨¡å‹è¿”å›çš„ç»´åº¦ä¸º1024ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨å‘é‡æ•°æ®åº“çš„ç»´åº¦å°±è®¾ç½®ä¸º1024&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;é¦–å…ˆæ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;add&lt;/code&gt;å‘½ä»¤å®ç°æ–‡æ¡£çš„å‘é‡åŒ–è¿‡ç¨‹å¤„ç†ï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Slf4j&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@AllArgsConstructor&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@ShellComponent&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;AddTxtCommand&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TxtChunk&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txtChunk&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;VectorStorage&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vectorStorage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ZhipuAI&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zhipuAI&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@ShellMethod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;add local txt data&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;start add doc.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// åŠ è½½&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ChunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chunkResults&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txtChunk&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;chunk&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// embedding&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;EmbeddingResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embeddingResults&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zhipuAI&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;embedding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunkResults&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// store vector&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vectorStorage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getCollectionName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vectorStorage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;store&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;collection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embeddingResults&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;finished&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;finished docId:{}&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬å®Œå…¨æŒ‰ç…§å›¾1RAGçš„æµç¨‹æ¶æ„å›¾è¿›è¡Œä»£ç çš„å˜ç°ï¼Œä¸»è¦çš„æ­¥éª¤ï¼š&lt;/p&gt;

&lt;p&gt;1ã€åŠ è½½æŒ‡å®šçš„æ–‡æ¡£ï¼Œå¹¶ä¸”å°†æ–‡æ¡£å†…å®¹è¿›è¡Œåˆ†å‰²å¤„ç†(æŒ‰å›ºå®šsizeå¤§å°è¿›è¡Œåˆ†å‰²å¤„ç†)ï¼Œå¾—åˆ°åˆ†å‰²é›†åˆ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chunkResults&lt;/code&gt;ï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Slf4j&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@Component&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@AllArgsConstructor&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TxtChunk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ChunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;chunk&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;docId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;data/&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;docId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;.txt&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;start chunk---&amp;gt; docId:{},path:{}&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;docId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// è¯»å–dataç›®å½•ä¸‹çš„æ–‡ä»¶æµ&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;ClassPathResource&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;classPathResource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ClassPathResource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// è¯»å–ä¸ºæ–‡æœ¬&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;IoUtil&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classPathResource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StandardCharsets&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;UTF_8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;//æŒ‰å›ºå®šå­—æ•°åˆ†å‰²,256&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lines&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;StrUtil&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;txt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;chunk size:{}&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ArrayUtil&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lines&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ChunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;();&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;//æ­¤å¤„ç»™æ¯ä¸ªæ–‡æ¡£ä¸€ä¸ªå›ºå®šçš„chunkId&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;AtomicInteger&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;atomicInteger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;AtomicInteger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;line:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lines&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
                &lt;span class=&quot;nc&quot;&gt;ChunkResult&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ChunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;chunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setDocId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;docId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;chunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setContent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;chunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setChunkId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;atomicInteger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;incrementAndGet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2ã€å°†åˆ†å—çš„é›†åˆé€šè¿‡æ™ºè°±AIæä¾›çš„å‘é‡&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Embedding&lt;/code&gt;æ¨¡å‹è¿›è¡Œå‘é‡åŒ–å¤„ç†ï¼Œä»£ç å®ç°å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/**
     * æ‰¹é‡
     * @param chunkResults æ‰¹é‡æ–‡æœ¬
     * @return å‘é‡
     */&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;EmbeddingResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;embedding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ChunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chunkResults&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;start embedding,size:{}&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;CollectionUtil&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunkResults&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;CollectionUtil&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isEmpty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunkResults&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)){&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;EmbeddingResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embeddingResults&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ChunkResult&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;chunkResult:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunkResults&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;//åˆ†åˆ«å¤„ç†&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;embeddingResults&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;embedding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embeddingResults&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;EmbeddingResult&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;embedding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ChunkResult&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;//è·å–æ™ºè°±AIçš„å¼€å‘Key&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;apiKey&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getApiKey&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// åˆå§‹åŒ–httpå®¢æˆ·ç«¯&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;OkHttpClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Builder&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;OkHttpClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;connectTimeout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TimeUnit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;MILLISECONDS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;readTimeout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TimeUnit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;MILLISECONDS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;writeTimeout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TimeUnit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;MILLISECONDS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addInterceptor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ZhipuHeaderInterceptor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;apiKey&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;OkHttpClient&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;okHttpClient&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;EmbeddingResult&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embedRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;EmbeddingResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;embedRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setPrompt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getContent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;embedRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setRequestId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Objects&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getChunkId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()));&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// æ™ºè°±embeddingæ¨¡å‹æ¥å£&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Request&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://open.bigmodel.cn/api/paas/v3/model-api/text_embedding/invoke&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;RequestBody&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;MediaType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ContentType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()),&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;GSON&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toJson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;Response&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;okHttpClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;newCall&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;ZhipuResult&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zhipuResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;GSON&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fromJson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ZhipuResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;EmbeddingResult&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zhipuResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setPrompt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getPrompt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setRequestId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getRequestId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;RuntimeException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3ã€å‘é‡å¤„ç†æˆåŠŸåï¼Œæˆ‘ä»¬å³å¯å°†å‘é‡æ•°æ®å­˜å‚¨åœ¨å‘é‡æ•°æ®åº“ä¸­é—´ä»¶(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ElasticSearch&lt;/code&gt;)ä¸­,è°ƒç”¨&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vectorStorage.store&lt;/code&gt;å¤„ç†ï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s&quot;&gt;public void store(String collectionName,List&amp;lt;EmbeddingResult&amp;gt; embeddingResults){&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;//ä¿å­˜å‘é‡&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;log.info(&quot;save vector,collection:{},size:{}&quot;,collectionName, CollectionUtil.size(embeddingResults));&lt;/span&gt;

        &lt;span class=&quot;s&quot;&gt;List&amp;lt;IndexQuery&amp;gt; results = new ArrayList&amp;lt;&amp;gt;();&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;for (EmbeddingResult embeddingResult&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;embeddingResults) {&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;ElasticVectorData ele = new ElasticVectorData();&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;ele.setVector(embeddingResult.getEmbedding());&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;ele.setChunkId(embeddingResult.getRequestId());&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;ele.setContent(embeddingResult.getPrompt());&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;results.add(new IndexQueryBuilder().withObject(ele).build());&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;// æ„å»ºæ•°æ®åŒ…&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;List&amp;lt;IndexedObjectInformation&amp;gt; bulkedResult = elasticsearchRestTemplate.bulkIndex(results, IndexCoordinates.of(collectionName));&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;int size = CollectionUtil.size(bulkedResult);&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;log.info(&quot;ä¿å­˜å‘é‡æˆåŠŸ-size:{}&quot;, size);&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è‡³æ­¤ï¼Œæ•´ä¸ªæ–‡æœ¬æ•°æ®çš„Embeddingå¤„ç†å°±å®Œæˆäº†ã€‚&lt;/p&gt;

&lt;p&gt;æ•°æ®å¤„ç†å®Œæˆåï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å®ç°é—®ç­”&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chat&lt;/code&gt;å‘½ä»¤,æ¥çœ‹ä»£ç å®ç°ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@AllArgsConstructor&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@Slf4j&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@ShellComponent&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ChatCommand&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;VectorStorage&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vectorStorage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ZhipuAI&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zhipuAI&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@ShellMethod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;chat with files&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;chat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;question&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;StrUtil&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isBlank&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;question&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)){&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;You must send a question&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;//å¥å­è½¬å‘é‡&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zhipuAI&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;question&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// å‘é‡å¬å›&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vectorStorage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getCollectionName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vectorData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vectorStorage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;retrieval&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;collection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;StrUtil&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isBlank&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vectorData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)){&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;No Answer!&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// æ„å»ºPrompt&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prompt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LLMUtils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;buildPrompt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;question&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vectorData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;zhipuAI&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;chat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prompt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// å¤§æ¨¡å‹å¯¹è¯&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;//return &quot;you question:{}&quot;+question+&quot;finished.&quot;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StrUtil&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;EMPTY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Chat&lt;/code&gt;å‘½ä»¤ä¸»è¦åŒ…å«çš„æ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;1ã€å°†ç”¨æˆ·çš„é—®å¥é¦–å…ˆé€šè¿‡å‘é‡Embeddingæ¨¡å‹è½¬åŒ–å¾—åˆ°ä¸€ä¸ªå¤šç»´çš„æµ®ç‚¹å‹å‘é‡æ•°ç»„ï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/**
     * è·å–å¥å­çš„å‘é‡
     * @param sentence å¥å­
     * @return å‘é‡
     */&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;ChunkResult&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ChunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;chunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setContent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;chunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setChunkId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;RandomUtil&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;randomInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;EmbeddingResult&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embeddingResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;embedding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunkResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embeddingResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getEmbedding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2ã€æ ¹æ®å‘é‡æ•°æ®æŸ¥è¯¢å‘é‡æ•°æ®åº“å¬å›ç›¸ä¼¼çš„æ®µè½å†…å®¹ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vectorStorage.retrieval&lt;/code&gt;æ–¹æ³•ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;retrieval&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collectionName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// Build the script,æŸ¥è¯¢å‘é‡&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;query_vector&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// è®¡ç®—coså€¼+1ï¼Œé¿å…å‡ºç°è´Ÿæ•°çš„æƒ…å†µï¼Œå¾—åˆ°ç»“æœåï¼Œå®é™…scoreå€¼åœ¨å‡1å†è®¡ç®—&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Script&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Script&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ScriptType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;INLINE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Script&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;DEFAULT_SCRIPT_LANG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;cosineSimilarity(params.query_vector, 'vector')+1&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;ScriptScoreQueryBuilder&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scriptScoreQueryBuilder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ScriptScoreQueryBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;QueryBuilders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;boolQuery&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// æ„å»ºè¯·æ±‚&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;NativeSearchQuery&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nativeSearchQuery&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;NativeSearchQueryBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;withQuery&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scriptScoreQueryBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;withPageable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Pageable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ofSize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;SearchHits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ElasticVectorData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataSearchHits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;elasticsearchRestTemplate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nativeSearchQuery&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ElasticVectorData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IndexCoordinates&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;collectionName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;//log.info(&quot;æ£€ç´¢æˆåŠŸï¼Œsize:{}&quot;, dataSearchHits.getTotalHits());&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;SearchHit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ElasticVectorData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataSearchHits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getSearchHits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LinkedList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;SearchHit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ElasticVectorData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ele&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ele&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getContent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getContent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CollectionUtil&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¿™é‡Œä¸»è¦åˆ©ç”¨äº†&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ElasticSearch&lt;/code&gt;æä¾›çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cosineSimilarity&lt;/code&gt;ä½™å¼¦ç›¸ä¼¼æ€§å‡½æ•°ï¼Œè®¡ç®—å‘é‡å¾—åˆ°ç›¸ä¼¼åº¦çš„åˆ†å€¼ï¼Œ&lt;strong&gt;åˆ†å€¼ä¼šåœ¨åŒºé—´[0,1]ä¹‹é—´ï¼Œå¦‚æœæ— é™è¶‹è¿‘äº1é‚£ä¹ˆä»£è¡¨ç”¨æˆ·è¾“å…¥çš„å¥å­å’Œä¹‹å‰æˆ‘ä»¬å­˜å‚¨åœ¨å‘é‡ä¸­çš„å¥å­æ˜¯éå¸¸ç›¸ä¼¼çš„ï¼Œè¶Šç›¸ä¼¼ä»£è¡¨æˆ‘ä»¬æ‰¾åˆ°äº†è¯­ä¹‰ç›¸è¿‘çš„æ–‡æ¡£å†…å®¹ï¼Œå¯ä»¥ä½œä¸ºæœ€ç»ˆæ„å»ºå¤§æ¨¡å‹Promptçš„åŸºç¡€å†…å®¹ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;å‘é‡çŸ©é˜µçš„è®¡ç®—é™¤äº†ä½™å¼¦ç›¸ä¼¼æ€§ï¼Œè¿˜æœ‰IPç‚¹ç§¯ã€æ¬§å‡ é‡Œå¾—è·ç¦»ç­‰ç­‰ï¼Œæ ¹æ®å®é™…æƒ…å†µé€‰æ‹©ä¸åŒçš„ç®—æ³•å®ç°ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;3ã€å‘é‡å¬å›Top3å¾—åˆ°ç›¸ä¼¼çš„è¯­ä¹‰æ–‡æœ¬å†…å®¹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„å»º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Prompt&lt;/code&gt;äº†ï¼Œå¹¶ä¸”å‘é€ç»™å¤§æ¨¡å‹ï¼Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Prompt&lt;/code&gt;å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;buildPrompt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;question&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;è¯·åˆ©ç”¨å¦‚ä¸‹ä¸Šä¸‹æ–‡çš„ä¿¡æ¯å›ç­”é—®é¢˜ï¼š&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\n&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;question&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\n&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;ä¸Šä¸‹æ–‡ä¿¡æ¯å¦‚ä¸‹ï¼š&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\n&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\n&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;å¦‚æœä¸Šä¸‹æ–‡ä¿¡æ¯ä¸­æ²¡æœ‰å¸®åŠ©,åˆ™ä¸å…è®¸èƒ¡ä¹±å›ç­”ï¼&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è€Œåœ¨æ„å»º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Prompt&lt;/code&gt;æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥éµå¾ªä¸€ä¸ªæœ€ç®€å•çš„æ¡†æ¶èŒƒå¼,&lt;strong&gt;RTFæ¡†æ¶(Role-Task-Format)&lt;/strong&gt;ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;R-Role&lt;/strong&gt;ï¼šæŒ‡å®šGPTå¤§æ¨¡å‹æ‹…ä»»ç‰¹å®šçš„è§’è‰²&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;T-Task&lt;/strong&gt;ï¼šä»»åŠ¡,éœ€è¦å¤§æ¨¡å‹åšçš„äº‹æƒ…&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;F-Format&lt;/strong&gt;ï¼šå¤§æ¨¡å‹è¿”å›çš„å†…å®¹æ ¼å¼(å¸¸è§„æƒ…å†µä¸‹å¯ä»¥å¿½ç•¥)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;4ã€æœ€åæ˜¯è°ƒç”¨å¤§æ¨¡å‹ï¼Œå®ç°sseæµå¼è°ƒç”¨è¾“å‡ºï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;chat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prompt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;OkHttpClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Builder&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;OkHttpClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;connectTimeout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TimeUnit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;MILLISECONDS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;readTimeout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TimeUnit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;MILLISECONDS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;writeTimeout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TimeUnit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;MILLISECONDS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addInterceptor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ZhipuHeaderInterceptor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getApiKey&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()));&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;OkHttpClient&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;okHttpClient&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

            &lt;span class=&quot;nc&quot;&gt;ZhipuChatCompletion&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zhipuChatCompletion&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ZhipuChatCompletion&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;zhipuChatCompletion&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addPrompt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prompt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// é‡‡æ ·æ¸©åº¦ï¼Œæ§åˆ¶è¾“å‡ºçš„éšæœºæ€§ï¼Œå¿…é¡»ä¸ºæ­£æ•°&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// å€¼è¶Šå¤§ï¼Œä¼šä½¿è¾“å‡ºæ›´éšæœºï¼Œæ›´å…·åˆ›é€ æ€§ï¼›å€¼è¶Šå°ï¼Œè¾“å‡ºä¼šæ›´åŠ ç¨³å®šæˆ–ç¡®å®š&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;zhipuChatCompletion&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setTemperature&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.7f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;zhipuChatCompletion&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setTop_p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.7f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

            &lt;span class=&quot;nc&quot;&gt;EventSource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Factory&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;factory&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;EventSources&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;createFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;okHttpClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;ObjectMapper&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mapper&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ObjectMapper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requestBody&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mapper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;writeValueAsString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zhipuChatCompletion&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;Request&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://open.bigmodel.cn/api/paas/v3/model-api/chatglm_std/sse-invoke&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;RequestBody&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;MediaType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ContentType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requestBody&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;CountDownLatch&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;countDownLatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CountDownLatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// åˆ›å»ºäº‹ä»¶,æ§åˆ¶å°è¾“å‡º&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;EventSource&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eventSource&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;factory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;newEventSource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ConsoleEventSourceListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;countDownLatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;countDownLatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;llm-chatå¼‚å¸¸ï¼š{}&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;SSEæµå¼çš„è°ƒç”¨æˆ‘ä»¬ä½¿ç”¨äº†&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;okhttp-sse&lt;/code&gt;ç»„ä»¶æä¾›çš„åŠŸèƒ½å¿«é€Ÿå®ç°ã€‚&lt;/p&gt;

&lt;p&gt;å¥½äº†ï¼Œæ•´ä¸ªå·¥ç¨‹å±‚é¢çš„Javaä»£ç å®ç°å°±å·²ç»å…¨éƒ¨å®Œæˆäº†ã€‚&lt;/p&gt;

&lt;h2 id=&quot;æœ€å&quot;&gt;æœ€å&lt;/h2&gt;

&lt;p&gt;ä»¥ä¸Šå°±æ˜¯æœ¬ç‰‡åˆ†äº«çš„å…¨éƒ¨å†…å®¹äº†ï¼Œé€šè¿‡Javaå¼€å‘è¯­è¨€ï¼Œå®ç°ä¸€ä¸ªæœ€å°å¯ç”¨çº§åˆ«çš„RAGå¤§æ¨¡å‹åº”ç”¨ï¼ç›¸ä¿¡ä½ çœ‹å®Œæœ¬æ–‡åï¼Œä¹Ÿèƒ½å¤Ÿå¯¹AIå¤§æ¨¡å‹åº”ç”¨çš„å¼€å‘æœ‰ä¸€ä¸ªåŸºæœ¬çš„äº†è§£ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœä½ ä¹Ÿåœ¨å…³æ³¨å¤§æ¨¡å‹ã€RAGæ£€ç´¢å¢å¼ºç”ŸæˆæŠ€æœ¯ï¼Œæ¬¢è¿å…³æ³¨æˆ‘ï¼Œä¸€èµ·æ¢ç´¢å­¦ä¹ ã€æˆé•¿ï½ï¼&lt;/p&gt;

&lt;h2 id=&quot;é™„å½•&quot;&gt;é™„å½•&lt;/h2&gt;

&lt;p&gt;æœ¬æ–‡ä»£ç Githubï¼š&lt;a href=&quot;https://github.com/xiaoymin/LlmInAction&quot;&gt;https://github.com/xiaoymin/LlmInAction&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æ™ºè°±AIï¼š&lt;a href=&quot;https://open.bigmodel.cn/&quot;&gt;https://open.bigmodel.cn/&lt;/a&gt;&lt;/p&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="å¤§æ¨¡å‹" /><category term="Java" /><summary type="html">å‰è¨€</summary></entry><entry><title type="html">å…¨é¢è¿›å‡»AIå¤§æ¨¡å‹ã€RAGé¢†åŸŸ</title><link href="http://localhost:4000/2023/10/10/llm-start/" rel="alternate" type="text/html" title="å…¨é¢è¿›å‡»AIå¤§æ¨¡å‹ã€RAGé¢†åŸŸ" /><published>2023-10-10T00:00:00+08:00</published><updated>2023-10-10T00:00:00+08:00</updated><id>http://localhost:4000/2023/10/10/llm-start</id><content type="html" xml:base="http://localhost:4000/2023/10/10/llm-start/">&lt;h2 id=&quot;å†™åœ¨å‰é¢&quot;&gt;å†™åœ¨å‰é¢&lt;/h2&gt;

&lt;p&gt;é¦–å…ˆï¼Œ&lt;strong&gt;éå¸¸æ„Ÿè°¢å…³æ³¨Knife4jé¡¹ç›®çš„æœ‹å‹&lt;/strong&gt;ï¼Œè¯¥å…¬ä¼—å·åº”è¯¥æ˜¯ä»Šå¹´å¼€å§‹ï¼Œå¯¹äºå¼€æºé¡¹ç›®Knife4jçš„æ›´æ–°éƒ½åœ¨æ­¤å…¬ä¼—å·è¿›è¡Œäº†ç¬¬ä¸€æ—¶é—´çš„å‘å¸ƒæ›´æ–°ï¼ŒåŒ…æ‹¬è¯¥é¡¹ç›®çš„è¿­ä»£ã€æƒ³æ³•ã€å®è·µç­‰ç­‰å†…å®¹ï¼ŒåŒ…æ‹¬æœ€è¿‘Knife4jçš„ä»˜è´¹äº§å“Knife4jInsightçš„æ¨å‡ºï¼Œè™½ç„¶æ›´æ–°çš„ä¸æ˜¯å¾ˆé¢‘ç¹ï¼Œä½†å¯¹äºè¿˜æ˜¯è¦ç»™è‡ªå·±ä¸€ç›´åšæŒçš„äº‹æƒ…åšè¾“å‡ºç‚¹èµçš„(æ„ŸåŠ¨äº†è‡ªå·±ğŸ˜¹)ã€‚å¯¹äºå†™å…¬ä¼—å·è€Œè¨€ï¼Œå¯¹äºæ–‡ç« çš„å‘è¡¨ï¼Œå¦‚æœæœ‰äººæŒç»­å…³æ³¨çš„è¯ï¼Œä¼šæ˜¯ä¸€ç§æ­£å‘çš„é¼“åŠ±ï½ï¼&lt;/p&gt;

&lt;p&gt;è€Œç°åœ¨ï¼Œè€ƒè™‘åˆ°æˆ‘å®é™…å·¥ä½œä¸­çš„å†…å®¹ï¼Œç›®å‰å·¥ä½œæ ¸å¿ƒæ˜¯åœ¨åš&lt;strong&gt;å¤§æ¨¡å‹RAG(æ£€ç´¢å¢å¼ºç”Ÿæˆ)æ–¹é¢&lt;/strong&gt;çš„å¼€å‘å·¥ä½œï¼Œä¸»è¦è¿˜æ˜¯ä»¥JavaæŠ€æœ¯æ ˆè¿›è¡Œäº§å“çš„åŠŸèƒ½è¿­ä»£å¼€å‘ï¼ŒPythonè¯­è¨€åˆ™æ›´å¤šçš„åå‘åº•å±‚å¤§æ¨¡å‹æ–¹é¢ï¼ŒåŒ…æ‹¬å¤§æ¨¡å‹(LLM)çš„è®­ç»ƒã€å¾®è°ƒã€æ•°æ®æ ‡æ³¨ã€å‘é‡Embeddingç­‰é¢†åŸŸï¼Œå·¥ç¨‹ä¸Šï¼Œä¸šåŠ¡äº§å“æµ‹çš„é€»è¾‘å®ç°ã€ç¼–æ’ï¼Œæ¥å£å¼€å‘ç­‰ç­‰åŠŸèƒ½è¿˜æ˜¯ä»¥Javaè¯­è¨€å®ç°ä¸ºä¸»ï¼Œå¹¶éä½¿ç”¨å½“ä¸‹æœ€ç«çš„LangChainã€LlaMaIndexç­‰Pythonæ¡†æ¶ï¼Œæˆ‘åœ¨æ˜¨å¤©çœ‹ä¸€æœ¬ä¹¦&lt;strong&gt;ã€ŠJavaå¼€å‘ä¹‹é“ã€‹&lt;/strong&gt;é‡Œé¢æåˆ°ï¼Œå¼€å‘è€…åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œ&lt;strong&gt;åœ¨äº§å“æˆ–é¡¹ç›®å¼€å‘å‘¨æœŸç»“æŸåï¼Œéœ€è¦å–„äºæ€»ç»“è‡ªå·±çš„å·¥ä½œå†…å®¹&lt;/strong&gt;ï¼Œæˆ‘è§‰å¾—ä»¥Blogæˆ–è€…è§†é¢‘çš„å½¢å¼è¿›è¡Œè¾“å‡ºæœ€å¥½ï¼Œè¿™æ ·æ‰èƒ½æ›´å¿«é€Ÿçš„æˆé•¿ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘å›æƒ³èµ·è¿™ä¹ˆå¤šå¹´çš„å·¥ä½œï¼Œå¯¹äºä¸€ä¸ªé¢†åŸŸï¼Œ&lt;strong&gt;ä¸ç®¡æ˜¯æŠ€æœ¯å±‚é¢ï¼Œæˆ–è€…æ˜¯ä¸šåŠ¡å±‚é¢ï¼Œä¼¼ä¹ä¸€ç›´æ˜¯ç¼ºå°‘æ€»ç»“æ€§çš„è¾“å‡ºçš„ï¼Œæˆ–è€…è¯´åšçš„éƒ½ä¸æ˜¯å¤ªæ·±å…¥&lt;/strong&gt;ã€‚åœ¨æ—©äº›æ—¶å€™ï¼Œæˆ‘å’Œæˆ‘çš„è€å¤§å“¥å‘˜å¤–è¯´ï¼Œè¿™ä¹ˆå¤šå¹´åšçš„ä¸œè¥¿ä¸ç®¡æ˜¯äº§å“ã€è¿˜æ˜¯é¡¹ç›®ï¼Œéƒ½ä¸å¤ªèƒ½æ‹¿çš„å‡ºæ‰‹ï¼Œè€Œ&lt;strong&gt;éšç€æ—¶é—´è¶Šä¹…ï¼Œè¿™ç§æ·±æ·±çš„æŒ«è´¥æ„Ÿ&lt;/strong&gt;å°±ä»å†…å¿ƒæ²¹ç„¶è€Œç”Ÿï¼Œæ¯æ¯æƒ³èµ·ï¼Œéƒ½è‡ªæ„Ÿæ¼ç«ğŸ˜«ã€‚ä¸»è¦åŸå› è¿˜æ˜¯æˆ‘ä»¬åšçš„ä¸œè¥¿éƒ½å¤ªè¡¨é¢äº†ï¼Œåœ¨æŠ€æœ¯å±‚é¢ï¼Œæˆ‘ä»¬å¾ˆå¤šæŠ€æœ¯éƒ½æ˜¯æµ®äºè¡¨é¢ï¼Œå¹¶&lt;strong&gt;æ²¡æœ‰åšæŒç»­æ·±åº¦çš„ç²¾è¿›&lt;/strong&gt;ï¼Œäº§å“å±‚é¢ï¼Œä¸€ä¸ªåƒæ ·çš„&lt;strong&gt;äº§å“æ˜¯ç»è¿‡åƒé”¤ç™¾ç‚¼çš„æ‰“ç£¨&lt;/strong&gt;çš„ï¼Œç»†æ‰£æ¯ä¸€ä¸ªç»†èŠ‚ï¼ŒæŠŠåŒç±»ç«å“æ¯”ä¸‹å»ï¼Œä¹Ÿè®¸äº§å“ä¸Šé¢ä¸€ä¸ªçœ‹ä¼¼ä¸èµ·çœ¼çš„ä¼˜ç‚¹ï¼Œéƒ½èƒ½æŠŠåŒç±»çš„ç«å“ç»™æ¯”ä¸‹å»ï¼Œè€Œè¦åšåˆ°äº§å“ä¸Šçš„ä¼˜åŠ¿ä½“ç°ï¼ŒæŠ€æœ¯äººå‘˜çš„æŠ•å…¥æ˜¯æˆæ­£ç›¸å…³çš„ã€‚é¡¹ç›®å°±æ›´ä¸ç”¨è¯´äº†ï¼Œ&lt;strong&gt;äº¤é’¥åŒ™å·¥ç¨‹(å†…éƒ¨ä»£å·ï¼Œæ„æŒ‡é¡¹ç›®åšå®Œå°±éªŒæ”¶äº†ï¼Œè‡³äºä½¿ç”¨å¦‚ä½•ï¼ŒåŠŸèƒ½å¥½ä¸å¥½ç”¨ä»æ¥æ²¡careè¿‡ï¼Œä¸šä¸»ä¹Ÿä¸care)&lt;/strong&gt;çš„é¡¹ç›®åšçš„å·²ç»æ•°éƒ½æ•°ä¸è¿‡æ¥äº†ã€‚&lt;/p&gt;

&lt;p&gt;è€Œæœ€è¿‘æˆ‘å’Œæˆ‘çš„è€ä¼™è®¡å‘˜å¤–å·²ç»ä¸€å¤´æ‰è¿›äº†AIå¤§æ¨¡å‹ã€RAG(Retrieval Augmented Generation-æ£€ç´¢å¢å¼ºç”Ÿæˆ)è¿™ä¸ªèµ›é“ï¼Œæ¯å¤©è®¨è®ºçš„éƒ½æ˜¯å¤§æ¨¡å‹ã€RAGç­‰ç›¸å…³å†…å®¹ï¼Œç„¶åäº§å“çš„æŠ€æœ¯æ ˆå¼€å‘åˆæ˜¯Javaä¸ºä¸»ï¼ŒPythonä¸ºè¾…ï¼Œåœ¨Javaè¯­è¨€è¿™ä¸ªé¢†åŸŸå¼€å‘AIåº”ç”¨ï¼Œå¥½åƒç›®å‰åœ¨RAGè¿™ä¸ªé¢†åŸŸå¹¶æ²¡æœ‰ç›¸å…³çš„æŠ€æœ¯æ–‡æ¡£ã€åšå®¢è¾“å‡ºï¼ŒåŸºæœ¬80%éƒ½æ˜¯Pythonï¼Œæˆ‘åœ¨çœ‹äº†&lt;strong&gt;LangChain&lt;/strong&gt;ã€&lt;strong&gt;LlaMaIndex&lt;/strong&gt;ç­‰Pythonæ¡†æ¶å¤„ç†å¼€å‘å¤§æ¨¡å‹åº”ç”¨(ä¸»è¦æ˜¯RAG)æ—¶ï¼Œé™¤äº†åœ¨æœ¬åœ°åŠ è½½å¤§æ¨¡å‹å¤–ï¼Œå¾ˆå¤šå…¶å®éƒ½æ˜¯å·¥ç¨‹æ–¹é¢çš„çŸ¥è¯†ï¼Œå¹¶éä¸€å®šè¦ä½¿ç”¨Pythonè¯­è¨€æ¥è¿›è¡Œå¼€å‘ï¼Œè€Œæˆ‘æœ€è¿‘å®é™…å·¥ä½œä¸­åˆåœ¨åšè¿™ä¸ªï¼Œå› æ­¤ï¼Œå¸Œæœ›èƒ½å¤Ÿé€šè¿‡ä»¥Java+Pythonä¸¤ç§è¯­è¨€çš„å½¢å¼ï¼Œé€šè¿‡å­¦ä¹ å¤§æ¨¡å‹ã€RAGç­‰æ–°å‹é¢†åŸŸçš„çŸ¥è¯†,ç”šè‡³æ˜¯å­¦ä¹ Pythonè¯­è¨€ï¼Œå°†è‡ªå·±å­¦åˆ°çš„å†…å®¹ä»¥åŠä¸€äº›å·¥ä½œä¸­çš„å®è·µé€šè¿‡æ–‡ç« çš„æ–¹å¼è¿›è¡Œè¾“å‡ºåˆ†äº«ï¼Œæ›´å¤šçš„è¿˜æ˜¯ä¼šå°†å†…å®¹åº”ç”¨çš„å®é™…çš„äº§å“ä¸­ï¼Œä¹Ÿå¸Œæœ›åœ¨è¿™ä¸ªé¢†åŸŸåšä¸€ä¸ªæ·±è€•ï¼Œä¸ç®¡æ˜¯æŠ€æœ¯ä¸Šè¿˜æ˜¯ä¸šåŠ¡é¢†åŸŸï¼Œå¤§æ¨¡å‹è¿™ä¸€æ³¢ï¼Œæˆ‘è§‰å¾—æ¯ä¸€ä¸ªå¼€å‘è€…éƒ½åº”è¯¥æŒç»­ä¿æŒå…³æ³¨ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨AIå¤§æ¨¡å‹ã€RAGè¿™ä¸ªèµ›é“ï¼Œæˆ‘ä»¬è¦åšçš„äº‹æƒ…ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;æŠ€æœ¯ï¼š&lt;/strong&gt;æ·±æŒ–AIå¤§æ¨¡å‹ã€RAGé¢†åŸŸçš„æŠ€æœ¯ç»†èŠ‚(åº”ç”¨å·¥ç¨‹é¢†åŸŸ)ï¼Œä»æ€æƒ³ã€ä»£ç ã€æ¶æ„ç­‰é¢†åŸŸéƒ½éœ€è¦&lt;strong&gt;èŠ±120%çš„æŠ•å…¥&lt;/strong&gt;ï¼ŒçŸ¥å…¶æ‰€ä»¥ç„¶ï¼&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;â˜‘ï¸ è€ƒè™‘åˆ°æˆ‘å¹¶éæç®—æ³•çš„äººå‘˜ï¼Œåº•å±‚çš„å¤§æ¨¡å‹ç®—æ³•ç­‰å†…å®¹ï¼Œæˆ‘è§‰å¾—å¯¹äºæˆ‘è‡ªå·±çš„è¦æ±‚è€Œè¨€ï¼Œåšåˆ°çŸ¥é“ã€äº†è§£å³å¯ï¼Œç”šè‡³æœ‰å¿…è¦çš„è¯ï¼Œæä¸€å¼ 4090(å¤ªè´µäº†ï¼Œè¿˜æ²¡èˆå¾—ä¹°)çš„å¡è·‘è·‘é¢„è®­ç»ƒçš„æ¨¡å‹ä¹Ÿæ˜¯æœ‰å¿…è¦çš„ï¼&lt;/p&gt;

      &lt;p&gt;â˜‘ï¸ RAGé¢†åŸŸåœ¨å·¥ç¨‹å±‚é¢çš„çŸ¥è¯†æ‰€æ¶‰åŠçš„é¢ä¹Ÿæ˜¯è¶³å¤Ÿå¹¿çš„ï¼Œå¯¹äºåšåº”ç”¨å¼€å‘è€…è€Œè¨€ï¼Œä¹Ÿå¹¶éä¸€æœä¸€å¤•å°±èƒ½å…¨ç›˜äº†è§£å…¶ä¸­çš„ç»†èŠ‚ï¼Œéœ€è¦åšçš„å°±æ˜¯ä¸¤å­—ï¼š&lt;strong&gt;â€œæ·±è€•â€&lt;/strong&gt;&lt;/p&gt;

      &lt;p&gt;â˜‘ï¸ æŠ€æœ¯å±‚é¢æœ‰æ—¶å€™æ˜¯éœ€è¦è¾ƒçœŸä¸€ä¸‹çš„ï¼Œè§£å†³å…³é”®çš„æ ¸å¿ƒæŠ€æœ¯é—®é¢˜æ˜¯å¯¹ç«å¯¹äº§å“çš„è‡´å‘½æ‰“å‡»&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;äº§å“&lt;/strong&gt;ï¼š&lt;strong&gt;åšæŒä»·å€¼è¾“å‡ºå¯¼å‘,å€¾å¬å®¢æˆ·çš„æ„è§,åšå†³åå¯¹äº¤é’¥åŒ™å·¥ç¨‹&lt;/strong&gt;&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;â˜‘ï¸ æŠ€æœ¯ä¸Šè¾“å‡ºæœ€ç»ˆéƒ½ä¼šè½åœ°åˆ°å®é™…åº”ç”¨äº§å“çš„å¼€å‘ä¸Šï¼Œè€Œäº§å“éœ€è¦åšæŒçš„äº‹æƒ…åˆ™æ˜¯è¦å°Šé‡ç”¨æˆ·ï¼ŒæŠ€æœ¯æµ‹åˆ™éœ€è¦å°Šé‡äº§å“&lt;/p&gt;

      &lt;p&gt;â˜‘ï¸ ä»·å€¼è¾“å‡ºå¯¼å‘æ˜¯æ°¸æ’çš„çœŸç†ï¼Œå®¢æˆ·ä»˜è´¹ä¹°å•ï¼Œæœ€ç»ˆçœ‹ä¸­çš„ä¹Ÿæ˜¯è¿™ä¸ªäº§å“æ‰€å¸¦æ¥çš„ä»·å€¼ï¼Œæˆ–è€…è¯´èƒ½å¤Ÿç»™å®¢æˆ·å¸¦æ¥æ”¶ç›Š(èµšé’±æ‰æ˜¯ç¡¬é“ç†)&lt;/p&gt;

      &lt;p&gt;â˜‘ï¸ åšé¡ºåŠ¿è€Œä¸ºçš„äº‹æƒ…ï¼Œè€Œå¤§æ¨¡å‹è¿™ä¸€æ³¢æŠ€æœ¯æµªæ½®ï¼Œæˆ‘è§‰å¾—åšè¿™æ–¹é¢ç›¸å…³çš„å†…å®¹æˆ–è€…äº§å“æŠ€æœ¯æ¢ç´¢ï¼Œå°±æ˜¯é¡ºåŠ¿äº†&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;-æ–°åç§°&quot;&gt;ğŸ†• æ–°åç§°&lt;/h2&gt;

&lt;p&gt;è¿™ä¸ªå…¬ä¼—å·ä¹‹å‰éƒ½æ˜¯ä»¥Swagger/OpenAPI/Knife4jç­‰é¢†åŸŸç›¸å…³çš„åç§°ï¼Œå› ä¸ºä¸€ç›´åœ¨ç»´æŠ¤å¼€æºé¡¹ç›®Knife4jï¼Œä¸»è¦è¿˜æ˜¯å’Œæ¥å£ç›¸å…³çš„ï¼Œå°±ä¸€ç›´ç”¨äº†è¿™äº›åç§°ï¼æ€æ¥æƒ³å»ï¼Œå…¬ä¼—å·çš„æ€§è´¨ä¹Ÿæ˜¯ä¸ªäººæ€§è´¨ï¼Œä»¥åæ›´å¤šçš„è¿˜æ˜¯ä»¥ä¸ªäººçš„ä¸€äº›æƒ³æ³•ã€å·¥ä½œå®è·µç­‰å†…å®¹ä¸ºä¸»è¿›è¡Œè¾“å‡ºï¼Œå°±å¹²è„†æ¢å›ä¹‹å‰ä¸€ç›´ç”¨çš„ç½‘ç»œæ˜µç§°åç§°å§ï¼š&lt;strong&gt;å…«ä¸€èœåˆ€&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ğŸ†• åç§°å«ä¹‰(è¯¥å…¬ä¼—å·ä¹‹å‰æ³¨å†Œæ—¶ä¹Ÿæ˜¯ç”¨çš„è¿™ä¸ªåç§°ï¼Œç›¸å½“äºæ¢å¤å‡ºå‚è®¾ç½®äº†)&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;å…«ä¸€&lt;/strong&gt;ï¼šå­—é¢æ„æ€ä¸€è‡´&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;èœåˆ€&lt;/strong&gt;ï¼šä½œè€…æ•…ä¹¡æ¥è‡ªæ¹–å—çœæ¡‘æ¤å¿ï¼Œè´ºé¾™å…ƒå¸…æ•…ä¹¡ï¼Œè´ºè€æ€»ä¸¤æŠŠèœåˆ€é—¹é©å‘½æ˜¯æ——å¸œï¼Œä»¥æ­¤çºªå¿µï¼ŒåŒæ—¶ä¹Ÿæœ‰æ—¶åˆ»æ€å¿µæ•…ä¹¡ä¹‹æ„ï¼&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;ï¸-è¦å†™ä¸€äº›ä»€ä¹ˆå‘¢&quot;&gt;âœï¸ è¦å†™ä¸€äº›ä»€ä¹ˆå‘¢ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;ç›®å‰çœ‹æ¥ï¼Œä¸»è¦ä¸¤ä¸ªæ–¹é¢ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å¼€æº&lt;/strong&gt;ï¼šå¼€æºé¡¹ç›®&lt;strong&gt;Knife4jå¹¶æ²¡æœ‰åœæ›´&lt;/strong&gt;ï¼Œæ‰€ä»¥å’Œè¿™ä¸ªé¡¹ç›®ç›¸å…³çš„å†…å®¹ã€èµ„è®¯ç­‰ï¼Œä¹Ÿä¼šåŒæ­¥å‘å¸ƒåœ¨è¿™ä¸ªå…¬ä¼—å·é‡Œé¢ï¼Œè¿™ä¸ªé¡¹ç›®ä½œè€…æœ‰ç²¾åŠ›çš„æƒ…å†µä¸‹è¿˜æ˜¯ä¼šæŒç»­æ›´æ–°ä¸‹å»çš„ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;RAG&lt;/strong&gt;ï¼šä»¥å­¦ä¹ è€…çš„å¿ƒæ€ï¼Œå­¦ä¹ å¤§æ¨¡å‹é¢†åŸŸç›¸å…³çš„æŠ€æœ¯ï¼Œç‰¹åˆ«æ˜¯RAGé¢†åŸŸï¼Œè¿™å—é¢†åŸŸæˆ‘è§‰å¾—å“ªæ€•ä½ ä¸æ˜¯ä¸€ä¸ªç®—æ³•äººå‘˜ï¼Œè€Œä»…ä»…åªæ˜¯ä¸€ä¸ªæ™®é€šçš„å¼€å‘è€…(Java/Python/.Netç­‰)ï¼Œæ˜¯å¯ä»¥è§¦æ§å¯åŠçš„ï¼Œè€Œæˆ‘çš„å·¥ä½œä¸­ç›®å‰æ­£åœ¨åšè¿™ç±»äº§å“çš„å¼€å‘è¿­ä»£ï¼Œä¸ç®¡æ˜¯å­¦ä¹ æˆ–è€…å·¥ä½œä¸­ï¼Œå¿…ç„¶ä¼šç¢°åˆ°å¾ˆå¤šæ£˜æ‰‹çš„é—®é¢˜ï¼Œé‚£ä¹ˆå°±ä¼šå°†è‡ªå·±çš„æ€è€ƒä»¥åŠå®è·µæ€»ç»“åˆ†äº«å‡ºæ¥ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç»“åˆæˆ‘æœ€è¿‘çš„å·¥ä½œå†…å®¹ï¼Œæˆ‘æ€»ç»“äº†ä¸€éƒ¨åˆ†çš„å¤§çº²å†…å®¹(åé¢éšç€å­¦ä¹ çš„æ·±å…¥å¯èƒ½ä¼šæ‰©å±•æ›´å¤š)ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/llm/llm-start/image-20231010104036526.png&quot; alt=&quot;image-20231010104036526&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨æŠ€æœ¯å±‚é¢ï¼Œæˆ‘æ„¿ç§°è¿™æ–¹é¢çš„æŠ€æœ¯åˆé›†ä¸ºâ€&lt;strong&gt;å¤§æ¨¡å‹åº”ç”¨å·¥ç¨‹æŠ€æœ¯&lt;/strong&gt;â€œã€‚&lt;/p&gt;

&lt;p&gt;ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿä¸»è¦å‡ ä¸ªæ–¹é¢ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ä¸»è¦è¿˜æ˜¯åŸºäºåº”ç”¨å±‚é¢çš„æŠ€æœ¯å›´ç»•å±•å¼€ï¼Œè€Œåº•å±‚çš„&lt;strong&gt;å¤§æ¨¡å‹è®­ç»ƒ&lt;/strong&gt;ã€&lt;strong&gt;æ•°æ®æ ‡æ³¨&lt;/strong&gt;ã€&lt;strong&gt;åŸºäºé¢„è®­ç»ƒæ¨¡å‹çš„å¾®è°ƒ(Fine-turn)&lt;/strong&gt;ç­‰é¢†åŸŸï¼Œæˆ‘è§‰å¾—é‚£æ˜¯ä¸“ä¸šç®—æ³•äººå‘˜å¹²çš„äº‹æƒ…ï¼Œæ¯”å¦‚åŸºäºä¼ä¸šçš„ç§æœ‰æ•°æ®è°ƒæ•´å¼€æºé¢„è®­ç»ƒå¤§æ¨¡å‹çš„æƒé‡ï¼Œé€šè¿‡SFTæ‰‹æ®µè¿›è¡Œå¾®è°ƒï¼Œæˆ–è€…ä»0åˆ°1åŸºäºæ•°æ®è¯­æ–™æ„å»ºä¸€ä¸ªå…¨æ–°çš„å‚ç›´é¢†åŸŸçš„Embeddingæ¨¡å‹ï¼Œè¿™å·²ç»å±äºæ›´ä¾¿åº•å±‚çš„é¢†åŸŸäº†ï¼Œç›¸ä¿¡å¾ˆå¤šå’Œæˆ‘ä¸€æ ·çš„Javaå¼€å‘äººå‘˜å…¶å®åƒæ¥è§¦åˆ°è¿™æ–¹é¢çš„çŸ¥è¯†ï¼Œå“ªæ€•æ˜¯å­¦ä¹ éƒ½æ˜¯å¾ˆåƒåŠ›çš„ï¼Œå°±åšåˆ°äº†è§£å’ŒçŸ¥é“å§ï¼Œçœ‹ä¸ªäººå…´è¶£ã€‚&lt;/li&gt;
  &lt;li&gt;è€ŒRAGé¢†åŸŸçš„çŸ¥è¯†ç‚¹ï¼Œæ›´å¤šçš„æ˜¯åå·¥ç¨‹åº”ç”¨æŠ€æœ¯ï¼ŒåŒ…æ‹¬&lt;strong&gt;æ•°æ®çš„å¤„ç†&lt;/strong&gt;ã€&lt;strong&gt;å­˜å‚¨&lt;/strong&gt;ã€&lt;strong&gt;é€»è¾‘ç¼–æ’&lt;/strong&gt;ç­‰ç­‰å¯¹äºéç®—æ³•é¢†åŸŸçš„äººå‘˜ï¼Œå¯¹äºä¸šåŠ¡å¼€å‘äººå‘˜æ¥è¯´æˆ‘ä»¬æ˜¯æ“…é•¿çš„ï¼Œè™½ç„¶ä¹Ÿæ˜¯å’ŒAIå¤§æ¨¡å‹æŒ‚é’©ï¼Œä½†LLMä½œä¸ºåº•å±‚çš„åŸºç¡€è®¾æ–½ï¼Œæˆ‘ä»¬æ›´å¤šçš„æ˜¯ä½¿ç”¨å¤§æ¨¡å‹çš„èƒ½åŠ›ï¼Œåœ¨å¤§æ¨¡å‹åŸºç¡€ä¹‹ä¸Šï¼Œæ„å»ºä¸Šå±‚çš„åº”ç”¨çƒŸå›±ï¼Œæ‰€ä»¥ä½œä¸ºå¼€å‘äººå‘˜ï¼Œæ˜¯å¯ä»¥å°è¯•å»å­¦ä¹ ã€äº†è§£çš„ï¼Œæˆ‘è®¤ä¸ºæ˜¯è§¦æ‰‹å¯åŠçš„ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è€Œåœ¨â€&lt;strong&gt;å¤§æ¨¡å‹åº”ç”¨å·¥ç¨‹æŠ€æœ¯&lt;/strong&gt;â€œï¼Œæˆ‘åˆæ­¥åˆ—äº†ä¸€ä¸ªå¤§çº²(åé¢éšç€å­¦ä¹ çš„æ·±å…¥å¯èƒ½ä¼šæ‰©å±•æ›´å¤š)&lt;/p&gt;

&lt;p&gt;ç›®å‰åŒ…å«çš„å‡ ä¸ªæ–¹é¢ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å‘é‡Embedding&lt;/strong&gt;ï¼šåœ¨RAGé¢†åŸŸä¸­ï¼Œå°†å¤šæ¨¡æ€æ•°æ®(æ–‡æœ¬ã€å›¾åƒã€è§†é¢‘ã€éŸ³é¢‘ç­‰æ•°æ®)è¿›è¡Œå‘é‡Embeddingçš„åµŒå…¥è½¬åŒ–ï¼Œé€šè¿‡å‘é‡è®¡ç®—å¬å›Top kï¼Œå¯ä»¥è§£å†³å¾ˆå¤šå®é™…ç”Ÿäº§ä¸­çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼šæ–‡æœ¬ç›¸ä¼¼åº¦è®¡ç®—ã€ä»¥å›¾æœå›¾ã€ä»¥æ–‡æœå›¾ç­‰ç­‰ï¼Œè¿™æ–¹é¢éƒ½ä¼šæ¶‰åŠåˆ°å‘é‡çš„çŸ¥è¯†ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;LLMè¯­è¨€æ¨¡å‹&lt;/strong&gt;ï¼šLLMå¤§æ¨¡å‹(Large Language Model)ä½œä¸ºåŸºç¡€è®¾æ–½ï¼Œæ˜¯ä¸Šå±‚åº”ç”¨çš„åŸºçŸ³ï¼Œä½†æ˜¯åœ¨åº”ç”¨é¢†åŸŸä¸­ï¼Œå¯¹å¤§æ¨¡å‹çš„äº†è§£ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼ŒåŒ…æ‹¬Promptçš„æ„å»ºä¼˜åŒ–ã€æ¨¡å‹å‚æ•°çš„å·®å¼‚ä»¥åŠä¸åŒæ•ˆæœä½“ç°ã€æ¨¡å‹çš„éƒ¨ç½²å’Œè®­ç»ƒå¾®è°ƒã€å¼€æºæ¨¡å‹ä»¥åŠå•†ä¸šæ¨¡å‹ç­‰ç­‰&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¤šæ¨¡æ€æ•°æ®&lt;/strong&gt;ï¼šRAGç›¸å…³çš„AIåº”ç”¨ï¼Œç¦»ä¸å¼€æ•°æ®çš„å¤„ç†ï¼Œåœ¨å¾ˆå¤šLLMå¤§æ¨¡å‹ä¸­ï¼Œä¹Ÿæ ‡æ³¨ä¸ºå¤šæ¨¡æ€å¤§æ¨¡å‹ï¼ŒåŒ…æ‹¬æ–‡ç”Ÿå›¾ã€å›¾ç”Ÿå›¾ç­‰ç­‰ï¼Œä½†åœ¨åº”ç”¨é¢†åŸŸï¼Œæ–‡æœ¬(pdf/word/html/textç­‰)ã€å›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘ç­‰ç­‰æ ¼å¼çš„æ•°æ®å¤„ç†æ˜¯æ— å¯é¿å…çš„ï¼Œè¿˜åŒ…æ‹¬å¸‚é¢ä¸Šå¾ˆå¤šéç»“æ„åŒ–çš„æ•°æ®å¤„ç†ç­‰å†…å®¹ï¼Œå·¥ç¨‹å±‚é¢çš„æŠ€æœ¯å¯ä»¥è¯´æ˜¯å¦‚æ˜Ÿè¾°å¤§æµ·èˆ¬è¾½é˜”ï¼ŒæŠ€æœ¯äººå‘˜å­¦ä¹ ä¹‹è·¯æ— ç©·æ— å°½ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åŸºç¡€çŸ¥è¯†ï¼š&lt;/strong&gt;åœ¨åšåº”ç”¨å±‚é¢çš„å¼€å‘ä¸Šï¼Œå½“ç„¶ç¦»ä¸å¼€åŸºç¡€çŸ¥è¯†ç‚¹çš„å­¦ä¹ ï¼Œå¸¸ç”¨çš„åŒ…æ‹¬HTTP SSEåè®®ã€å‘é‡ç­‰ç­‰çŸ¥è¯†ç‚¹ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åŸºç¡€å·¥å…·åŒ…&lt;/strong&gt;:å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ï¼Œåœ¨å½“ä¸‹çš„å¼€æºå¤§ç¯å¢ƒä¸‹ï¼Œæœ‰éå¸¸å¤šçš„ä¼˜ç§€çš„å·¥å…·è¾…åŠ©å¼€å‘è€…å¼€å‘ç”Ÿäº§çº§åˆ«çš„åº”ç”¨ï¼Œä»¥Pythonã€Javaè¿™ä¸¤å¤§è¯­è¨€ç”Ÿæ€ä¸ºæ ‡æ†ï¼Œç”Ÿæ€åŠå…¶ä¸°å¯Œï¼Œè€Œæˆ‘ä»¬åœ¨åšåº”ç”¨æˆæŠ€æœ¯çš„å¼€å‘ç¦»ä¸å¼€è¿™äº›ä¼˜ç§€çš„ç»„ä»¶ï¼ŒæŒæ¡ç»„ä»¶çš„ç”¨æ³•ä¹Ÿæ˜¯å¿…é¡»çš„ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åŸºç¡€ç®—æ³•ï¼š&lt;/strong&gt;è™½ç„¶æ˜¯åšåº”ç”¨å±‚é¢çš„å¼€å‘ï¼ŒåŸºç¡€çš„å¸¸ç”¨ç®—æ³•ï¼Œè¯¥å­¦ä¹ çš„è¿˜æ˜¯éœ€è¦å»äº†è§£çš„ï¼Œåƒè´å¶æ–¯ã€KNNã€å†³ç­–æ ‘ç­‰ç­‰ï¼Œäº†è§£ç®—æ³•çš„åŸç†å®è·µï¼Œå¯¹äºç”Ÿäº§ç¯å¢ƒçš„ä»£ç ç¼–å†™æ—¶éå¸¸æœ‰æŒ‡å¯¼æ€æƒ³çš„ï¼Œå¦åˆ™ä½ éƒ½ä¸çŸ¥é“è¿™æ®µä»£ç ä¸ºä½•è¿™ä¹ˆå†™ï¼Œè€Œæ¯ä¸ªç®—æ³•è§£å†³çš„éƒ½æ˜¯éå¸¸å®é™…çš„é—®é¢˜ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯ï¼š&lt;/strong&gt;æŠ€æœ¯äººå‘˜åœ¨å¼€å‘äº§å“æ—¶ï¼Œä¹Ÿåº”è¯¥å…³æ³¨åº”ç”¨åœºæ™¯åŠå¸‚åœºï¼Œå¼€å‘å‡ºæ¥çš„äº§å“è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Œæœ‰ä»€ä¹ˆä»·å€¼ä½œä¸ºæŠ€æœ¯äººå‘˜ä¹Ÿåº”è¯¥å­¦ä¼šæ€è€ƒã€‚åœ¨å¤§æ¨¡å‹é¢†åŸŸï¼Œä»¥RAGèµ›é“æ¥çœ‹ï¼Œè§¦åŠçš„åœºæ™¯å…¶å®ä¹Ÿæ˜¯éå¸¸å¤šçš„ï¼Œæ¯”å¦‚ï¼šæ™ºèƒ½å®¢æœã€ä»¥å›¾æœå›¾/è§†é¢‘ç­‰ç­‰ï¼Œè¦å…³æ³¨å®é™…çš„äº§å“éœ€æ±‚ï¼Œç„¶åè½¬åŒ–ä¸ºæŠ€æœ¯è¾“å‡ºï¼Œè¿™æ ·æˆ‘ä»¬ä½œä¸ºå¼€å‘äººå‘˜æ‰€å†™çš„ä»£ç æ‰æ˜¯æœ‰ä»·å€¼çš„ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;RAGï¼š&lt;/strong&gt;RAGå…¨ç§°&lt;strong&gt;Retrieval Augmented Generation(æ£€ç´¢å¢å¼ºç”Ÿæˆ)&lt;/strong&gt;ï¼Œæ˜¯å±äºAIç”Ÿæˆå¼æŠ€æœ¯é¢†åŸŸèŒƒå›´ï¼Œè§£å†³å¤§æ¨¡å‹çš„å¹»è§‰(èƒ¡è¯´å…«é“)ã€æ•°æ®ä¸åŠæ—¶(æ•°æ®æœªæ›´æ–°)ç­‰é¢†åŸŸçš„é—®é¢˜ï¼Œé€šè¿‡å°†ä¼ä¸šè‡ªå·±çš„æ•°æ®é€šè¿‡ä¼ ç»Ÿçš„å·¥ç¨‹æŠ€æœ¯ç»“åˆå‘é‡Embedingè¿›è¡Œå¤„ç†ï¼Œç„¶åé€šè¿‡æ£€ç´¢çš„æ–¹å¼å°†ä¼ä¸šå†…éƒ¨æ•°æ®æ„å»ºé€ç»™å¤§æ¨¡å‹è¿›è¡Œå†…å®¹çš„å›ç­”ç”Ÿæˆï¼Œè¿™ç§æ–¹å¼æœ‰æ•ˆçš„é¿å…äº†å¤§æ¨¡å‹èƒ¡è¯´å…«é“å’Œæ•°æ®ä¸å‡†ç¡®çš„é—®é¢˜ï¼Œåœ¨ä¼ä¸šä¸åŒçš„é¢†åŸŸä¸­æœ‰éå¸¸å®½å¹¿çš„åº”ç”¨é¢†åŸŸï¼Œå½“ç„¶è¿™é‡Œé¢æ‰€æ¶µç›–çš„é¢ä»¥åŠé—®é¢˜ä¹Ÿæ˜¯éå¸¸çš„å¹¿ï¼Œæ¯”å¦‚ï¼š
    &lt;ul&gt;
      &lt;li&gt;å¤§æ¨¡å‹å‡ºç°å¹»è§‰(é€ç»™LLMçš„Contextä¸å‡†ï¼Œå¯¼è‡´å¤§æ¨¡å‹èƒ¡è¯´å…«é“)å¦‚ä½•è§£å†³ï¼Ÿ&lt;/li&gt;
      &lt;li&gt;æŒ‰å›ºå®šsizeè¿›è¡Œåˆ†å‰²ï¼Œå‡ºç°ä¸Šä¸‹æ–‡è¯­ä¹‰ä¸¢å¤±ï¼Œæ ¸å¿ƒä¿¡æ¯æ£€ç´¢é—®ç­”ç”Ÿæˆå¤±è´¥ï¼Œå›ç­”ä¸å‡†ç¡®&lt;/li&gt;
      &lt;li&gt;åƒä¸‡çº§æ•°æ®é‡æ–‡æ¡£æ£€ç´¢æ•ˆç‡é—®é¢˜&lt;/li&gt;
      &lt;li&gt;å¤§æ¨¡å‹Tokené™åˆ¶é—®é¢˜å¯¼è‡´åœ¨ä¸€ä¸ªæ–‡æ¡£ä¸­å‡ºç°å¤šæ®µè½è®²è§£åŒä¸€ä¸ªäº‹æƒ…çš„æƒ…å†µä¸‹ä¼šå›ç­”ä¸å®Œæ•´å¦‚ä½•å¤„ç†&lt;/li&gt;
      &lt;li&gt;â€¦â€¦&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿™äº›éƒ½åªæ˜¯AIå¤§æ¨¡å‹ã€RAGç­‰é¢†åŸŸçš„å†°å±±ä¸€è§’ï¼Œåƒé‡Œä¹‹è¡Œï¼Œå§‹äºè¶³ä¸‹ï¼Œä½œä¸ºæŠ€æœ¯äººå‘˜ï¼Œé‚£ä¹ˆå°±ä»ç°åœ¨å¼€å§‹ï¼Œä¸€æ­¥æ­¥å­¦èµ·æ¥å§ï½&lt;/p&gt;

&lt;h2 id=&quot;æœ€å&quot;&gt;æœ€å&lt;/h2&gt;

&lt;p&gt;å¦‚æœä½ æœ€è¿‘ä¹Ÿåœ¨åšRAGé¢†åŸŸç›¸å…³çš„æŠ€æœ¯ç ”ç©¶æˆ–è€…äº§å“å¼€å‘ï¼Œæ¬¢è¿å…³æ³¨ã€æ²Ÿé€šäº¤æµåˆä½œï¼ï¼ï¼&lt;/p&gt;</content><author><name>å…«ä¸€èœåˆ€</name></author><category term="å¤§æ¨¡å‹" /><summary type="html">å†™åœ¨å‰é¢</summary></entry></feed>